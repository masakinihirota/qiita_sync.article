<!--
title:   template_masakinihirota
tags:    VNS,masakinihirota,vns.blue
id:      bd618dccf41dc663baf8
private: false
-->
ã‚ªã‚¢ã‚·ã‚¹å®£è¨€

è‡ªä½œã‚¢ãƒ—ãƒª masakinihirotaç”¨ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ã™ã€‚
Vercelå…¬å¼ãŒå…¬é–‹ã—ã¦ã„ã‚‹ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã‚’åˆ©ç”¨ã—ã¦ã‚ªãƒªã‚¸ãƒŠãƒ«ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

# è‡ªä½œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

masakinihirota/template_masakinihirota

https://github.com/masakinihirota/template_masakinihirota

----------------------------------------

# ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã®ãƒªãƒã‚¸ãƒˆãƒª

Vercelå…¬å¼ãŒNext.jsã«+Supabase+Stripeã§ä½œã£ãŸãƒªâ†“ãƒã‚¸ãƒˆãƒª

vercel/nextjs-subscription-payments: Clone, deploy, and fully customize a SaaS subscription application with Next.js.
https://github.com/vercel/nextjs-subscription-payments

ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã®ãƒ‡ãƒ¢
Next.js Subscription Starter
https://subscription-payments.vercel.app/

â†‘ã“ã®ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«æ§˜ã€…ãªè¨­å®šã‚„ã€ç’°å¢ƒå¤‰æ•°ã‚’â†“è¿½åŠ ã—ã¾ã—ãŸã€‚

ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€ç’°å¢ƒå¤‰æ•°ã®è¨­å®šã¯â†“ã“ã®Blogã«æ›¸ãã¾ã—ãŸã€‚

Next.js App Router ã¨ Supabase ã¨ Stripe ã®ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã‚¢ãƒ—ãƒªã«è‰²ã‚“ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š #Next.js - Qiita
https://qiita.com/masakinihirota/items/1ae7d17377b8bac524d5

	â†‘ã“ã®è¨˜äº‹ã¯ãƒ‘ã‚¿ãƒ¼ãƒ³1,2,3ã®3ç¨®é¡

Next.js Supabase Stripe ã®ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã‚¢ãƒ—ãƒªã‚’ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒœã‚¿ãƒ³ã‚’åˆ©ç”¨ã—ã¦è¨­å®šã™ã‚‹ãƒãƒ³ã‚ºã‚ªãƒ³ã€‚ #Next.js - Qiita
https://qiita.com/masakinihirota/items/695f572b05b82c2a7d57

	â†‘ã“ã®è¨˜äº‹ã¯ãƒ‘ã‚¿ãƒ¼ãƒ³1ã®1ç¨®é¡

masakinihirota/vns_masakinihirota
https://github.com/masakinihirota/vns_masakinihirota

â†‘ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã¯ã‚¯ãƒ­ãƒ¼ãƒ³ã—ãŸã ã‘ã§ã‚³ãƒ¼ãƒ‰è‡ªä½“ã®å¤‰æ›´ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

## ç’°å¢ƒå¤‰æ•°

ä»Šå›ä½¿ç”¨ã™ã‚‹ç’°å¢ƒå¤‰æ•°ã®è¨­å®šã¯ãƒ‘ã‚¿ãƒ¼ãƒ³3ã§ã™ã€‚

ãƒ‘ã‚¿ãƒ¼ãƒ³3ã¯
Next.js ãƒ­ãƒ¼ã‚«ãƒ«
Supabase ãƒ­ãƒ¼ã‚«ãƒ«

â€»ãƒ‘ã‚¿ãƒ¼ãƒ³ã®è©³ç´°ã¯ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ãŸè¨˜äº‹ã‚’å¾¡è¦§ãã ã•ã„ã€‚



----------------------------------------

# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

åŸºæœ¬çš„ã«ãƒ­ãƒ¼ã‚«ãƒ«ã§é–‹ç™ºã§ãã‚‹çŠ¶æ…‹ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãã¾ã™ã€‚
Supabaseã¯ãƒ­ãƒ¼ã‚«ãƒ«ã®ã‚’ä½¿ã„ã¾ã™ã€‚

é€”ä¸­ã§Vercelã‚„Supabaseã®ã‚µãƒ¼ãƒãƒ¼ã‚’ä½œã£ã¦å…¬é–‹ã™ã‚‹éç¨‹ã‚‚ã‚ã‚Šã¾ã™ã€‚



```
gh repo clone vercel/nextjs-subscription-payments .

pnpm install

```


```terminal
Copy-Item .env.local.example .env.local
Copy-Item .env.example .env

# å…ƒãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤
Remove-Item .\.env.local.example
Remove-Item .\.env.example

```

ç’°å¢ƒå¤‰æ•°ã®å®Ÿéš›ã®å€¤ã®è¨­å®šã¯ã€å…ˆç¨‹ç´¹ä»‹ã—ãŸã®Blogè¨˜äº‹ã‚’è¦‹ã¦ãã ã•ã„ã€‚



## ãƒªãƒã‚¸ãƒˆãƒªã«srcãƒ•ã‚©ãƒ«ãƒ€ã®ä½œæˆ

Next.js ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã«srcã‚’é¸æŠã—ãŸæ™‚ã¨ã€ã—ãªã„æ™‚ã®å·®åˆ†ã®èª¿æŸ» (Next.js 14 App router) #Next.js - Qiita
https://qiita.com/masakinihirota/items/77b52f51a3069c72005f

srcãƒ•ã‚©ãƒ«ãƒ€ã®ä¸‹ã«appãƒ•ã‚©ãƒ«ãƒ€ã‚„ãã®ä»–ã‚’ç§»å‹•ã•ã›ã¾ã™ã€‚
è‡ªåˆ†ã§ç›´æ¥è§¦ã‚‹ã‚³ãƒ¼ãƒ‰é–¢é€£

## srcãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œã‚Šã¾ã™ã€‚

```
mkdir src
mkdir src/app

```

ãƒ•ã‚©ãƒ«ãƒ€
app
components
styles
utils
middleware.ts
ã‚’srcãƒ•ã‚©ãƒ«ãƒ€ã®ä¸‹ã«ç§»å‹•ã•ã›ã¾ã™ã€‚

ç§»å‹•ã•ã›ãŸã‚‰ã€å…ƒã®/appãƒ•ã‚©ãƒ«ãƒ€(ä¸­èº«ã¯ç©º)ã‚’å‰Šé™¤ã—ã¾ã™ã€‚

```tailwind.config.js
  content: [
    './src/pages/**/*.{js,ts,jsx,tsx,mdx}',
    './src/components/**/*.{js,ts,jsx,tsx,mdx}',
    './src/app/**/*.{js,ts,jsx,tsx,mdx}',
  ],

```

â†‘pathã®ä¿®æ­£

```tsconfig.json
    "paths": {
      "@/*": ["./src/*"]
    },

```

â†‘ãƒ‘ã‚¹ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã®ä¿®æ­£

```terminal
pnpm run dev

```

srcãƒ•ã‚©ãƒ«ãƒ€ã®ä¸‹ã«ç§»å‹•ã•ã›ãŸå¾Œã€
pathãŒè¦‹ã¤ã‹ã‚‰ãªã„ã¨è­¦å‘ŠãŒå‡ºãŸã‚‰ãã®éƒ½åº¦ä¿®æ­£ã—ã¾ã™ã€‚

## pathã®ä¿®æ­£

å¾Œã¯ã€è‡ªåˆ†ã®ã‚³ãƒ¼ãƒ‰ã‚’srcãƒ•ã‚©ãƒ«ãƒ€ä»¥ä¸‹ã«ç½®ãã‚ˆã†ã«ã—ã¾ã™ã€‚

pathã®
`@/src/`
ã«ãªã£ã¦ã—ã¾ã£ãŸå ´åˆã¯
`@/`
ã«ä¿®æ­£ã—ã¾ã™ã€‚

ä¾‹

```
import { getAuthTypes } from 'utils/auth-helpers/settings';
â†“ä¿®æ­£
import { getAuthTypes } from '@/utils/auth-helpers/settings';

```

â€»VSCodeã®ç½®æ›æ©Ÿèƒ½ã‚’ä½¿ã†ã¨ã€ã™ãã«çµ‚ã‚ã‚Šã¾ã™ã€‚




## Tips

<details><summary>Tips Supabase</summary>

Supabaseã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§å‹•ã‹ã™ã¨é‡ããªã‚Šã™ãã¡ã‚ƒã†å•é¡Œã‚’è§£æ±ºã™ã‚‹ã€Windowså‹¢å‘ã‘ã€‘
https://zenn.dev/masa5714/articles/3b5ea07c15f159


é–‹ç™ºä¸­ã¯ä½¿ã‚ãªã„æ©Ÿèƒ½ã‚’åˆ‡ã£ã¦ãŠãã“ã¨ã§ã€PCãŒè»½ããªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

ä¾‹ãˆã°ã€â†“ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã€inbucketï¼ˆãƒ¡ãƒ¼ãƒ«ï¼‰ã€ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
ã®enabledã®é …ç›®ã‚’falseã§åˆ‡ã£ã¦ãŠãã¾ã™ã€‚

è¨­å®šä¾‹

```supabase\config.toml
[realtime]
enabled = false

ãƒ»ãƒ»ãƒ»

[inbucket]
enabled = false

ãƒ»ãƒ»ãƒ»

[storage]
enabled = false

```

</details>



ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã§å¿…è¦ãªã€Supabaseå´ã®è¨­å®šã‚’è¡Œã„ã¾ã™ã€‚

Docker Desktopã‚’ä½¿ã£ã¦
Supabaseã‚’ç«‹ã¡ä¸Šã’ã¾ã™ã€‚

ãƒªãƒã‚¸ãƒˆãƒªå†…ã«ã‚ã‚‹schema.sqlã®å†…å®¹ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã€
Supabaseã®SQL Editorã«è²¼ã‚Šä»˜ã‘å®Ÿè¡Œã—ã¾ã™ã€‚

supabase\schema.sql

Supabaseã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸ã³ã€
å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«ã‚ã‚‹ã€Table Editorã‚’è¦‹ã‚‹ã¨ã€ãƒ†ãƒ¼ãƒ–ãƒ«ãŒï¼•ã¤ä½œæˆã•ã‚Œã¾ã™ã€‚

```
customers
prices
products
subscriptions
users

```



## Supabaseã®å‹

å‹ã®ä¿å­˜å ´æ‰€ã‚’ä½œæˆã€‚

```terminal
mkdir src\types

```

å‹ã¯ã“ã‚Œã‹ã‚‰å¢—ãˆã‚‹ã®ã§ï¼‘ã‹æ‰€ã«ã¾ã¨ã‚ã¦ãŠãã¾ã™ã€‚

ãƒ«ãƒ¼ãƒˆã«ã‚ã‚‹
types_db.tsã‚’src\typesã«ç§»å‹•ã•ã›ã¦ãŠãã¾ã™ã€‚


### pathã®ä¿®æ­£

```
import { Tables } from '@/types_db';

ğŸ‘‡

import { Tables } from '@/types/types_db';

```


## å‹ã®ç”Ÿæˆ



```terminal
#ã‚µãƒ¼ãƒãƒ¼
supabase gen types typescript --project-id [Reference ID] > src/types/types_db.ts

#ãƒ­ãƒ¼ã‚«ãƒ«
supabase gen types typescript --local --schema public > src/types/types_db.ts

supabase gen types typescript --local > src/types/types_db.ts


```

â€»[Reference ID] Supabaseã® Reference ID ã‚’å…¥åŠ›ã—ã¾ã™ã€‚

publicã®å ´åˆ --schema ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯çœç•¥ã§ãã¾ã™ã€‚
`--schema public`

æˆåŠŸã™ã‚‹ã¨å‹ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

# Stripeã®è¨­å®š ãƒ­ãƒ¼ã‚«ãƒ«å´ï¼ˆVSCodeä¸Šã§ã®ï¼‰Webhookã®è¨­å®š

```terminal
stripe login

Your pairing code *****

https://dashboard.stripe.com/stripecli/*****

```

ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚


URLãŒã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«è¡¨ç¤ºã•ã‚Œã‚‹ã®ã§ã€ãã®URLã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ãã¾ã™ã€‚
ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã‚’æ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚

Stripe CLI ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã—ã¾ã™ã‹ï¼Ÿ
ã¨èã‹ã‚Œã‚‹ã®ã§ã€

pairing codeã¨ä¸€è‡´ã—ã¦ã„ã‚‹ã¯ãšãªã®ã§ã€

ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚

```ãƒ–ãƒ©ã‚¦ã‚¶
ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã—ã¾ã—ãŸ
ã“ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‰ã˜ã¦ã€CLI ã«æˆ»ã‚‹ã“ã¨ãŒã§ãã¾

```

ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã¾ã™ã€‚


# Stripeè¨­å®šä¾¡æ ¼ã®åæ˜ ã€‚

ã‚µãƒ³ãƒ—ãƒ«ã§
fixtures\stripe-fixtures.json
ãŒäº‹å‰ã«ç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚

ã“ã‚Œã‚’Stripeã«åæ˜ ã•ã›ã¾ã™ã€‚

â€»ğŸ‘‡ã“ã®æ‰‹ç¶šãã¯é †ç•ªã‚’é©å½“ã«ã‚„ã‚‹ã¨åæ˜ ã•ã‚Œãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

Next.jsã®ã‚µãƒ¼ãƒãƒ¼ã‚’ç«‹ã¡ä¸Šã’ã¦(pnpm run dev)ãŠã„ã¦ã‹ã‚‰ã€‚
Stripeã®APIç›£è¦–(stripe listen)
ä¾¡æ ¼è¨­å®šã®å®Ÿè¡Œ(stripe fixtures)
â€»ã“ã®é †ç•ªã‚’å®ˆã£ã¦ãã ã•ã„ã€‚

å®Ÿè¡Œé †

```terminal
pnpm run dev

```

```ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‹ãã¨
No subscription pricing plans found. Create them in your Stripe Dashboard.

```

ã¨ã¾ã åæ˜ ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
åˆ¥ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®terminalã§

```terminal
stripe listen --forward-to http://127.0.0.1:3000/api/webhooks

```

ğŸ‘† stripeã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãŠãã¾ã™ã€‚

ã¾ãŸã€åˆ¥ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®terminalã§

```terminal
stripe fixtures fixtures/stripe-fixtures.json

```

ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€stripe-fixtures.jsonã«æ›¸ã„ãŸStripeã®è¨­å®šãŒåæ˜ ã•ã‚Œã¾ã™ã€‚

â€»ã“ã®stripe-fixtures.jsonã¯è¿½è¨˜å‹ã§ã™ã€å¾Œã‹ã‚‰ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤‰æ›´ã—ã¦ã‚‚ä¾¡æ ¼ãŒæ–°ãŸã«è¿½åŠ ã•ã‚Œã‚‹ã ã‘ã§ã™ã€‚

â†‘ãã‚Œãã‚Œåˆ¥ã®terminalã‚’é–‹ã„ã¦å®Ÿè¡Œã—ã¾ã™ã€‚
ãƒ–ãƒ©ã‚¦ã‚¶ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€
æˆåŠŸã™ã‚Œã°ã€ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã®ãƒ‡ãƒ¢ç”»é¢ã®ã‚ˆã†ã« ã‚µãƒ–ã‚¹ã‚¯ ãƒ—ãƒ©ãƒ³ ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã¯ãšã§ã™ã€‚




# GitHubèªè¨¼ã®ç¢ºèª

Supabaseã®å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®Authenticationã‚’é–‹ãã¾ã™ã€‚
ğŸ‘‡Usersã‚’é–‹ãã¾ã™ã€‚

http://localhost:54323/project/default/auth/users

Supabaseã‚’ä½œã£ãŸã°ã‹ã‚Šãªã®ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã‚¼ãƒ­ã§ã™ã€‚

ãƒ–ãƒ©ã‚¦ã‚¶ã§
http://localhost:3000/
ã‚’é–‹ãCookeiã‚’ã‚¯ãƒªã‚¢ã—ã¦ãŠãã¾ã™ã€‚

â€»ãƒ–ãƒ©ã‚¦ã‚¶ã®å³ã‚¯ãƒªãƒƒã‚¯ã‹ã‚‰æ¤œè¨¼ã‚’é–‹ãã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ã‚¿ãƒ–ã‚’é–‹ãã¾ã™ã€‚
å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«CookieãŒã‚ã‚‹ã®ã§é–‹ãã¾ã™ã€‚

GitHubèªè¨¼ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²(Sign In)ã‚’è©¦ã—ã¾ã™ã€‚
å³ä¸Šã®Sign In ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚

Sign Inã®GitHubãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚

GitHubã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã¿ã¾ã™ã€
è‡ªåˆ†ã®ç™»éŒ²åãŒã§ãŸã‚‰æˆåŠŸã§ã™ã€‚

Supabaseã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ã‚‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒGitHubã§ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™ã€‚
Supabaseã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‹ã‚‰Table Editorã‚’é¸æŠã—ã¾ã™ã€‚
usersãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã®ãŒç¢ºèªã§ãã¾ã™ã€‚

ãƒ–ãƒ©ã‚¦ã‚¶ã®Cookieã«ã‚‚sb-***-auth-token***ã¨ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™ã€‚



----------------------------------------

## Vercelã«ãƒ‡ãƒ—ãƒ­ã‚¤

ä»Šå›ã€ã“ã®ã‚¢ãƒ—ãƒªã‚’Vercelã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚

### Vercel CLIã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```terminal
pnpm i -g vercel

```

### ãƒ­ãƒ¼ã‚«ãƒ«ã§Vercelã¸ã®ãƒ­ã‚°ã‚¤ãƒ³

```terminal
vercel login

```

	GitHubã‚’é¸æŠã—ã¾ã™ã€‚

ãƒ–ãƒ©ã‚¦ã‚¶ã«Vercel CLI Login Successã¨è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
ãƒ–ãƒ©ã‚¦ã‚¶ã®ã“ã®ç”»é¢ã‚’é–‰ã˜ã¾ã™ã€‚

### vercelã¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒªãƒ³ã‚¯

ãƒ­ãƒ¼ã‚«ãƒ«ä¸Šã‹ã‚‰Vercelã¨ãƒªãƒ³ã‚¯ã™ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é¸æŠ

```terminal
vercel link

Vercel CLI 34.1.4
? Set up â€œ*****\[ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå]â€? yes
? Which scope should contain your
project? [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå]'s projects
? Link to existing project? no
? Whatâ€™s your projectâ€™s name?
[ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå]
? In which directory is your code
located? ./
Local settings detected in vercel.json:
Auto-detected Project Settings (Next.js):
- Build Command: next build
- Development Command: next dev --port $PORT
- Install Command: `yarn install`, `pnpm install`, `npm install`, or `bun install`
- Output Directory: Next.js default
? Want to modify these settings? no
âœ…  Linked to [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå]-project
s/[ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå] (created .vercel and added it to .gitignore)

```

## ã‚µãƒ¼ãƒãƒ¼ä¸Šã®Vercelã¨GitHubã¸ã®æ¥ç¶š

Vercelã‚’é–‹ãã€æ–°ã—ãä½œã£ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ãã¾ã™ã€‚

Connect Git repositoryãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚

GitHubã‚’é¸ã³ã€æ–°ã—ãä½œã£ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å³ã«ã‚ã‚‹Connectãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚




â€» ç’°å¢ƒå¤‰æ•°ã¯è¨­å®šã—ã¦ãªã„ã¨ç©ºã®ã¾ã¾ã§ã™ã€‚
Supabaseã¨é€£æºã‚’ã—ã¦ãŠãã¾ã™ã€‚

Next.jsÃ—SupabaseÃ—Vercelé€£æºã«ã¤ã„ã¦ #React - Qiita
https://qiita.com/kaho_eng/items/8a7faf77222a599fb31c

ã‚µãƒ¼ãƒãƒ¼å´ã«Supabaseã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã£ã¦ãŠãã¾ã™ã€‚

ä½œã£ãŸSupabaseã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’Vercelã¨ãƒªãƒ³ã‚¯ã—ã¾ã™ã€‚


Vercelã®Settingsã‚¿ãƒ–ã‚’é¸ã³ã¾ã™ã€‚

Integrationsã®Browse Marketplaceã‚’æŠ¼ã—ã¾ã™ã€‚
Supabaseã‚’æ¢ã—ã¦ã€è¿½åŠ ã—ã¾ã™ã€‚

ä½¿ã„ãŸã„Vercelã¨Supabaseã‚’é¸ã³ãƒªãƒ³ã‚¯ã—ã¾ã™ã€‚

Vercelã¨Supabaseã®æ¥ç¶šãŒå®Œæˆã—ãŸã‚‰buildã‚’è¡Œã„ã¾ã™ã€‚

Vercelä¸Šã§buildã—ã¾ã™ã€‚

æˆåŠŸã™ã‚‹ã¨StatusãŒReadyã¨è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

vercelã«ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ç’°å¢ƒå¤‰æ•°ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã«å–å¾—ã—ã¾ã™ã€‚

```terminal
vercel env pull

```

	.env.localãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã¾ã™ã€‚
	æ—¢å­˜ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹ã¨ä¸Šæ›¸ãã™ã‚‹ã‹èã„ã¦ãã¾ã™ã€‚

Supabaseã®ãƒ­ãƒ¼ã‚«ãƒ«ã¨ã‚µãƒ¼ãƒãƒ¼ã®ç’°å¢ƒå¤‰æ•°ã‚’ä½¿ã„åˆ†ã‘ã‚‹ã¨é–‹ç™ºã—ã‚„ã™ããªã‚Šã¾ã™ã€‚

ãã‚Œãã‚Œåˆ¥ã«ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã—ã¦ãŠãã¾ã™ã€‚


Vercelã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ãDomainsã‚’è¦‹ã¦ã¿ã‚‹ã¨
ã‚¢ãƒ—ãƒªã®å…¬é–‹ã—ã¦ã„ã‚‹URLãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚

ã“ã‚Œã§ã‚‚ã†ã™ã§ã«è‡ªåˆ†ã®ã‚¢ãƒ—ãƒªãŒä¸–ç•Œã«å…¬é–‹ã•ã‚Œã¦ã„ã‚‹çŠ¶æ…‹ã«ãªã£ã¦ã„ã¾ã™ã€‚

Next.js Subscription Starter
https://masakinihirota.vercel.app/



----------------------------------------

â€»ã“ã®è¨˜äº‹ã§ã¯åŸºæœ¬çš„ã«ã™ã¹ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®é–‹ç™ºç’°å¢ƒã«åˆã‚ã›ãŸç’°å¢ƒå¤‰æ•°ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã—ãŸã€‚

Vercelã‚’çµŒç”±ã—ã¦å…¬é–‹ã™ã‚‹å ´åˆã€Supabase ã‚µãƒ¼ãƒãƒ¼ã«åˆã‚ã›ãŸç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

## Vercel ã¸ã®ç’°å¢ƒå¤‰æ•°ã‚’ç™»éŒ²

Vercelã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ãã€

ä¸Šå´ã®ã‚¿ãƒ–ã®Settingsã‚’é–‹ãã¾ã™ã€‚

å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã® Environment Variablesã‚’é–‹ãã¾ã™ã€‚

ã“ã“ã«ç’°å¢ƒå¤‰æ•°ã‚’å…¥åŠ›ã—ã¾ã™ã€‚

Supabaseã®ã‚µãƒ¼ãƒãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€ãã‚Œã«å¯¾å¿œã—ãŸç’°å¢ƒå¤‰æ•°ã‚’å…¥åŠ›ã—ã¾ã™ã€‚

ä¾‹

```Vercelç’°å¢ƒå¤‰æ•°
SUPABASE_AUTH_EXTERNAL_GITHUB_REDIRECT_URI="https://*****.supabase.co/auth/v1/callback"
SUPABASE_AUTH_EXTERNAL_GITHUB_CLIENT_ID=""
SUPABASE_AUTH_EXTERNAL_GITHUB_SECRET=""

```

â€»ğŸ‘†é©å½“ãªå€¤ã‚’å…¥ã‚Œã¦ãã ã•ã„ã€‚



----------------------------------------

ã“ã‚Œã§ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã®ã‚¤ãƒ³ãƒˆãƒ¼ãƒ«ã®è¨­å®šã¯çµ‚äº†ã§ã™ã€‚

ã“ã“ã‹ã‚‰ã„ã‚ã„ã‚ã¨ä¾¿åˆ©ãªé–‹ç™ºãƒ„ãƒ¼ãƒ«ã‚’è¿½åŠ ã—ã¦ã„ãã¾ã™ã€‚



----------------------------------------
----------------------------------------
----------------------------------------

## ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®ç«‹ã¡ä¸Šã’ å‹•ä½œç¢ºèª

```terminal
npm run dev

supabase start

stripe listen --forward-to=localhost:3000/api/webhooks

pnpm test

```



# ãƒ­ãƒ¼ã‚«ãƒ«

Next.jsã‚¢ãƒ—ãƒª
http://localhost:3000

Storybook
http://localhost:6006/

ãƒ­ãƒ¼ã‚«ãƒ«ã® Supabase
http://127.0.0.1:54323/project/default



# ã‚µãƒ¼ãƒãƒ¼

Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
Dashboard | Supabase
https://supabase.com/dashboard/projects

Vercelãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
https://vercel.com/dashboard

å…¬é–‹ã‚µã‚¤ãƒˆ
Next.js and Supabase Starter Kit
https://masakinihirota.vercel.app/



----------------------------------------
----------------------------------------
----------------------------------------

# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹é–‹ç™ºãƒ„ãƒ¼ãƒ«

ESLint æ©Ÿèƒ½ æ•´å½¢
Prettier ã‚³ãƒ¼ãƒ‰ æ•´å½¢
husky ãƒã‚§ãƒƒã‚¯
å›½éš›åŒ– i18n
shadcn/ui UIé›† ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰
Storybook ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç®¡ç†
vitest ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º
Plop ã‚³ãƒ¼ãƒ‰ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ã®è‡ªå‹•ç”Ÿæˆ

â†‘ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã«ã€ã“ã‚Œã‚‰ã®é–‹ç™ºç”¨ãƒ„ãƒ¼ãƒ«ã‚’è¿½åŠ ã—ãŸã‚‚ã®ã‚’ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨ã—ã¾ã™ã€‚

â€»lint-staged ã¨ husky ã®é•ã„ã¯ï¼Ÿ
lint-stagedã¯å¤‰æ›´ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒã‚§ãƒƒã‚¯ã‚’ã—ã¦ã€ãã‚ŒãŒé€šã£ãŸã‚‰huskyã§å…¨ä½“ã®ãƒã‚§ãƒƒã‚¯ã‚’ã™ã‚‹ã¨ã„ã†ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚
ã—ã‹ã—huskyã«ã¯pre-commitæ©Ÿèƒ½ãŒã‚ã‚‹ã®ã§lint-stagedã®ä»£æ›¿ãŒå¯èƒ½ã§ã™ã®ã§lint-stagedã¯ä½¿ç”¨ã—ã¾ã›ã‚“ã€‚

huskyã®
pre-commitæ©Ÿèƒ½ã§gitã«ã‚³ãƒŸãƒƒãƒˆã™ã‚‹å‰ã«lintãƒã‚§ãƒƒã‚¯ç­‰ã‚’ã—ã¾ã™ã€‚
pre-pushæ©Ÿèƒ½ã§githubã«pushã™ã‚‹å‰ã«ãƒ“ãƒ«ãƒ‰ã—ã¾ã™ã€‚


Next.js ã® ESLintã¨Prettierã€turborepoã€husky Next.jså…¬å¼ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ç‹¬è‡ªèª¿æŸ» #Next.js - Qiita

https://qiita.com/masakinihirota/items/f1a4796ad3a535f27664

ğŸ‘†é–‹ç™ºãƒ„ãƒ¼ãƒ«ã‚’å€‹åˆ¥ã«èª¿æŸ»ã—ãŸæ™‚ã®è¨˜äº‹



## package.jsonã®script

â€» package.jsonã®scriptã‚’è‡ªåˆ†ãªã‚Šã«ä½¿ã„ã‚„ã™ã„ã‚ˆã†ã«æ•´ç†ã—ã¾ã™ã€‚

å„CLIã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ã‚‹ã®ã§ã€ç›´æ¥å®Ÿè¡Œã™ã‚‹ã®ã§ã€ä¸è¦ãªscriptã‚’å‰Šé™¤ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚


### CLI

supabase
Stripe
Vercel

#### CLIã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

scoopã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

â€»VSCodeã®powershellã¯scoopãŒæœ€åˆã‹ã‚‰ä½¿ãˆã‚‹ã¯ãšã§ã™ã€‚


##### Supabase CLI ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Supabase CLI | Supabase Docs

https://supabase.com/docs/guides/cli/getting-started?queryGroups=platform&platform=windows

```terminal
# install
scoop bucket add supabase https://github.com/supabase/scoop-bucket.git
scoop install supabase

# update
scoop update supabase

```



##### Stripe CLI ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Stripe CLI ã‚’ä½¿ã£ã¦ã¿ã‚‹ | Stripe ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

https://docs.stripe.com/stripe-cli?locale=ja-JP

```terminal
scoop bucket add stripe https://github.com/stripe/scoop-stripe-cli.git

scoop install stripe

```



##### Vercel CLI ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Vercel CLI Overview

https://vercel.com/docs/cli

```terminal
# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pnpm i -g vercel

# update
pnpm i -g vercel@latest

vercel --version

```


ãã‚Œãã‚Œã®CLIã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã‚ã‚Œã°npxã‚’ä½¿ã‚ãªãã¦ã‚‚å®Ÿè¡Œã§ãã¾ã™ã€‚

ç‰¹ã«Supabaseã®CLIã‚’æ•´ç†ã—ã¾ã™ã€‚

â†“ä¿®æ­£å‰ã®package.jsonã®script

```package.json
ãƒ»ãƒ»ãƒ»
  "scripts": {
    "dev": "next dev --turbo",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "prettier-fix": "prettier --write .",
    "stripe:login": "stripe login",
    "stripe:listen": "stripe listen --forward-to=localhost:3000/api/webhooks",
    "stripe:fixtures": "stripe fixtures fixtures/stripe-fixtures.json",
    "supabase:start": "npx supabase start",
    "supabase:stop": "npx supabase stop",
    "supabase:status": "npx supabase status",
    "supabase:restart": "npm run supabase:stop && npm run supabase:start",
    "supabase:reset": "npx supabase reset",
    "supabase:link": "npx supabase link",
    "supabase:generate-types": "npx supabase gen types typescript --local --schema public > types_db.ts",
    "supabase:generate-migration": "npx supabase db diff | npx supabase migration new",
    "supabase:generate-seed": "npx supabase db dump --data-only -f supabase/seed.sql",
    "supabase:push": "npx supabase push",
    "supabase:pull": "npx supabase pull"
  },

ãƒ»ãƒ»ãƒ»

```



ä¾‹ãˆã°ã€

```package.json
    "supabase:start": "npx supabase start",

```

ç­‰ã¯
Supabaseã®CLIã‚’ã‚¤ãƒ³ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã®ã§ã€npxã§å®Ÿè¡Œã™ã‚‹å¿…è¦ã¯ãªã„ã®ã§å‰Šé™¤ã—ã¾ã™ã€‚

stripeã®CLIã‚‚ã‚¤ãƒ³ãƒˆãƒ¼ãƒ«ã—ã¦ãŠãã¾ã™ã€‚



â†“ä¸è¦ãªScriptã®å‰Šé™¤å¾Œã®package.json

```package.json
  "scripts": {
    "dev": "next dev --turbo",
    "build": "next build",
    "start": "next start",
    "lint": "eslint --ext .ts,.js,.tsx,.jsx src",
    "lint:debug": "eslint --ext .ts,.js,.tsx,.jsx src --debug",
    "lint:fix": "eslint --ext .ts,.js,.tsx,.jsx src --fix",
    "prettier-fix": "prettier --write .",
    "test": "vitest --run",
    "test:ui": "vitest --ui",
    "coverage": "vitest run --coverage",
    "storybook": "storybook dev -p 6006",
    "build-storybook": "storybook build",
    "stripe:login": "stripe login",
    "stripe:listen": "stripe listen --forward-to=localhost:3000/api/webhooks",
    "stripe:fixtures": "stripe fixtures fixtures/stripe-fixtures.json"
  },

```

â€»å¾Œã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹vitestã€storybookãªã©ã®scriptã‚‚ä¸€ç·’ã«è¨­å®šã—ã¦ã„ã¾ã™ã€‚



## Stripeã®ã‚³ãƒãƒ³ãƒ‰

terminalä¸Šã§ç›´æ¥ã‚³ãƒãƒ³ãƒ‰ã‚’å©ãã¾ã™ã€‚

```terminal
stripe login
stripe listen --forward-to http://127.0.0.1:3000/api/webhooks
stripe fixtures fixtures/stripe-fixtures.json

```

fixtures/stripe-fixtures.json ã‚’ç·¨é›†ã—ã¦ä¾¡æ ¼è¨­å®šã‚’ã™ã‚‹ã¨åæ˜ ã•ã‚Œã¾ã™ã€‚



## Supabaseã®ã‚³ãƒãƒ³ãƒ‰

terminalä¸Šã§ç›´æ¥ã‚³ãƒãƒ³ãƒ‰ã‚’å©ãã¾ã™ã€‚

```terminal
supabase start
supabase stop
supabase status
supabase reset
supabase link

supabase gen types typescript --local > src/types/types_db.ts

supabase db diff
supabase migration new

supabase db dump --data-only -f supabase/seed.sql

supabase push
supabase pull

```

supabaseã®CLIã‚’ç›´æ¥å©ã (npxã¯ä½¿ã‚ãªã„)

â€»supabaseã®restartã¯å‰Šé™¤

â€»supabaseã®CLIã¯ç›´æ¥å©ã‘ã‚‹ã‚ˆã†ã«ã—ã¦ãŠã„ãŸã»ã†ãŒè‰¯ã„ã¨æ€ã„ã¾ã™ã€‚
supabaseã®ã‚³ãƒãƒ³ãƒ‰ã¯ä»–ã«ã‚‚è‰²ã€…ã¨ã‚ã‚Šã¾ã™ã€‚



## gité–‹ç™ºãƒ–ãƒ©ãƒ³ãƒ

main		ãƒ¡ã‚¤ãƒ³
dev			é–‹ç™º


devã§é–‹ç™ºã—ã¦ãƒã‚§ãƒƒã‚¯ã—ã¦ã‚¨ãƒ©ãƒ¼ãŒãªãã€ãƒ“ãƒ«ãƒ‰ãŒé€šã£ãŸã‚‰mainã«ãƒãƒ¼ã‚¸ã—ã¦
mainã¯githubã¸pushã—ã¾ã™ã€‚

ã“ã‚Œã¯huskyã‚’ä½¿ã†ã¨åŠè‡ªå‹•åŒ–ã•ã‚Œã¾ã™ã€‚
é‡è¦ãªæ±ºå®šã¯äººé–“ã®æ‰‹ã§ã€ãã‚Œä»¥å¤–ã¯è‡ªå‹•åŒ–ã«å‡ºæ¥ã¾ã™ã€‚



## ncuã®å°å…¥ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ

ncuã¯ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’èª¿ã¹ã‚‹ï¼†æ›´æ–°ã—ã¦ãã‚Œã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®vulnerabilityå¯¾å¿œãƒ•ãƒ­ãƒ¼ - Qiita
https://qiita.com/riversun/items/7f1679509f38b1ae8adb

```terminal
# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒæœ€æ–°ã‹ç¢ºèªã—ã¾ã™ã€‚
pnpm outdated

# å…¨ã¦æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ãŸã„å ´åˆã¯
ncu -u

```


## ãƒ¡ã‚¸ãƒ£ãƒ¼ã‹ãƒã‚¤ãƒŠãƒ¼ã‹ã€ã©ã“ã¾ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã™ã‚‹ã®ã‹ã‚’é¸ã¶

### ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¾ã§æœ€æ–°ã«ã—ãŸã„å ´åˆ

```terminal
# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm i -g npm-check-updates

# å…¨ã¦æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ãŸã„å ´åˆã¯
ncu -u

# ã¨ã—ã¦ã‹ã‚‰ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦
pnpm install

```

### ãƒã‚¤ãƒŠãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¾ã§æœ€æ–°ã«ã™ã‚‹å ´åˆ

```terminal
pnpm update

```

## ã‚‚ã†ä¸€åº¦ç¢ºèªã™ã‚‹

```terminal
pnpm outdated

# ç¢ºèªã—ã¦ã“ã‚Œã§è‰¯ã„ã®ãªã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’ã™ã‚‹ã€‚
npm install --legacy-peer-deps
pnpm install --legacy-peer-deps

```



----------------------------------------
----------------------------------------
----------------------------------------

ãã‚Œã§ã¯å®Ÿéš›ã«ãƒ„ãƒ¼ãƒ«ã®è¿½åŠ ã‚’ã¯ã˜ã‚ã¾ã™ã€‚
ãã®å‰ã«ãƒˆãƒƒãƒ—ç”»é¢ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®æ§‹é€ ã‚’æŠŠæ¡ã—ã¦ãŠãã¾ã™ã€‚



# TOPç”»é¢ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®åŸºæœ¬æ§‹æˆã®ä½¿ç”¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã§ä½¿ã‚ã‚Œã¦ã„ã‚‹ãƒˆãƒƒãƒ—ç”»é¢ã®ä½¿ç”¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®æ§‹æˆã€‚
ã“ã‚Œã‚‰ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã™ã‚Œã°ã€ãƒˆãƒƒãƒ—ç”»é¢ãŒã‚¯ãƒªãƒ¼ãƒ³ã«ãªã‚Šã¾ã™ã€‚


```src\app\layout.tsx
export default async function RootLayout({ children }: PropsWithChildren) {
  return (
    <html lang="en">
      <body className="bg-black loading">
        {/* <Navbar /> */}
        <main
          id="skip"
          className="min-h-[calc(100dvh-4rem)] md:min-h[calc(100dvh-5rem)]"
        >
          {children}
        </main>
        {/* <Footer /> */}
        <Suspense>
          <Toaster />
        </Suspense>
      </body>
    </html>
  );
}

```

ğŸ‘†<Navbar />ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨<Footer />ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ



ç”»é¢ä¸Šéƒ¨(ãƒ˜ãƒƒãƒ€ãƒ¼éƒ¨åˆ†)

```
app\layout.tsx
	components\ui\Navbar\Navbar.tsx

```

ç”»é¢ä¸‹éƒ¨(ãƒ•ãƒƒã‚¿ãƒ¼éƒ¨åˆ†)

```
app\layout.tsx
	components\ui\Footer\Footer.tsx

```





æœ¬ä½“

```
app\page.tsx
	components\ui\Pricing\Pricing.tsx

```

src\app\page.tsxã‚’ã‚³ãƒ”ãƒ¼ã—ã¦
src\app\PricingPage.tsxã¨åå‰ã‚’å¤‰æ›´ã—ã¾ã™ã€‚
ãã—ã¦ã€ãã‚Œã‚’importã—ã¾ã™ã€‚

```src\app\page.tsx
import PricingPage from "./PricingPage";

export default function Page() {
  return (
    <div className="">
      <PricingPage />
    </div>
  );
}

```

â€»PricingPageã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã—ã¦å‘¼ã³å‡ºã—ã¦ã„ã¾ã™ã€‚

ã“ã‚Œã§åˆ‡ã‚Šåˆ†ã‘ã‚‰ã‚ŒãŸã®ã§
<PricingPage />
ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¦ãŠãã¾ã™ã€‚

ã‚³ãƒ”ãƒ¼ã—ãŸ
src\app\PricingPage.tsx
ã¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ãªã£ãŸã®ã§ã€
src\components\PricingPage.tsx
ã¸ç§»å‹•ã—ã¾ã™ã€‚

http://localhost:3000/
ã‚’ã¿ã‚Œã°ã€Pricing PlansãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã¯ãšã§ã™ã€‚

<PricingPage />ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã™ã‚Œã°ã€
TOPç”»é¢ãŒãã‚Œã„ã«ãªã‚Šã¾ã—ãŸã€‚
ã“ã‚Œã§ã€æ§‹æƒ³ã—ã¦ã„ãŸã‚¢ãƒ—ãƒªã‚’ã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

å¿…è¦ã«ãªã£ãŸã‚‰å¾Œã§ã€
<Navbar />
<Footer />
<PricingPage />
ã‚’ã‚³ãƒ¼ãƒ‰ã«æˆ»ã—ã¦ãã ã•ã„ã€‚



----------------------------------------
----------------------------------------
----------------------------------------

# é–‹ç™ºã‚’åŠ©ã‘ã¦ãã‚Œã‚‹ãƒ„ãƒ¼ãƒ«ã®å°å…¥

Next.js ã® ESLintã¨Prettierã€turborepoã€husky Next.jså…¬å¼ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ç‹¬è‡ªèª¿æŸ» #Next.js - Qiita

https://qiita.com/masakinihirota/items/f1a4796ad3a535f27664

â€»é•·ã„ã®ã§åˆ¥ã®è¨˜äº‹ã«åˆ†ã‘ã¾ã—ãŸã€‚

ã“ã®è¨˜äº‹ã®ä¸€éƒ¨ã‚’ãƒ™ãƒ„ã®Blogã«åˆ‡ã‚Šåˆ†ã‘ã¦ã„ã‚‹ã ã‘ã§ã€å®Ÿè³ªçš„ãªç¶šãã§ã™ã€‚
ESLint ã‚„ Prettierã€ turborepoã€ husky ã‚’å°å…¥ã—ãŸã„å ´åˆã¯åˆ©ç”¨ã—ã¦ãã ã•ã„ã€‚

```text
ESLint é™çš„è§£æãƒ„ãƒ¼ãƒ«
prettier ã‚³ãƒ¼ãƒ‰ã®æ•´å½¢ãƒ„ãƒ¼ãƒ«
husky Gitãƒªãƒã‚¸ãƒˆãƒªã®ã‚³ãƒŸãƒƒãƒˆæ™‚ã€ãƒ—ãƒƒã‚·ãƒ¥æ™‚ã«å®Ÿè¡Œã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç®¡ç†ã™ã‚‹ãƒ„ãƒ¼ãƒ«
Turborepo ä¸¦åˆ—å‡¦ç†ã‚’ä½¿ç”¨ã—ã¦é«˜é€Ÿã«ãƒ“ãƒ«ãƒ‰ã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«

```

ã“ã‚Œã‚‰ã‚’å°å…¥ã™ã‚‹ã¨ã€ã‚³ãƒŸãƒƒãƒˆå‰ã€ãƒ—ãƒƒã‚·ãƒ¥å‰ã«ã‚¨ãƒ©ãƒ¼ã«æ°—ã¥ã‘ã¾ã™ã€‚



## å‚è€ƒ

VSCodeã§å‹•ã‹ã™ Prettier å‚™å¿˜éŒ² #VSCode - Qiita

https://qiita.com/masakinihirota/items/26ba5ac12b476bc97751



----------------------------------------
----------------------------------------
----------------------------------------

# i18n å›½éš›åŒ–

å›½éš›åŒ–ã®æ‰‹é †ã¯â†“ã«åˆ†ã‘ã¦ã¾ã™ã€‚

Next.js App Router ã®å›½éš›åŒ– i18n (i18next react-i18next ä»–) ãƒãƒ³ã‚ºã‚ªãƒ³ #Next.js - Qiita
https://qiita.com/masakinihirota/items/9a4d54fbaa89a67106da



----------------------------------------

â€»é‡è¦

ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã®ãƒªãƒã‚¸ãƒˆãƒªã®package.jsonã®scriptã®devã«ã¯

```package.json
   "dev": "next dev --turbo",

```

ã“ã®ã‚ˆã†ã«ã€--turboã‚ªãƒ–ã‚·ãƒ§ãƒ³ãŒã¤ã„ã¦ã„ã¾ã™ãŒã€ã“ã®å›½éš›åŒ–ã‚’ã™ã‚‹æ™‚ã«è¨€èªå¤‰æ›ãŒã†ã¾ãã„ãªã‹ããªã‚‹ã®ã§ã€

â†“--turboã‚ªãƒ–ã‚·ãƒ§ãƒ³ã¯å‰Šé™¤ã—ã¦ãã ã•ã„ã€‚

```package.json
   "dev": "next dev",

```



----------------------------------------

## ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```terminal
pnpm install i18next react-i18next i18next-resources-to-backend accept-language react-cookie i18next-browser-languagedetector

```



----------------------------------------

## ä¸‹æº–å‚™

i18nã‚’å°å…¥ã™ã‚‹æ™‚ã€
ä¸è¦ã€ã‚‚ã—ãã¯è¢«ã£ã¦ã—ã¾ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é€€é¿ã•ã›ã¦ãŠãã¾ã™ã€‚

é©å½“ãªãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œã£ã¦ãã“ã«
src\app\page.js
src\app\layout.tsx
src\middleware.ts
ã‚’é€€é¿ã—ã¦ãŠãã¾ã™ã€‚



----------------------------------------

## 1 Folder structure

å›½éš›åŒ–ã—ãŸæ™‚ã®ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã‚’ä½œã£ã¦ã„ã¾ã™ã€‚

```terminal
mkdir src/app/[lng]/
touch src/app/[lng]/page.js

```

```src/app/[lng]/page.js
import Link from 'next/link'

export default function Page({ params: { lng } }) {
  return (
    <>
      <h1>Hi there!</h1>
      <Link href={`/${lng}/second-page`}>
        second page
      </Link>
    </>
  )
}

```



```terminal
mkdir src/app/[lng]/second-page/
touch src/app/[lng]/second-page/page.js

```

```src/app/[lng]/second-page/page.js
import Link from 'next/link'

export default function Page({ params: { lng } }) {
  return (
    <>
      <h1>Hi from second page!</h1>
      <Link href={`/${lng}`}>
        back
      </Link>
    </>
  )
}

```



```terminal
touch src/app/[lng]/layout.js

```

```src/app/[lng]/layout.js
import { dir } from 'i18next'

const languages = ['en', 'de']

export async function generateStaticParams() {
  return languages.map((lng) => ({ lng }))
}

export default function RootLayout({
  children,
  params: {
    lng
  }
}) {
  return (
    <html lang={lng} dir={dir(lng)}>
      <head />
      <body>
        {children}
      </body>
    </html>
  )
}

```

```terminal
pnpm run dev

```



### å‹•ä½œç¢ºèª

è¡¨ç¤ºã•ã‚Œã‚‹ã€ãƒªãƒ³ã‚¯ã‚‚å‹•ä½œã™ã‚‹
http://localhost:3000/ja
http://localhost:3000/en
http://localhost:3000/de
http://localhost:3000/aaa

404 This page could not be found.
http://localhost:3000/



----------------------------------------

## 2 Language detection

```terminal
mkdir src/app/i18n/
touch src/app/i18n/settings.js

```

```src/app/i18n/settings.js
export const fallbackLng = 'ja'
export const languages = [fallbackLng, 'en']

```



ç·¨é›† src/app/[lng]/layout.js

```src/app/[lng]/layout.js
import { dir } from 'i18next'
import { languages } from '../i18n/settings'

export async function generateStaticParams() {
  return languages.map((lng) => ({ lng }))
}

export default function RootLayout({
  children,
  params: {
    lng
  }
}) {
  return (
    <html lang={lng} dir={dir(lng)}>
      <head />
      <body>
        {children}
      </body>
    </html>
  )
}

```



```terminal
touch src/middleware.js

```

```src/middleware.js
import { NextResponse } from 'next/server'
import acceptLanguage from 'accept-language'
import { fallbackLng, languages, cookieName } from './app/i18n/settings'

acceptLanguage.languages(languages)

export const config = {
  // matcher: '/:lng*'
  matcher: ['/((?!api|_next/static|_next/image|assets|favicon.ico|sw.js).*)']
}

export function middleware(req) {
  let lng
  if (req.cookies.has(cookieName)) lng = acceptLanguage.get(req.cookies.get(cookieName).value)
  if (!lng) lng = acceptLanguage.get(req.headers.get('Accept-Language'))
  if (!lng) lng = fallbackLng

  // Redirect if lng in path is not supported
  if (
    !languages.some(loc => req.nextUrl.pathname.startsWith(`/${loc}`)) &&
    !req.nextUrl.pathname.startsWith('/_next')
  ) {
    return NextResponse.redirect(new URL(`/${lng}${req.nextUrl.pathname}`, req.url))
  }

  if (req.headers.has('referer')) {
    const refererUrl = new URL(req.headers.get('referer'))
    const lngInReferer = languages.find((l) => refererUrl.pathname.startsWith(`/${l}`))
    const response = NextResponse.next()
    if (lngInReferer) response.cookies.set(cookieName, lngInReferer)
    return response
  }

  return NextResponse.next()
}

```



### å‹•ä½œç¢ºèª

è¡¨ç¤ºã•ã‚Œã‚‹ã€ãƒªãƒ³ã‚¯ã‚‚å‹•ä½œã™ã‚‹
http://localhost:3000/ja
http://localhost:3000/en

404(ç™»éŒ²ã—ã¦ã„ãªã„è¨€èª)
http://localhost:3000/de
http://localhost:3000/aaa

è‡ªå‹•é·ç§»
http://localhost:3000/
â†“
http://localhost:3000/ja



----------------------------------------

## 3 i18n instrumentation

```terminal
touch src/app/i18n/index.js

```

```src/app/i18n/index.js
import { createInstance } from 'i18next'
import resourcesToBackend from 'i18next-resources-to-backend'
import { initReactI18next } from 'react-i18next/initReactI18next'
import { getOptions } from './settings'

const initI18next = async (lng, ns) => {
  const i18nInstance = createInstance()
  await i18nInstance
    .use(initReactI18next)
    .use(resourcesToBackend((language, namespace) => import(`./locales/${language}/${namespace}.json`)))
    .init(getOptions(lng, ns))
  return i18nInstance
}

export async function useTranslation(lng, ns, options = {}) {
  const i18nextInstance = await initI18next(lng, ns)
  return {
    t: i18nextInstance.getFixedT(lng, Array.isArray(ns) ? ns[0] : ns, options.keyPrefix),
    i18n: i18nextInstance
  }
}

```


ç·¨é›† src/app/i18n/settings.js

```src/app/i18n/settings.js
export const fallbackLng = 'ja'
export const languages = [fallbackLng, 'en']
export const defaultNS = 'translation'
export const cookieName = 'i18next'

export function getOptions (lng = fallbackLng, ns = defaultNS) {
  return {
    // debug: true,
    supportedLngs: languages,
    fallbackLng,
    lng,
    fallbackNS: defaultNS,
    defaultNS,
    ns
  }
}

```



### ã‚³ãƒ¼ãƒ‰è§£èª¬

- `fallbackLng`ã¨ã„ã†å®šæ•°ã«ã€æ–‡å­—åˆ—"ja"ã‚’ä»£å…¥ã—ã¦ã„ã¾ã™ã€‚
- `fallbackLng`ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¨€èªã‚’æŒ‡å®šã™ã‚‹ãŸã‚ã®å®šæ•°ã§ã™ã€‚

- `defaultNS`ã¨ã„ã†å®šæ•°ã«ã€æ–‡å­—åˆ—"translation"ã‚’ä»£å…¥ã—ã¦ã„ã¾ã™ã€‚
- `defaultNS`ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® å‘½åç©ºé–“ ã‚’æŒ‡å®šã™ã‚‹ãŸã‚ã®å®šæ•°ã§ã™ã€‚NSã¯nema space (å‘½åç©ºé–“) ã®ç•¥èªã§ã™ã€‚

- `cookieName`ã¨ã„ã†å®šæ•°ã«ã€æ–‡å­—åˆ—"i18next"ã‚’ä»£å…¥ã—ã¦ã„ã¾ã™ã€‚
- `cookieName`ã¯ã€i18nextãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒä½¿ç”¨ã™ã‚‹ã‚¯ãƒƒã‚­ãƒ¼ã®åå‰ã‚’ã¤ã‘ã¦ã„ã¾ã™ã€‚

- `languages`ã¨ã„ã†å®šæ•°ã«ã€é…åˆ—[fallbackLng, "en"]ã‚’ä»£å…¥ã—ã¦ã„ã¾ã™ã€‚
- `languages`ã¯ã€ã‚µãƒãƒ¼ãƒˆã™ã‚‹è¨€èªã®é…åˆ—ã‚’æŒ‡å®šã™ã‚‹ãŸã‚ã®å®šæ•°ã§ã™ã€‚
- `fallbackLng`ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¨€èªã‚’æŒ‡å®šã™ã‚‹ãŸã‚ã®å®šæ•°ã§ã‚ã‚Šã€é…åˆ—ã®æœ€åˆã®è¦ç´ ã¨ã—ã¦ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

- `getOptions`é–¢æ•°ã¯ã€è¨€èªã¨å‘½åç©ºé–“ã‚’å¼•æ•°ã«å–ã‚Šã€i18nextãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¿”ã—ã¾ã™ã€‚
- `lng`ã¨`ns`ã¯ã€ãã‚Œãã‚Œä½¿ç”¨ã™ã‚‹è¨€èªã¨å‘½åç©ºé–“ã‚’æŒ‡å®šã™ã‚‹ãŸã‚ã®å¼•æ•°ã§ã™ã€‚

- `supportedLngs`ã¯ã€ã‚µãƒãƒ¼ãƒˆã™ã‚‹è¨€èªã®é…åˆ—ã‚’æŒ‡å®šã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚

- `fallbackLng`ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¨€èªã‚’æŒ‡å®šã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚
- `lng`ã¯ã€ä½¿ç”¨ã™ã‚‹è¨€èªã‚’æŒ‡å®šã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚
- `lng`ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯`fallbackLng`ã§ã™ã€‚

- `fallbackNS`ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®å‘½åç©ºé–“ã‚’æŒ‡å®šã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚
- `defaultNS`ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®å‘½åç©ºé–“ã‚’æŒ‡å®šã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚

- `ns`ã¯ã€ä½¿ç”¨ã™ã‚‹å‘½åç©ºé–“ã‚’æŒ‡å®šã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚
- `ns`ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯`defaultNS`ã§ã™ã€‚



### å‘½åç©ºé–“ï¼ˆnamespaceï¼‰ã¨ã¯ï¼Ÿ

ãƒ—ãƒ­ã‚°ãƒ©ãƒ å†…ã§ä½¿ç”¨ã•ã‚Œã‚‹è­˜åˆ¥å­ï¼ˆå¤‰æ•°åã€é–¢æ•°åã€ã‚¯ãƒ©ã‚¹åãªã©ï¼‰
ã®ã‚¹ã‚³ãƒ¼ãƒ—ã‚’é™å®šã™ã‚‹ãŸã‚ã®ä»•çµ„ã¿ã§ã™ã€‚

å‘½åç©ºé–“ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€
åŒã˜åå‰ã®è­˜åˆ¥å­ãŒè¤‡æ•°å­˜åœ¨ã™ã‚‹å ´åˆã«ã€ãã‚Œã‚‰ã‚’åŒºåˆ¥ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

i18nextãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã¯ã€ç¿»è¨³å¯¾è±¡ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’è¤‡æ•°ã®å‘½åç©ºé–“ã«åˆ†ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ä¾‹ãˆã°ã€ãƒœã‚¿ãƒ³ã®ãƒ©ãƒ™ãƒ«ã‚’"button.label"ã¨ã„ã†å‘½åç©ºé–“ã«ã€
ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®é …ç›®ã‚’"menu.item"ã¨ã„ã†å‘½åç©ºé–“ã«åˆ†ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã€ç¿»è¨³å¯¾è±¡ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚ˆã‚Šç´°ã‹ãç®¡ç†ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

å‘½åç©ºé–“ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€
ç¿»è¨³å¯¾è±¡ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚ˆã‚Šç´°ã‹ãç®¡ç†ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ä¾‹ãˆã°ã€åŒã˜è¨€èªã§ã‚ã£ã¦ã‚‚ã€
ãƒœã‚¿ãƒ³ã®ãƒ©ãƒ™ãƒ«ã‚„ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®é …ç›®ãªã©ã€
ç¿»è¨³å¯¾è±¡ã®ãƒ†ã‚­ã‚¹ãƒˆã®ç¨®é¡ã«ã‚ˆã£ã¦ã¯ç¿»è¨³å†…å®¹ãŒç•°ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

ã¾ãŸã€è¤‡æ•°ã®ãƒšãƒ¼ã‚¸ã‚„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ä½¿ç”¨ã•ã‚Œã‚‹ãƒ†ã‚­ã‚¹ãƒˆãŒã‚ã‚‹å ´åˆã€
ãã‚Œã‚‰ã‚’å…±é€šã®å‘½åç©ºé–“ã«ã¾ã¨ã‚ã‚‹ã“ã¨ã§é‡è¤‡ã—ãŸç¿»è¨³ã®ä½œæˆã‚’é¿ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã•ã‚‰ã«ã€å‘½åç©ºé–“ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ç¿»è¨³å¯¾è±¡ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ãŸã‚ã€
ç¿»è¨³ã®ä¿®æ­£ã‚„è¿½åŠ ãŒå®¹æ˜“ã«ãªã‚Šã¾ã™ã€‚

ä¾‹ãˆã°ã€Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å ´åˆã€è¤‡æ•°ã®ãƒšãƒ¼ã‚¸ã‚„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ä½¿ç”¨ã•ã‚Œã‚‹ãƒ†ã‚­ã‚¹ãƒˆãŒã‚ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ã“ã®å ´åˆã€å‘½åç©ºé–“ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ç¿»è¨³å¯¾è±¡ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ä¾‹ãˆã°ã€ä»¥ä¸‹ã®ã‚ˆã†ãªå‘½åç©ºé–“ã‚’è¨­å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ä¾‹

```javascript
export const defaultNS = "common"

export const namespaces = [
  "common",
  "home",
  "about",
  "contact",
]

```

ã“ã®å ´åˆã€"common"ã¨ã„ã†å‘½åç©ºé–“ã«ã¯ã€
è¤‡æ•°ã®ãƒšãƒ¼ã‚¸ã‚„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ä½¿ç”¨ã•ã‚Œã‚‹å…±é€šã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã¾ã¨ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã¾ãŸã€"home"ã‚„"about"ã€"contact"ã¨ã„ã£ãŸãƒšãƒ¼ã‚¸ã”ã¨ã«å‘½åç©ºé–“ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€
å„ãƒšãƒ¼ã‚¸ã§ä½¿ç”¨ã•ã‚Œã‚‹ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã€ç¿»è¨³ã®ä¿®æ­£ã‚„è¿½åŠ ãŒå®¹æ˜“ã«ãªã‚Šã¾ã™ã€‚
ä¾‹ãˆã°ã€"common"ã¨ã„ã†å‘½åç©ºé–“ã«ã‚ã‚‹ãƒ†ã‚­ã‚¹ãƒˆã‚’ä¿®æ­£ã™ã‚‹å ´åˆã€
ã™ã¹ã¦ã®ãƒšãƒ¼ã‚¸ã‚„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ä½¿ç”¨ã•ã‚Œã‚‹ãƒ†ã‚­ã‚¹ãƒˆãŒä¿®æ­£ã•ã‚Œã¾ã™ã€‚

ã¾ãŸã€æ–°ã—ã„ãƒšãƒ¼ã‚¸ã‚’è¿½åŠ ã™ã‚‹å ´åˆã«ã¯ã€
æ–°ã—ã„å‘½åç©ºé–“ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€
æ–°ã—ã„ãƒšãƒ¼ã‚¸ã§ä½¿ç”¨ã•ã‚Œã‚‹ãƒ†ã‚­ã‚¹ãƒˆã‚’ç°¡å˜ã«ç®¡ç†ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚



### ç¿»è¨³ãƒ•ã‚¡ã‚¤ãƒ«

```text
src
â””â”€â”€ app
    â””â”€â”€ i18n
        â””â”€â”€ locales
            â”œâ”€â”€ de
            â”‚   â”œâ”€â”€ translation.json
            â”‚   â””â”€â”€ second-page.json
            â”œâ”€â”€ en
            â”‚   â”œâ”€â”€ translation.json
            â”‚   â””â”€â”€ second-page.json
            â””â”€â”€ ja
                â”œâ”€â”€ translation.json
                â””â”€â”€ second-page.json

```



```terminal
mkdir src/app/i18n/locales/de/
mkdir src/app/i18n/locales/en/
mkdir src/app/i18n/locales/ja/

touch src/app/i18n/locales/de/translation.json
touch src/app/i18n/locales/en/translation.json
touch src/app/i18n/locales/ja/translation.json

touch src/app/i18n/locales/de/second-page.json
touch src/app/i18n/locales/en/second-page.json
touch src/app/i18n/locales/ja/second-page.json

```

```src/app/i18n/locales/de/translation.json
{
  "title": "Hallo und willkommen bei VNS.BLUE!",
  "to-second-page": "Zur zweiten Seite",
  "to-client-page": "Zur clientseitigen Seite"
}

```

```src/app/i18n/locales/en/translation.json
{
  "title": "Hello and welcome to VNS.BLUE!",
  "to-second-page": "To second page",
  "to-client-page": "To client page"
}

```

```src/app/i18n/locales/ja/translation.json
{
  "title": "ã“ã‚“ã«ã¯ã€VNS.BLUEã¸ã‚ˆã†ã“ã!",
  "to-second-page": "2ãƒšãƒ¼ã‚¸ç›®ã¸",
  "to-client-page": "ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒšãƒ¼ã‚¸ã¸"
}

```


```src/app/i18n/locales/de/second-page.json
{
  "title": "Hallo von der zweiten Seite!",
  "back-to-home": "ZurÃ¼ck zur Seite 1"
}

```

```src/app/i18n/locales/en/second-page.json
{
  "title": "Hi from second page!",
  "back-to-home": "Go back to page 1 "
}

```

```src/app/i18n/locales/ja/second-page.json
{
  "title": "ã“ã“ã¯2ãƒšãƒ¼ã‚¸ç›®ã§ã™ã€‚",
  "back-to-home": "ï¼‘ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹"
}

```


ç·¨é›† src/app/[lng]/page.js

```src/app/[lng]/page.js
import Link from 'next/link'

import { useTranslation } from '../i18n'

export default async function Page({ params: { lng } }) {
  const { t } = await useTranslation(lng)
  return (
    <>
      <h1>{t('title')}</h1>
      <Link href={`/${lng}/second-page`}>
        {t('to-second-page')}
      </Link>
    </>
  )
}

```



ç·¨é›† src/app/[lng]/second-page/page.js

```src/app/[lng]/second-page/page.js
import Link from 'next/link'

import { useTranslation } from '../../i18n'

export default async function Page({ params: { lng } }) {
  const { t } = await useTranslation(lng, 'second-page')
  return (
    <>
      <h1>{t('title')}</h1>
      <Link href={`/${lng}`}>
        {t('back-to-home')}
      </Link>
    </>
  )
}


```



### å‹•ä½œç¢ºèª

Hello
http://localhost:3000/ja
http://localhost:3000/en

404
http://localhost:3000/de
http://localhost:3000/aaa

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨€èªã«é·ç§»
http://localhost:3000/
â†“
http://localhost:3000/ja



----------------------------------------

## 4. Language switcher

```terminal
mkdir src/app/[lng]/components/Footer/
touch src/app/[lng]/components/Footer/index.js

```

```src/app/[lng]/components/Footer/index.js
import Link from 'next/link'
import { Trans } from 'react-i18next/TransWithoutContext'

import { useTranslation } from '../../../i18n'
import { languages } from '../../../i18n/settings'

export const Footer = async ({ lng }) => {
  const { t } = await useTranslation(lng, 'footer')
  return (
    <footer style={{ marginTop: 50 }}>
      <Trans i18nKey="languageSwitcher" t={t}>
        Switch from <strong>{{lng}}</strong> to:{' '}
      </Trans>
      {languages.filter((l) => lng !== l).map((l, index) => {
        return (
          <span key={l}>
            {index > 0 && (' or ')}
            <Link href={`/${l}`}>
              {l}
            </Link>
          </span>
        )
      })}
    </footer>
  )
}

```


### ç¿»è¨³ãƒ•ã‚¡ã‚¤ãƒ«

```terminal
touch src/app/i18n/locales/de/footer.json
touch src/app/i18n/locales/en/footer.json
touch src/app/i18n/locales/ja/footer.json

```



```src/app/i18n/locales/de/footer.json
{
  "languageSwitcher": "Wechseln von <1>{{lng}}</1> nach: "
}

```

```src/app/i18n/locales/en/footer.json
{
  "languageSwitcher": "Switch from <1>{{lng}}</1> to: "
}

```

```src/app/i18n/locales/ja/footer.json
{
  "languageSwitcher": "å¤‰æ›´ã™ã‚‹ <1>{{lng}}</1> ã‹ã‚‰ "
}

```



ç·¨é›† src/app/[lng]/page.js

```src/app/[lng]/page.js
import Link from 'next/link'

import { Footer } from './components/Footer'
import { useTranslation } from '../i18n'

export default async function Page({ params: { lng } }) {
  const { t } = await useTranslation(lng)
  return (
    <>
      <h1>{t('title')}</h1>
      <Link href={`/${lng}/second-page`}>
        {t('to-second-page')}
      </Link>
      <Footer lng={lng}/>
    </>
  );
}

```

ğŸ‘†<Footer>ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è¿½åŠ 



ç·¨é›† src/app/[lng]/second-page/page.js


```src/app/[lng]/second-page/page.js
import Link from 'next/link'

import { useTranslation } from '../../i18n'
import { Footer } from '../components/Footer'

export default async function Page({ params: { lng } }) {
  const { t } = await useTranslation(lng, 'second-page')
  return (
    <>
      <h1>{t('title')}</h1>
      <Link href={`/${lng}`}>
        {t('back-to-home')}
      </Link>
      <Footer lng={lng}/>
    </>
  );
}

```

ğŸ‘†<Footer>ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è¿½åŠ 



### å‹•ä½œç¢ºèª

http://localhost:3000/en
http://localhost:3000/ja

Footerã®ãƒªãƒ³ã‚¯ã§è¨€èªå¤‰æ›ãŒå‡ºæ¥ã‚‹ã€‚



----------------------------------------

## 5. Client side

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã‚‚ç¿»è¨³ã—ã¾ã™ã€‚
ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãªã®ã§ Reactã®Hooks ã‚„ buttonç­‰ã®UI ãŒä½¿ãˆã¾ã™ã€‚


```terminal
touch src/app/i18n/client.js

```

```src/app/i18n/client.js
'use client'

import i18next from 'i18next'
import LanguageDetector from 'i18next-browser-languagedetector'
import resourcesToBackend from 'i18next-resources-to-backend'
import { useEffect, useState } from 'react'
import { useCookies } from 'react-cookie'
import { initReactI18next, useTranslation as useTranslationOrg } from 'react-i18next'

import { getOptions, languages, cookieName } from './settings'

const runsOnServerSide = typeof window === 'undefined'

i18next
  .use(initReactI18next)
  .use(LanguageDetector)
  .use(resourcesToBackend((language, namespace) => import(`./locales/${language}/${namespace}.json`)))
  .init({
    ...getOptions(),
    lng: undefined, // let detect the language on client side
    detection: {
      order: ['path', 'htmlTag', 'cookie', 'navigator'],
    },
    preload: runsOnServerSide ? languages : []
  })

export function useTranslation(lng, ns, options) {
  const [cookies, setCookie] = useCookies([cookieName])
  const ret = useTranslationOrg(ns, options)
  const { i18n } = ret
  if (runsOnServerSide && lng && i18n.resolvedLanguage !== lng) {
    i18n.changeLanguage(lng)
  } else {
    // eslint-disable-next-line react-hooks/rules-of-hooks
    const [activeLng, setActiveLng] = useState(i18n.resolvedLanguage)
    // eslint-disable-next-line react-hooks/rules-of-hooks
    useEffect(() => {
      if (activeLng === i18n.resolvedLanguage) return
      setActiveLng(i18n.resolvedLanguage)
    }, [activeLng, i18n.resolvedLanguage])
    // eslint-disable-next-line react-hooks/rules-of-hooks
    useEffect(() => {
      if (!lng || i18n.resolvedLanguage === lng) return
      i18n.changeLanguage(lng)
    }, [lng, i18n])
    // eslint-disable-next-line react-hooks/rules-of-hooks
    useEffect(() => {
      if (cookies.i18next === lng) return
      setCookie(cookieName, lng, { path: '/' })
    }, [lng, cookies.i18next])
  }
  return ret
}

```



```terminal
touch src/app/[lng]/components/Footer/FooterBase.js

```

```src/app/[lng]/components/Footer/FooterBase.js
import Link from 'next/link';
import { Trans } from 'react-i18next/TransWithoutContext';

import { languages } from '@/app/i18n/settings';

export const FooterBase = ({ t, lng }) => {
  return (
    <footer style={{ marginTop: 50 }}>
      <Trans i18nKey="languageSwitcher" t={t}>
        Switch from { lng } to:{' '}
      </Trans>
      {languages
        .filter((l) => lng !== l)
        .map((l, index) => {
          return (
            <span key={l}>
              {index > 0 && ' or '}
              <Link href={`/${l}`}>{l}</Link>
            </span>
          );
        })}
    </footer>
  );
};


```

ç·¨é›† src/app/[lng]/components/Footer/index.js

```src/app/[lng]/components/Footer/index.js
import { useTranslation } from '@/app/i18n'

import { FooterBase } from './FooterBase'

export const Footer = async ({ lng }) => {
  const { t } = await useTranslation(lng, 'footer')
  return <FooterBase t={t} lng={lng} />
}

```


```terminal
touch src/app/[lng]/components/Footer/client.js

```

```src/app/[lng]/components/Footer/client.js
'use client'

import { FooterBase } from './FooterBase'
import { useTranslation } from '../../../i18n/client'

export const Footer = ({ lng }) => {
  const { t } = useTranslation(lng, 'footer')
  return <FooterBase t={t} lng={lng} />
}

```



```terminal
mkdir src/app/[lng]/client-page/
touch src/app/[lng]/client-page/page.js

```

```src/app/[lng]/client-page/page.js
'use client'

import Link from 'next/link'
import { useTranslation } from '@/app/i18n/client'
import { Footer } from '../components/Footer/client'
import { useState } from 'react'

export default function Page({ params: { lng } }) {
  const { t } = useTranslation(lng, 'client-page')
  const [counter, setCounter] = useState(0)
  return (
    <>
      <h1>{t('title')}</h1>
      <p>{t('counter', { count: counter })}</p>
      <div>
        <button onClick={() => setCounter(Math.max(0, counter - 1))}>-</button>
        <button onClick={() => setCounter(Math.min(10, counter + 1))}>+</button>
      </div>
      <Link href={`/${lng}`}>
        <button type="button">
          {t('back-to-home')}
        </button>
      </Link>
      <Footer lng={lng} />
    </>
  )
}

```



### ç¿»è¨³ãƒ•ã‚¡ã‚¤ãƒ«

```terminal
touch src/app/i18n/locales/de/client-page.json
touch src/app/i18n/locales/en/client-page.json
touch src/app/i18n/locales/ja/client-page.json

```

```src/app/i18n/locales/de/client-page.json
{
  "title": "Client Seite",
  "counter_one": "eines ausgewÃ¤hlt",
  "counter_other": "{{count}} ausgewÃ¤hlt",
  "counter_zero": "keines ausgewÃ¤hlt",
  "back-to-home": "ZurÃ¼ck zur Hauptseite"
}

```

```src/app/i18n/locales/en/client-page.json
{
  "title": "Client page",
  "counter_one": "one selected",
  "counter_other": "{{count}} selected",
  "counter_zero": "none selected",
  "back-to-home": "Back to home"
}

```

```src/app/i18n/locales/ja/client-page.json
{
  "title": "ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒšãƒ¼ã‚¸",
  "counter_one": "1ã¤é¸æŠã•ã‚Œã¾ã—ãŸ",
  "counter_other": "{{count}}å€‹é¸æŠã•ã‚Œã¾ã—ãŸ",
  "counter_zero": "é¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“",
  "back-to-home": "ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹"
}

```



ç·¨é›† src/app/[lng]/page.js

```src/app/[lng]/page.js
import Link from 'next/link';

import { useTranslation } from '@/app/i18n'

import { Footer } from './components/Footer'

export default async function Page({ params: { lng } }) {
  const { t } = await useTranslation(lng)
  return (
    <>
      <h1>{t('title')}</h1>
      <Link href={`/${lng}/second-page`}>
        {t('to-second-page')}
      </Link>
      <br />
      <Link href={`/${lng}/client-page`}>
        {t('to-client-page')}
      </Link>
      <Footer lng={lng}/>
    </>
  );
}

```



### å‹•ä½œç¢ºèª

http://localhost:3000/

è‰²ã€…ãƒªãƒ³ã‚¯ã‚’ãŸã©ã£ã¦ã¿ã¦ãã ã•ã„ã€‚
ç¿»è¨³æ©Ÿèƒ½ãŒåŠ¹ã„ã¦ã„ã‚‹ã¯ãšã§ã™ã€‚


å‹•ä½œç¢ºèªãŒå®Œäº†ã—ãŸã‚‰ã€
i18nã®ç¿»è¨³æ©Ÿèƒ½ã®çµ„ã¿è¾¼ã¿ã¯å®Œäº†ã—ã¾ã—ãŸã€‚

ã—ã‹ã—ã€ç¾åœ¨rootã«layout.tsxãŒç„¡ã„ã®ã§
ãƒ“ãƒ«ãƒ‰ã¯é€šã‚Šã¾ã›ã‚“ã€‚

â€»é–‹ç™ºãƒ¢ãƒ¼ãƒ‰ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç«‹ã¡ä¸Šã’ã¦ã„ã‚‹ã¨ã€ãƒ“ãƒ«ãƒ‰è‡ªä½“ãŒé€²è¡Œã—ã¾ã›ã‚“ã€‚


```terminal
pnpm run build

or

turbo type-check build

```

â€»ãƒ“ãƒ«ãƒ‰ã‚’ã™ã‚‹æ™‚ã«ã¯Next.jsã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¢ãƒ—ãƒª(pnpm run dev)ã¯è½ã¨ã—ã¦ãŠã„ã¦ãã ã•ã„ã€‚
ç«‹ã¡ä¸Šã’ãŸã¾ã¾ã ã¨ãƒ“ãƒ«ãƒ‰ãŒé–‹å§‹ã•ã‚Œã¾ã›ã‚“ã€‚



----------------------------------------

i18nã®æœ€åˆã«ç§»å‹•ã•ã›ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…ƒã«æˆ»ã—ã¾ã™ã€‚

src\app\layout.tsx
src\app\page.tsx
ã‚’å…ƒã«æˆ»ã™ã¨ã€ãƒ“ãƒ«ãƒ‰ãŒé€šã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
(ç§»å‹•ã—ãŸ\middleware.jsã¯å¾Œã§)

ã“ã®2ã¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯å…±ã«ä½™åˆ†ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¦ãŠã„ã¦ã‚ã‚Šã¾ã—ãŸã€‚

layout.tsxã§ã¯
<Navbar />ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤–ã—ã¾ã™ã€‚



page.tsxã¯ã€
TOP PAGEã®æ–‡å­—ã—ã‹æ›¸ã‹ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
ä»–ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¦ã‚ã‚Šã¾ã™ã€‚


src\app\[lng]\page.js ã¸
è¨€èªãƒšãƒ¼ã‚¸ã«ãƒªãƒ³ã‚¯ã‚’å¼µã£ã¦ãŠãã¾ã™ã€‚

```src\app\[lng]\page.js
export default function Page() {
  return (
    <div className="">
      TOP PAGE
      {/* <PricingPage /> */}
      <a href="/ja">æ—¥æœ¬èªãƒšãƒ¼ã‚¸</a>
      <br />
      <a href="/en">English Page</a>
    </div>
  );
}

```

ç·¨é›†ãŒå®Œäº†ã—ãŸã‚‰ã€å…ƒã®ç”»é¢ã‚’è¡¨ç¤ºã—ã¦ã¿ã¾ã™ã€‚

http://localhost:3000/



ã—ã‹ã—ã€
http://localhost:3000/ja
ã§ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

src\app\[lng]\layout.jsã®æ©Ÿèƒ½ã‚’
src\app\layout.tsxã¸ç§»ã—ã¾ã™ã€‚

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¨€èªã‚’æ—¥æœ¬èªã«è¨­å®šã—ã¾ã™ã€‚



ç·¨é›† src\app\layout.tsx

```src\app\layout.tsx
import { dir } from 'i18next';
import { Metadata } from 'next';
import { Suspense } from 'react';

import { languages } from '@/app/i18n/settings';
import Navbar from '@/components/ui/Navbar';
import { Toaster } from '@/components/ui/Toasts/toaster';
import { getURL } from '@/utils/helpers';
import '@/styles/main.css';

export async function generateStaticParams() {
  return languages.map(lng => ({ lng }));
}

const meta = {
  title: 'Next.js Subscription Starter',
  description: 'Brought to you by Vercel, Stripe, and Supabase.',
  cardImage: '/og.png',
  robots: 'follow, index',
  favicon: '/favicon.ico',
  url: getURL(),
};

export async function generateMetadata(): Promise<Metadata> {
  return {
    title: meta.title,
    description: meta.description,
    referrer: 'origin-when-cross-origin',
    keywords: ['Vercel', 'Supabase', 'Next.js', 'Stripe', 'Subscription'],
    authors: [{ name: 'Vercel', url: 'https://vercel.com/' }],
    creator: 'Vercel',
    publisher: 'Vercel',
    robots: meta.robots,
    icons: { icon: meta.favicon },
    metadataBase: new URL(meta.url),
    openGraph: {
      url: meta.url,
      title: meta.title,
      description: meta.description,
      images: [meta.cardImage],
      type: 'website',
      siteName: meta.title,
    },
    twitter: {
      card: 'summary_large_image',
      site: '@Vercel',
      creator: '@Vercel',
      title: meta.title,
      description: meta.description,
      images: [meta.cardImage],
    },
  };
}

export default async function RootLayout({ children, params: { lng = 'ja' } }) {
  return (
    <html lang={lng} dir={dir(lng)}>
      <body className="bg-black loading">
        <Navbar />
        <main className="min-h-[calc(100dvh-4rem)] md:min-h[calc(100dvh-5rem)]" id="skip">
          {children}
        </main>
        {/* <Footer /> */}
        <Suspense>
          <Toaster />
        </Suspense>
      </body>
    </html>
  );
}

```

ğŸ‘†ã“ã®ã‚ˆã†ã«ç·¨é›†ã—ãŸã‚‰ã€
src\app\[lng]\layout.js
ã®æ–¹ã¯å‰Šé™¤ã—ã¾ã™ã€‚



### å‹•ä½œç¢ºèª

http://localhost:3000/
ã‚’é–‹ãã¨

http://localhost:3000/ja
ã¨é·ç§»ã—ã¦ãƒ˜ãƒƒãƒ€ãƒ¼ã¨ãƒ¡ã‚¤ãƒ³ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã¯ãšã§ã™ã€‚

ãƒ¡ã‚¤ãƒ³ç”»é¢ã®i18né–¢é€£ã®ãƒªãƒ³ã‚¯ã¯æ­£å¸¸ã§ã™ãŒã€
ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé–¢é€£ã®æ©Ÿèƒ½ã¯ã¾ã æ©Ÿèƒ½ã—ã¦ã„ã¾ã›ã‚“ã€‚



## middleware

ã„ã¾middlewareã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒ
middleware.ts é€€é¿ã•ã›ã¦ã‚ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«
middleware.js æ–°ã—ãä½œã£ãŸãƒ•ã‚¡ã‚¤ãƒ«
ã¨2ã¤ã‚ã‚Šã¾ã™ã€‚

### middleware.js

æ–°ã—ãä½œã£ãŸã»ã†ã®middleware.jsã¯
rootã§ã‚‚è¨­å®šè¨€èªå…ˆã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹ã®ã§ä¿®æ­£ã—ã¾ã™ã€‚

```middleware.js
import acceptLanguage from 'accept-language';
import { NextResponse } from 'next/server';

import { fallbackLng, languages, cookieName } from './app/i18n/settings';

acceptLanguage.languages(languages);

export const config = {
  // matcher: '/:lng*'
  matcher: ['/((?!api|_next/static|_next/image|assets|favicon.ico|sw.js).*)']
};

export function middleware(req) {
  let lng;
  console.log('lng', lng);

  if (req.cookies.has(cookieName))
    lng = acceptLanguage.get(req.cookies.get(cookieName).value);
  if (!lng) lng = acceptLanguage.get(req.headers.get('Accept-Language'));
  if (!lng) lng = fallbackLng;

  // Redirect if lng in path is not supported
  if (
    req.nextUrl.pathname !== '/' && // ãƒ«ãƒ¼ãƒˆãƒ‘ã‚¹ã®å ´åˆã¯ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ãªã„
    !languages.some(loc => req.nextUrl.pathname.startsWith(`/${loc}`)) &&
    !req.nextUrl.pathname.startsWith('/_next')
  ) {
    return NextResponse.redirect(new URL(`/${lng}${req.nextUrl.pathname}`, req.url));
  }

  if (req.headers.has('referer')) {
    const refererUrl = new URL(req.headers.get('referer'));
    const lngInReferer = languages.find((l) =>
      refererUrl.pathname.startsWith(`/${l}`)
    );
    const response = NextResponse.next();
    if (lngInReferer) response.cookies.set(cookieName, lngInReferer);
    return response;
  }

  return NextResponse.next();
}

```



lint ã§è­¦å‘ŠãŒå‡ºã¦ã„ã‚‹ã®ã§ç„¡åŠ¹åŒ–ã—ã¾ã™ã€‚

```src\app\i18n\client.js
       // eslint-disable-next-line react-hooks/exhaustive-deps
    }, [lng, cookies.i18next])

```





### middleware.ts

middlewareã®2ã¤ã®ãƒ•ã‚¡ãƒ«ã®æ©Ÿèƒ½ã‚’çµ„ã¿åˆã‚ã›ã¾ã™ã€‚

â†‘ä¸Šã®middleware.jsã®æ‹¡å¼µå­ã‚’tsã«å¤‰ãˆã¦ã€middleware.tsã®æ©Ÿèƒ½ã‚’çµ„ã¿è¾¼ã¿ã¾ã™ã€‚

å‡ºæ¥ãŸã®ãŒâ†“ã“ã¡ã‚‰ã§ã™ã€‚

```middleware.ts
import acceptLanguage from 'accept-language';
import { NextResponse } from 'next/server';
import { type NextRequest } from 'next/server';

import { updateSession } from '@/utils/supabase/middleware';

import { fallbackLng, languages, cookieName } from './app/i18n/settings';

acceptLanguage.languages(languages);

export const config = {
  // matcher: '/:lng*'
  matcher: ['/((?!api|_next/static|_next/image|assets|favicon.ico|sw.js).*)'],
                '/((?!     _next/static|_next/image|favicon.ico|.*\\.(?:svg|png|jpg|jpeg|gif|webp)$).*)'
};

export async function middleware(req: NextRequest) {
  // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æ›´æ–°
  await updateSession(req);

  // è¨€èªã®å–å¾—
  let lng;
  if (req.cookies?.has(cookieName)) lng = acceptLanguage.get(req.cookies.get(cookieName)?.value);
  if (!lng) lng = acceptLanguage.get(req.headers.get('Accept-Language'));
  if (!lng) lng = fallbackLng;

  // ãƒ‘ã‚¹ã®languagesãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„å ´åˆã¯ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ã¾ã™
  if (
    req.nextUrl.pathname !== '/' && // ãƒ«ãƒ¼ãƒˆãƒ‘ã‚¹ã®å ´åˆã¯ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ãªã„
    !languages.some(loc => req.nextUrl.pathname.startsWith(`/${loc}`)) &&
    !req.nextUrl.pathname.startsWith('/_next')
  ) {
    return NextResponse.redirect(new URL(`/${lng}${req.nextUrl.pathname}`, req.url));
  }

  if (req.headers.has('referer')) {
    const referer = req.headers.get('referer');
    if (referer) {
      const refererUrl = new URL(referer);
      const lngInReferer = languages.find(l => refererUrl.pathname.startsWith(`/${l}`));

      const response = NextResponse.next();
      if (lngInReferer) response.cookies.set(cookieName, lngInReferer);
      return response;
    }
  }

  return NextResponse.next();
}

```




```src\app\page.tsx
export default function Page() {
  return (
    <div className="">
      {/* <PricingPage /> */}
      <br />
      <a href="/ja">æ—¥æœ¬èªãƒšãƒ¼ã‚¸</a>
      <br />
      <a href="/en">English Page</a>
    </div>
  );
}


```

ç§»å‹•ã•ã›ãŸmiddleware.tsãƒ•ã‚¡ã‚¤ãƒ«ã¯å‰Šé™¤ã—ã¦ãã ã•ã„ã€‚

i18n å›½éš›åŒ–ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ã“ã‚Œã§çµ‚äº†ã§ã™ã€‚

ãƒ‰ã‚¤ãƒ„èªå¯¾å¿œã¯ä½™è£•ãŒã‚ã£ãŸã‚‰ã—ã¦ã¿ã¦ãã ã•ã„ã€‚



### å‹•ä½œç¢ºèª

http://localhost:3000/

ãƒªãƒ³ã‚¯ã®å‹•ä½œç¢ºèªã€
i18nå›½éš›åŒ–ãŒå‹•ä½œã—ã¦ãŸã‚‰
ç¢ºèªå®Œäº†ã§ã™ã€‚



## å‚è€ƒ

Next.js 13 App Router ã® å›½éš›åŒ–ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ã‚’è‰²ã€…ã¨èª¿æŸ»ã™ã‚‹ã€‚ #Next.js - Qiita

https://qiita.com/masakinihirota/items/873c2558e6d8864d8148



----------------------------------------
----------------------------------------
----------------------------------------

# ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ã®å†æ§‹ç¯‰

ä»Šã¾ã§ã¯ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã®ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ã‚’ãã®ã¾ã¾ä½¿ã£ã¦ã„ã¾ã—ãŸãŒã€
ä¸€æ—¦ç«‹ã¡æ­¢ã¾ã£ã¦ã€i18nã«å¯¾å¿œã—ãŸãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ã‚’å†æ§‹ç¯‰ã—ã¾ã™ã€‚

åŸºæœ¬çš„ã®ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è€ƒãˆã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ•´ç†ã—ã¦ã„ãã¾ã™ã€‚
ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«é–¢ã—ã¦ã¯ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®é …ã‚’è¦‹ã¦ãã ã•ã„ã€‚



# ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ 

ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã®æ§‹é€ ã‚’å›½éš›åŒ–ã«å¯¾å¿œã•ã›ã¤ã¤
Next.jsã®ãƒ«ãƒ¼ãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½¿ã£ã¦å½¹å‰²ã”ã¨ã«åˆ†ã‘ã¾ã™ã€‚

* ç®¡ç†è€…
* èªè¨¼æ¸ˆã¿
* æœªèªè¨¼

Next.js App Routerã¯appãƒ•ã‚©ãƒ«ãƒ€ä»¥ä¸‹ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãŒ
ãã®ã¾ã¾ã‚µã‚¤ãƒˆã®ãƒ«ãƒ¼ãƒˆã«æ±ºã¾ã‚Šã¾ã™ãŒã€
å¾Œã¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå˜ä½ã§çµ„ã¿è¾¼ã‚ã¾ã™ã®ã§ã‹ãªã‚Šè‡ªç”±ã«é…ç½®ã§ãã¾ã™ã€‚


Routing: Route Groups | Next.js
https://nextjs.org/docs/app/building-your-application/routing/route-groups

Route Groupsã‚’ã¤ã‹ã£ã¦ã€ä»Šã¾ã§ã®æ§‹é€ ã‚’å½¹å‰²åˆ¥ã«åˆ†é¡ã—ã¾ã™ã€‚


```rootä»¥ä¸‹ã®ãƒ•ã‚©ãƒ«ãƒ€
root
â”œâ”€â”€ .husky
â”œâ”€â”€ .next
â”œâ”€â”€ .turbo
â”œâ”€â”€ fixtures
â”œâ”€â”€ node_modules
â”œâ”€â”€ public
â”œâ”€â”€ src
â”‚   â”œâ”€â”€ app ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
â”‚   â”‚   â”œâ”€â”€ [lng] <<å›½éš›åŒ–(åˆ¥ãƒ„ãƒªãƒ¼ã«ä½œæˆ)
â”‚   â”‚   â”œâ”€â”€ account
â”‚   â”‚   â”œâ”€â”€ api
â”‚   â”‚   â”œâ”€â”€ auth
â”‚   â”‚   â”œâ”€â”€ i18n <<ç¿»è¨³ãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”‚   â”‚   â””â”€â”€ locales
â”‚   â”‚   â””â”€â”€ signin
â”‚   â”‚       â””â”€â”€ [id]
â”‚   â”œâ”€â”€ components <<å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€ãƒ‘ãƒ¼ãƒ„
â”‚   â”‚   â”œâ”€â”€ icons
â”‚   â”‚   â”œâ”€â”€ laytou <<å…¨ä½“ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ Footer å…¨ä½“ã®ãƒ•ãƒƒã‚¿ãƒ¼
â”‚   â”‚   â”‚   â”œâ”€â”€ LngFooter è¨€èªåˆ‡æ›¿ãƒ•ãƒƒã‚¿ãƒ¼
â”‚   â”‚   â”‚   â””â”€â”€ Navbar å…¨ä½“ã®ãƒ˜ãƒƒãƒ€ãƒ¼
â”‚   â”‚   â””â”€â”€ ui <<ã‚ªãƒªã‚¸ãƒŠãƒ«ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ styles <<è£…é£¾
â”‚   â”œâ”€â”€ types <<å‹
â”‚   â””â”€â”€ utils <<ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â””â”€â”€ supabase

```

â€»æ·±ã„ã¨ã“ã‚ã«ã‚ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ã¯çœç•¥

laytouã«é–¢ã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’1ã‹æ‰€ã«ã¾ã¨ã‚ã‚‹ã€‚

laytouãƒ•ã‚©ãƒ«ãƒ€ã®ä½œæˆ

```terminal
mkdir src\components\layout\

```

ãƒ•ãƒƒã‚¿ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯
src\components\ui\Footer\
ã‚’
src\components\layout\Footer\
ã«ç§»å‹•ã—ã¾ã™ã€‚


ãƒŠãƒ“ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯
src\components\ui\Navbar\
ã‚’
src\components\layout\Navbar
ã«ç§»å‹•ã—ã¾ã™ã€‚


src\app\[lng]\components\Footer\index.js
ã“ã®è¨€èªåˆ‡æ›¿ã®ãƒ•ãƒƒã‚¿ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’
LngFooter
ã¨åå‰ã‚’å¤‰æ›´ã—ã¾ã™ã€‚

ãã—ã¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç®¡ç†ãƒ•ã‚©ãƒ«ãƒ€ (src\components\) ã®ä¸‹ã«ç§»å‹•ã—ã¾ã™ã€‚

src\components\layout\LngFooter



src\app\[lng]\components
ğŸ‘†å…ƒã®ã“ã®ãƒ•ã‚©ãƒ«ãƒ€ã¯å‰Šé™¤ã—ã¦ãŠãã¾ã™ã€‚



## Route Groupsã§åˆ†å‰²ã™ã‚‹

Next.jsã®Route Groupsæ©Ÿèƒ½ã‚’ä½¿ã„ã¾ã™ã€‚

å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ•ã‚©ãƒ«ãƒ€ã¯(unauth)ãƒ•ã‚©ãƒ«ãƒ€ã«å…¥ã‚Œã¾ã™ã€‚

appä»¥ä¸‹ã¯ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°é–¢é€£
(admin) ç®¡ç†è€…ç”¨ãƒšãƒ¼ã‚¸
(auth) èªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒšãƒ¼ã‚¸
(unauth) åŒ¿åã€ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ç”¨
ã‚’ç”¨æ„ã—ã¾ã™

```[lng]ä»¥ä¸‹ã®ãƒ•ã‚©ãƒ«ãƒ€
.
â””â”€â”€ [lng]
    â”œâ”€â”€ (admin) ç®¡ç†è€…ç”¨ãƒšãƒ¼ã‚¸
    â”œâ”€â”€ (auth) èªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼
    â””â”€â”€ (unauth) åŒ¿åã€æœªèªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼
        â”œâ”€â”€ client-page
        â”œâ”€â”€ second-page
        â””â”€â”€ page

```



```src\app\[lng]\(unauth)\page.js
import Link from 'next/link';

import { useTranslation } from '@/app/i18n';
import { Footer } from '@/components/layout/LngFooter';

export default async function Page({ params: { lng } }) {
  const { t } = await useTranslation(lng);
  return (
    <>
      <h1>{t('title')}</h1>
      <Link href={`/${lng}/second-page`}>{t('to-second-page')}</Link>
      <br />
      <Link href={`/${lng}/client-page`}>{t('to-client-page')}</Link>
      <Footer lng={lng} />
    </>
  );
}

```


```src\app\[lng]\(unauth)\client-page\page.js
'use client';

import Link from 'next/link';
import { useState } from 'react';

import { useTranslation } from '@/app/i18n/client';
import { Footer } from '@/components/layout/LngFooter/client';

export default function Page({ params: { lng } }) {
  const { t } = useTranslation(lng, 'client-page');
  const [counter, setCounter] = useState(0);
  return (
    <>
      <h1>{t('title')}</h1>
      <p>{t('counter', { count: counter })}</p>
      <div>
        <button onClick={() => setCounter(Math.max(0, counter - 1))}>-</button>
        <button onClick={() => setCounter(Math.min(10, counter + 1))}>+</button>
      </div>
      <Link href={`/${lng}`}>
        <button type="button">{t('back-to-home')}</button>
      </Link>
      <Footer lng={lng} />
    </>
  );
}

```



```src\app\[lng]\(unauth)\second-page\page.js
import Link from 'next/link';

import { useTranslation } from '@/app/i18n';

import { Footer } from '@/components/layout/LngFooter';

export default async function Page({ params: { lng } }) {
  const { t } = await useTranslation(lng, 'second-page');
  return (
    <>
      <h1>{t('title')}</h1>
      <Link href={`/${lng}`}>{t('back-to-home')}</Link>
      <Footer lng={lng} />
    </>
  );
}

```



## ã‚°ãƒ«ãƒ¼ãƒ—ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®ãã‚Œãã‚Œã®å½¹å‰²

Next.jsã®Route Groupsã‚’ã¤ã‹ã£ãŸå ´åˆã®ä¸€ä¾‹ã§ã™ã€‚

Routing: Route Groups | Next.js

https://nextjs.org/docs/app/building-your-application/routing/route-groups



### (admin) ç®¡ç†è€…ç”¨ãƒ«ãƒ¼ãƒˆã‚°ãƒ«ãƒ¼ãƒ—

#### å½¹å‰²

	ã‚µã‚¤ãƒˆå…¨ä½“ã‚’ç®¡ç†ã™ã‚‹æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚

* ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç™»éŒ²ã€ç·¨é›†ã€å‰Šé™¤ã€ãƒ–ãƒ­ãƒƒã‚¯ãªã©ã®æ“ä½œ
* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç®¡ç†: è¨˜äº‹ã€æŠ•ç¨¿ã€ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã®ä½œæˆã€ç·¨é›†ã€å‰Šé™¤ãªã©ã®æ“ä½œ
* è¨­å®šç®¡ç†: ã‚µã‚¤ãƒˆã®è¨­å®šå¤‰æ›´ã€æ©Ÿèƒ½ã®æœ‰åŠ¹åŒ–/ç„¡åŠ¹åŒ–ãªã©ã®æ“ä½œ
* ãƒ¬ãƒãƒ¼ãƒˆç®¡ç†: ã‚µã‚¤ãƒˆã®åˆ©ç”¨çŠ¶æ³ã‚„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¡Œå‹•ã«é–¢ã™ã‚‹ãƒ¬ãƒãƒ¼ãƒˆã®é–²è¦§
* å•ã„åˆã‚ã›ç®¡ç†: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®å•ã„åˆã‚ã›ã®é–²è¦§ã¨å¯¾å¿œ



### (auth) èªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ç”¨ãƒ«ãƒ¼ãƒˆã‚°ãƒ«ãƒ¼ãƒ—

#### å½¹å‰²

	ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒåˆ©ç”¨ã§ãã‚‹æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚

* ãƒ«ãƒ¼ãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆç·¨é›†: ãƒ«ãƒ¼ãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã®æ“ä½œ
* ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†: ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã®æ“ä½œ
* ãƒãƒƒãƒãƒ³ã‚°æ©Ÿèƒ½: ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã®æ¤œç´¢ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€å—ä¿¡ã€ãªã©ã®æ“ä½œ
* ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£æ©Ÿèƒ½: ã‚°ãƒ«ãƒ¼ãƒ—ã¸ã®å‚åŠ ã€ã‚¤ãƒ™ãƒ³ãƒˆã¸ã®å‚åŠ ã€ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã®äº¤æµãªã©ã®æ“ä½œ
* å±¥æ­´ç®¡ç†: éå»ã®è¨˜éŒ²ã®é–²è¦§
* ãƒ—ãƒ¬ãƒŸã‚¢ãƒ æ©Ÿèƒ½: æœ‰æ–™ãƒ—ãƒ©ãƒ³ã®åˆ©ç”¨ãªã©ã®æ“ä½œ



### (unauth)

#### å½¹å‰²

	ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒåˆ©ç”¨ã§ãã‚‹æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚

* ã‚µã‚¤ãƒˆãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸: ã‚µã‚¤ãƒˆã®èª¬æ˜ã€æ©Ÿèƒ½ç´¹ä»‹ãªã©ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
* ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²: æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç™»éŒ²
* ãƒ­ã‚°ã‚¤ãƒ³: æ—¢å­˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ­ã‚°ã‚¤ãƒ³
* ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆ: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¿˜ã‚ŒãŸå ´åˆã®å†è¨­å®š
* åˆ©ç”¨è¦ç´„: ã‚µã‚¤ãƒˆåˆ©ç”¨ã«é–¢ã™ã‚‹è¦ç´„ã®é–²è¦§
* ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼: å€‹äººæƒ…å ±ä¿è­·ã«é–¢ã™ã‚‹ãƒãƒªã‚·ãƒ¼ã®é–²è¦§



â€»ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ã£ã¦ã€åœŸå°ä½œæˆå¾Œã¯ã‚¢ãƒ—ãƒªä½œæˆã«é›†ä¸­ã§ãã¾ã™ã€‚

ãã®æ™‚ã€ã“ã®Route groups ã«ãã‚Œãã‚Œã®æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦ã„ãã¾ã™ã€‚
ã©ã®ã‚ˆã†ãªã‚¢ãƒ—ãƒªã‚’ä½œã‚‹ã‹ã¯ã€åˆ¶ä½œè€…æ¬¡ç¬¬ã§ã™ã€‚



## middleware.ts

ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã§ä½œæˆã•ã‚Œã¦ã„ã‚‹èªè¨¼ã¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯
å›½éš›åŒ–ã«å¯¾å¿œã—ã¦ã„ãªã„ã®ã§ i18nã®pathè¨­å®šã‹ã‚‰é™¤å¤–ã—ã¾ã™ã€‚

```src\middleware.ts
import acceptLanguage from 'accept-language';
import { NextResponse } from 'next/server';
import { type NextRequest } from 'next/server';

import { updateSession } from '@/utils/supabase/middleware';

import { fallbackLng, languages, cookieName } from './app/i18n/settings';

acceptLanguage.languages(languages);

export const config = {
  // matcher: '/:lng*'
  matcher: ['/((?!api|_next/static|_next/image|assets|favicon.ico|sw.js).*)']
};

export async function middleware(req: NextRequest) {
  // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æ›´æ–°
  await updateSession(req);

  // è¨€èªã®å–å¾—
  let lng;
  if (req.cookies?.has(cookieName)) lng = acceptLanguage.get(req.cookies.get(cookieName)?.value);
  if (!lng) lng = acceptLanguage.get(req.headers.get('Accept-Language'));
  if (!lng) lng = fallbackLng;

  // ãƒ‘ã‚¹ã®languagesãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„å ´åˆã¯ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ã¾ã™
  // ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼éƒ¨åˆ†ã®èªè¨¼æ©Ÿèƒ½é–¢é€£ã®pathã¯i18nã«å¯¾å¿œã—ã¦ãªã„ã®ã§ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã—ã¦ã„ã‚‹ã€‚
  // èªè¨¼é–¢é€£ã®ãƒ‘ã‚¹ã¯i18næ©Ÿèƒ½ã«å¯¾å¿œã—ã¦ã„ãªã„ã€‚
  if (
    req.nextUrl.pathname !== '/' && // ãƒ«ãƒ¼ãƒˆãƒ‘ã‚¹ã®å ´åˆã¯ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ãªã„
    req.nextUrl.pathname !== '/signin' &&
    req.nextUrl.pathname !== '/signin/password_signin' &&
    req.nextUrl.pathname !== '/auth/callback' &&
    req.nextUrl.pathname !== '/account' &&
    !languages.some(loc => req.nextUrl.pathname.startsWith(`/${loc}`)) &&
    !req.nextUrl.pathname.startsWith('/_next')
  ) {
    return NextResponse.redirect(new URL(`/${lng}${req.nextUrl.pathname}`, req.url));
  }

  if (req.headers.has('referer')) {
    const referer = req.headers.get('referer');
    if (referer) {
      const refererUrl = new URL(referer);
      const lngInReferer = languages.find(l => refererUrl.pathname.startsWith(`/${l}`));

      const response = NextResponse.next();
      if (lngInReferer) response.cookies.set(cookieName, lngInReferer);
      return response;
    }
  }

  return NextResponse.next();
}

```

ãƒ•ã‚©ãƒ«ãƒ€ã‚’ç§»å‹•ã—ãŸã“ã¨ã§pathã®å†è¨­å®šãŒå¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã¾ã™ã€
ãã‚Œãã‚Œä¿®æ­£ã‚’ã—ã¦ãã ã•ã„ã€‚



----------------------------------------
----------------------------------------
----------------------------------------

UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

# shadcn/ui

Next.js - shadcn/ui

https://ui.shadcn.com/docs/installation/next

<details><summary>ã‚³ãƒ©ãƒ  shadcn/ui ã®èª­ã¿æ–¹ã¯ï¼Ÿ</summary>

ä½œè€…æœ¬äººã®ãƒ„ã‚£ãƒ¼ãƒˆ

https://twitter.com/shadcn/status/1647397488742080512

> @shadcn how do i properly pronounce your handle when i'm introducing your projects to others ğŸ˜… been saying "shad-see-enn" but idk if that's correct

@shadcn ä»–ã®äººã«ã‚ãªãŸã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ç´¹ä»‹ã™ã‚‹ã¨ãã€ã‚ãªãŸã®ãƒãƒ³ãƒ‰ãƒ«ãƒãƒ¼ãƒ ã‚’ã©ã†ç™ºéŸ³ã™ã‚Œã°ã„ã„ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ

> shad as in shadow

ã‚·ãƒ£ãƒ‰ã‚¦ã¯shadowã¨ã ã„ãŸã„åŒã˜ã§ã™ã€‚

</details>



## åˆæœŸåŒ–

```terminal
pnpm dlx shadcn-ui@latest init

âˆš Which style would you like to use? Â» [Default]
âˆš Which color would you like to use as base color? Â» [Slate]
âˆš Would you like to use CSS variables for colors? ... [no] / yes

```

â€»åˆæœŸåŒ–ã‚³ãƒãƒ³ãƒ‰ã¯ã™ã§ã«shadcnè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹å ´åˆä¸Šæ›¸ãã•ã‚Œã¾ã™ã€‚



## CLI ã‹ã‚‰ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•

`npx @shadcn-ui add`ã‚³ãƒãƒ³ãƒ‰ã¯ã€æ–°ã—ã„UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«è¿½åŠ ã™ã‚‹ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚ç‰¹å®šã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€ãã®å‹•ä½œã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚


```terminal
pnpm dlx shadcn-ui@latest add

```

â€»package.jsonãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚ã‚‹å ´æ‰€ã§å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚



```terminal
pnpm dlx shadcn-ui@latest add

( )   accordion
( )   alert
( )   alert-dialog
( )   aspect-ratio
( )   avatar
( )   badge
( )   button
( )   calendar
( )   card
( )   checkbox
( )   collapsible
( )   command
( )   context-menu
( )   dialog
( )   dropdown-menu
( )   hover-card
( )   input
( )   label
( )   menubar
( )   navigation-menu
( )   popover
( )   progress
( )   radio-group
( )   scroll-area
( )   select
( )   separator
( )   sheet
( )   skeleton
( )   slider
( )   switch
( )   table
( )   tabs
( )   textarea
( )   toast
( )   toggle
( )   toggle-group
( )   tooltip

```

alert ã‚’é¸æŠã—ã¦ã¿ã¾ã™ã€‚

å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®é€šã‚Šè¿½åŠ ã—ã¦ã¿ã¾ã™ã€‚

Alert - shadcn/ui

https://ui.shadcn.com/docs/components/alert



```src\app\page.tsx
import { Terminal } from 'lucide-react';

import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';

export default function Page() {
  return (
    <div className="">
      {/* <PricingPage /> */}
      <br />
      <a href="/ja">æ—¥æœ¬èªãƒšãƒ¼ã‚¸</a>
      <br />
      <a href="/en">English Page</a>
      <Alert>
        <Terminal className="w-4 h-4" />
        <AlertTitle>Heads up!</AlertTitle>
        <AlertDescription>
          You can add components and dependencies to your app using the cli.
        </AlertDescription>
      </Alert>
    </div>
  );
}

```



----------------------------------------

# ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰

shadcn/uiã®ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚

Next.js - shadcn/ui

https://ui.shadcn.com/docs/dark-mode/next

Next.js App Router é–‹ç™ºç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã« shadcn/ui ã§ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã‚’å®Ÿè£…ã™ã‚‹ã€‚ #DarkMode - Qiita

https://qiita.com/masakinihirota/items/7cf6181ba61fe9dc3802



## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```terminal
pnpm add next-themes

```

## ãƒ†ãƒ¼ãƒãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ä½œæˆ

 `terminal
touch src\components\theme-provider.tsx

```

```src\components\theme-provider.tsx
"use client"

import { ThemeProvider as NextThemesProvider } from "next-themes";
import { type ThemeProviderProps } from "next-themes/dist/types";
import * as React from "react";

export function ThemeProvider({ children, ...props }: ThemeProviderProps) {
  return <NextThemesProvider {...props}>{children}</NextThemesProvider>;
}

```



## ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«ãƒ©ãƒƒãƒ—ã™ã‚‹

ç·¨é›† src\app\layout.tsx

```src\app\layout.tsx
import { dir } from 'i18next';
import { Metadata } from 'next';
import { ThemeProvider } from 'next-themes';
import { Suspense } from 'react';

import { languages } from '@/app/i18n/settings';
import Navbar from '@/components/layout/Navbar';
import { Toaster } from '@/components/ui/Toasts/toaster';
import { getURL } from '@/utils/helpers';

import '@/styles/main.css';

export async function generateStaticParams() {
  return languages.map(lng => ({ lng }));
}

const meta = {
  title: 'Next.js Subscription Starter',
  description: 'Brought to you by Vercel, Stripe, and Supabase.',
  cardImage: '/og.png',
  robots: 'follow, index',
  favicon: '/favicon.ico',
  url: getURL(),
};

export async function generateMetadata(): Promise<Metadata> {
  return {
    title: meta.title,
    description: meta.description,
    referrer: 'origin-when-cross-origin',
    keywords: ['Vercel', 'Supabase', 'Next.js', 'Stripe', 'Subscription'],
    authors: [{ name: 'Vercel', url: 'https://vercel.com/' }],
    creator: 'Vercel',
    publisher: 'Vercel',
    robots: meta.robots,
    icons: { icon: meta.favicon },
    metadataBase: new URL(meta.url),
    openGraph: {
      url: meta.url,
      title: meta.title,
      description: meta.description,
      images: [meta.cardImage],
      type: 'website',
      siteName: meta.title,
    },
    twitter: {
      card: 'summary_large_image',
      site: '@Vercel',
      creator: '@Vercel',
      title: meta.title,
      description: meta.description,
      images: [meta.cardImage],
    },
  };
}

export default async function RootLayout({ children, params: { lng = 'ja' } }) {
  return (
    <html lang={lng} dir={dir(lng)} suppressHydrationWarning>
      <body className="bg-black loading">
        <ThemeProvider attribute="class" defaultTheme="system" enableSystem>
          <Navbar />
          <main className="min-h-[calc(100dvh-4rem)] md:min-h[calc(100dvh-5rem)]" id="skip">
            {children}
          </main>
          {/* <Footer /> */}
          <Suspense>
            <Toaster />
          </Suspense>
        </ThemeProvider>
      </body>
    </html>
  );
}

```

```
    <html lang="ja" suppressHydrationWarning>

```

â€» ğŸ‘†suppressHydrationWarning ã¯ã€React ãŒã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ãƒã‚¤ãƒ‰ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ã“ã¨ã‚’æŠ‘åˆ¶ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚



#### ãƒ†ãƒ¼ãƒã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹

ãƒ¢ãƒ¼ãƒ‰ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

```terminal
pnpm dlx shadcn-ui@latest add

(*) button
(*) dropdown-menu

```

ğŸ‘† buttonã¨dropdown-menuã‚’é¸æŠã—ã¾ã™ã€‚



buttonã¯ãã®ã¾ã¾ã ã¨
src\components\ui\button.tsx
src\components\ui\Button\index.ts
ã¨ã“ã®ã‚ˆã†ã«è¢«ã‚‹ã®ã§åˆ¥ã®å ´æ‰€ã«ç§»å‹•ã•ã›ã¾ã™ã€‚

é©å½“ãªå ´æ‰€
src\components\button.tsx

ãã‚‚ãã‚‚ã‚³ãƒãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨ã‹ã¶ã‚‹ã®ã§
Button - shadcn/ui
https://ui.shadcn.com/docs/components/button
ğŸ‘†shadcnã®HPã‹ã‚‰ã‚³ãƒ”ãƒ¼ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªç”±ãªå ´æ‰€ã«ãŠã„ã¦ã‚‚OKã§ã™ã€‚



i18nç”¨ã®ãƒˆã‚°ãƒ«ãƒšãƒ¼ã‚¸ã‚’ä½œã‚Šã¾ã™ã€‚
ã“ã‚Œã¯ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆå°‚ç”¨ãƒšãƒ¼ã‚¸ã§
åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã ã‘ã®ãƒšãƒ¼ã‚¸ã§ã™ã€‚

src\app\[lng]\ModeTogglePage\page.tsx ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚Šã¾ã™ã€‚

```terminal
mkdir src\app\[lng]\ModeTogglePage\
touch src\app\[lng]\ModeTogglePage\page.tsx

```


```src\app\ModeTogglePage\page.tsx
'use client';

import { Moon, Sun } from 'lucide-react';
import { useTheme } from 'next-themes';
import * as React from 'react';

import { Button } from '@/components/button';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu';

export default function ModeToggle() {
  const { setTheme } = useTheme();

  return (
    <DropdownMenu>
      <DropdownMenuTrigger asChild>
        <Button variant="outline" size="default">
          <Sun className="h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0" />
          <Moon className="absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100" />
          <span className="sr-only">Toggle theme</span>
        </Button>
      </DropdownMenuTrigger>
      <DropdownMenuContent align="end">
        <DropdownMenuItem onClick={() => setTheme('light')}>Light</DropdownMenuItem>
        <DropdownMenuItem onClick={() => setTheme('dark')}>Dark</DropdownMenuItem>
        <DropdownMenuItem onClick={() => setTheme('system')}>System</DropdownMenuItem>
      </DropdownMenuContent>
    </DropdownMenu>
  );
}

```

â†“ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯ã‚’å¼µã‚Šã¾ã™ã€‚

ç·¨é›† src\app\page.tsx

```src\app\page.tsx
import { Terminal } from 'lucide-react';
import Link from 'next/link';

import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';

export default function Page() {
  return (
    <div className="">
      {/* <PricingPage /> */}
      <br />
      <a href="/ja">æ—¥æœ¬èªãƒšãƒ¼ã‚¸</a>
      <br />
      <a href="/en">English Page</a>
      <Alert>
        <Terminal className="w-4 h-4" />
        <AlertTitle>Heads up!</AlertTitle>
        <AlertDescription>
          You can add components and dependencies to your app using the cli.
        </AlertDescription>
      </Alert>
      <Link href="./ModeTogglePage">ButtonTestPage</Link>
    </div>
  );
}

```

â€»ã“ã‚Œã§å®Œæˆã—ã¦ã„ã‚‹ã¯ãšã§ã™ãŒã€ãƒœã‚¿ãƒ³ã®è‰²ã ã‘ãƒˆã‚°ãƒ«ã—ã¦ã„ã¾ã™ã€‚
æœ€åˆã®ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã§è‰²ãŒã„ã‚ã‚“ãªç®‡æ‰€ã§ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€
ãã‚Œã‚‰ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã€ã¾ãŸã¯å‰Šé™¤ã—ã¾ã™ã€‚



## ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã®ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹ã‚«ãƒ©ãƒ¼è¨­å®šã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ

```src\styles\main.css
html,
body {
  font-family: -apple-system, system-ui, BlinkMacSystemFont, 'Helvetica Neue',
    'Helvetica', sans-serif;
  text-rendering: optimizeLegibility;
  -moz-osx-font-smoothing: grayscale;
  /* @apply text-white bg-zinc-800 antialiased; */
  @apply antialiased;
}

```

ğŸ‘†ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ


ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚Œã¦ã„ãŸå…¨ä½“ã®è¨­å®šè‰²ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¦
è¨­å®šå ´æ‰€ã‚’ç†è§£ã—ãŸã‚‰è‰²ã®è¨­å®šéƒ¨åˆ†ã¯å‰Šé™¤ã—ã¾ã™ã€‚

â€»Headeréƒ¨åˆ†ã‚‚ä¿®æ­£ã—ãŸã„äººã¯èª¿ã¹ã¦ã¿ã¦ãã ã•ã„ã€‚

ä¾‹

```src\app\layout.tsx
  return (
    <html lang={lng} dir={dir(lng)} suppressHydrationWarning>
      {/* <body className="bg-black loading"> */}
      <body className="loading">

```

ğŸ‘†ä¾‹ãˆã°ã“ã®ã‚ˆã†ã«bg-blackã¨è‰²ãŒç›´æ¥æŒ‡å®šã•ã‚Œã¦ã„ã‚‹æ‰€ã‚’å‰Šé™¤ã—ã¾ã™ã€‚

å‰Šé™¤ã™ã‚‹ãƒ¯ãƒ¼ãƒ‰
bg-black
text-white
bg-zinc-***

ä¸»ã«å½±éŸ¿ã‚’ä¸ãˆã¦ã„ã‚‹ç®‡æ‰€ã‚’ä¿®æ­£

```src\app\layout.tsx
-      <body className="bg-black loading">
+      <body className=" loading">

```

```src\components\layout\Navbar\Navbar.module.css
.root {
-  @apply sticky top-0 bg-black z-40 transition-all duration-150 h-16 md:h-20;
+  @apply sticky top-0 z-40 transition-all duration-150 h-16 md:h-20;

.link {
-  @apply inline-flex items-center leading-6 font-medium transition ease-in-out duration-75 cursor-pointer text-zinc-200 rounded-md p-1;
+  @apply inline-flex items-center leading-6 font-medium transition ease-in-out duration-75 cursor-pointer rounded-md p-1;


-.link:hover {
-  @apply text-zinc-100;
-}

+/* .link:hover {
+  @apply text-zinc-100;
+} */

```

ğŸ‘†ãƒŠãƒ“ãƒãƒ¼ã®ãƒªãƒ³ã‚¯ã®è‰²ã¨ãƒ›ãƒãƒ¼ã—ãŸæ™‚ã®ãƒªãƒ³ã‚¯ã®è‰²

```src\styles\main.css
-  @apply text-white bg-zinc-800 antialiased;
+  @apply antialiased;

```



## Footerã‚‚ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ã«å¯¾å¿œ

src\app\layout.tsx ã«ã‚ã‚‹Footer ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’è§£é™¤ã—ã¾ã™ã€‚

Next.jsã‚¢ãƒ—ãƒªã«FooterãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

å¿…è¦ãªéƒ¨åˆ†ã ã‘æ®‹ã—ã¦ã€å¾Œã¯å‰Šé™¤ã—ã¾ã™ã€‚
å¤–éƒ¨ãƒªãƒ³ã‚¯ã‚’å‰Šé™¤ã—ã€æœ€ä½é™è¦‹ãˆã‚‹æ‰€ã¾ã§ä¿®æ­£ã—ã¦ã„ã¾ã™ã€‚

```src\components\layout\Footer\Footer.tsx
import Link from 'next/link';

export default function Footer() {
  return (
    <footer className="mx-auto max-w-[1920px] px-6 ">
      <div className="grid grid-cols-1 gap-8 py-12 transition-colors duration-150 border-b lg:grid-cols-12 border-zinc-600 ">
        <div className="col-span-1 lg:col-span-2">
          <Link
            href="/"
            className="flex items-center flex-initial font-bold md:mr-24"
          >
            <span className="mr-2 border rounded-full border-zinc-700">
            </span>
            <span>VNS.BLUE</span>
          </Link>
        </div>
        <div className="col-span-1 lg:col-span-2">
          <ul className="flex flex-col flex-initial md:flex-1">
            <li className="py-3 md:py-0 md:pb-4">
              <Link
                href="/"
                className="transition duration-150 ease-in-out hover:text-zinc-200"
              >
                Home
              </Link>
            </li>
            <li className="py-3 md:py-0 md:pb-4">
              <Link
                href="/"
                className="transition duration-150 ease-in-out hover:text-zinc-200"
              >
                About
              </Link>
            </li>
            <li className="py-3 md:py-0 md:pb-4">
              <Link
                href="/"
                className="transition duration-150 ease-in-out hover:text-zinc-200"
              >
                Careers
              </Link>
            </li>
            <li className="py-3 md:py-0 md:pb-4">
              <Link
                href="/"
                className="transition duration-150 ease-in-out hover:text-zinc-200"
              >
                Blog
              </Link>
            </li>
          </ul>
        </div>
        <div className="col-span-1 lg:col-span-2">
          <ul className="flex flex-col flex-initial md:flex-1">
            <li className="py-3 md:py-0 md:pb-4">
              <p className="font-bold transition duration-150 ease-in-out hover:text-zinc-200">
                LEGAL
              </p>
            </li>
            <li className="py-3 md:py-0 md:pb-4">
              <Link
                href="/"
                className="transition duration-150 ease-in-out hover:text-zinc-200"
              >
                Privacy Policy
              </Link>
            </li>
            <li className="py-3 md:py-0 md:pb-4">
              <Link
                href="/"
                className="transition duration-150 ease-in-out hover:text-zinc-200"
              >
                Terms of Use
              </Link>
            </li>
          </ul>
        </div>
      </div>
    </footer>
  );
}

```

â€»ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚Œã¦ã„ãŸè‰²ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚



----------------------------------------

## Accountã‚‚ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ã«å¯¾å¿œ

```src\app\account\page.tsx
import { redirect } from 'next/navigation';

import CustomerPortalForm from '@/components/ui/AccountForms/CustomerPortalForm';
import EmailForm from '@/components/ui/AccountForms/EmailForm';
import NameForm from '@/components/ui/AccountForms/NameForm';
import { createClient } from '@/utils/supabase/server';

export default async function Account() {
  const supabase = createClient();

  const {
    data: { user }
  } = await supabase.auth.getUser();

  const { data: userDetails } = await supabase
    .from('users')
    .select('*')
    .single();

  const { data: subscription, error } = await supabase
    .from('subscriptions')
    .select('*, prices(*, products(*))')
    .in('status', ['trialing', 'active'])
    .maybeSingle();

  if (error) {
    console.log(error);
  }

  if (!user) {
    return redirect('/signin');
  }

  return (
    <section className="mb-32 ">
      <div className="max-w-6xl px-4 py-8 mx-auto sm:px-6 sm:pt-24 lg:px-8">
        <div className="sm:align-center sm:flex sm:flex-col">
          <h1 className="text-4xl font-extrabold sm:text-center sm:text-6xl">
            Account
          </h1>
          <p className="max-w-2xl m-auto mt-5 text-xl sm:text-center sm:text-2xl">
            We partnered with Stripe for a simplified billing.
          </p>
        </div>
      </div>
      <div className="p-4">
        <CustomerPortalForm subscription={subscription} />
        <NameForm userName={userDetails?.full_name ?? ''} />
        <EmailForm userEmail={user.email} />
      </div>
    </section>
  );
}

```

â€»ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚Œã¦ã„ãŸè‰²ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚

----------------------------------------

ğŸ‘†ã“ã‚Œã§æœ€ä½é™ã®ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆãŒå®Œäº†ã—ã¾ã—ãŸã€‚

å‹•ä½œç¢ºèªã—ã¾ã™ã€‚

```terminal
pnpm run dev

```

ğŸ‘‡ãã®ä»–ã®ç®‡æ‰€ã¯å„è‡ªãŒè‡ªåˆ†ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã«åˆã†ã‚ˆã†ã«ç·¨é›†ã—ã¦ãã ã•ã„ã€‚

<details><summary>ãã®ä»–ã®ç®‡æ‰€ (ä¸€éƒ¨)</summary>
src\app\account\page.tsx

src\components\ui\AccountForms\EmailForm.tsx
src\components\ui\AccountForms\NameForm.tsx
src\components\ui\AuthForms\EmailSignIn.tsx
src\components\ui\AuthForms\ForgotPassword.tsx
src\components\ui\AuthForms\PasswordSignIn.tsx
src\components\ui\AuthForms\Signup.tsx
src\components\ui\AuthForms\UpdatePassword.tsx
src\components\ui\Button\Button.module.css
src\components\ui\Button\Button.module.css
src\components\ui\Card\Card.tsx
src\components\ui\Input\Input.module.css
src\components\ui\LoadingDots\LoadingDots.module.css
src\components\ui\LogoCloud\LogoCloud.tsx
src\components\ui\Pricing\Pricing.tsx
src\components\ui\Pricing\Pricing.tsx
src\components\ui\Toasts\toast.tsx

â€»ä»–ã«ã‚‚å½±éŸ¿ã‚’ä¸ãˆã‚‹ç®‡æ‰€ãŒã‚ã‚‹å ´åˆã¯ãã‚Œãã‚Œå¯¾å‡¦ã—ã¦ãã ã•ã„ã€‚

</details>



## å‹•ä½œç¢ºèª

npm run dev

ã§ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã—ã¦å‹•ä½œç¢ºèªã‚’ã—ã¾ã™ã€‚

ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®åˆ‡ã‚Šæ›¿ãˆãŒç¢ºèªã§ãã‚Œã°ä½œæ¥­ã¯å®Œäº†ã§ã™ã€‚



## å‚è€ƒ

Next.js App Router é–‹ç™ºç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã« shadcn/ui ã§ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã‚’å®Ÿè£…ã™ã‚‹ã€‚ #DarkMode - Qiita

https://qiita.com/masakinihirota/items/7cf6181ba61fe9dc3802



----------------------------------------

## ã‚¢ãƒ—ãƒªã®Logoéƒ¨åˆ†ã‚’è‡ªåˆ†ã®ã‚µã‚¤ãƒˆåã«ã™ã‚‹

```src\components\layout\Navbar\Navlinks.tsx
        <Link aria-label="Logo" className={s.logo} href="/">
          VNS.BLUE
        </Link>

```

â†‘ãƒ­ã‚´éƒ¨åˆ†ã‚’è‡ªåˆ†ã®ã‚µã‚¤ãƒˆåã«å¤‰æ›´ã—ã¾ã™ã€‚



## ãƒ˜ãƒƒãƒ€ãƒ¼ã«ã‚¢ãƒ—ãƒªã®ä½œã‚‹æ©Ÿèƒ½ã®ãƒœã‚¿ãƒ³ã‚’ä¸¦ã¹ã‚‹

ãƒ˜ãƒƒãƒ€ãƒ¼ã«
ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰
è¨€èª
åºƒå‘Š
Pricing
Account
ãƒœã‚¿ãƒ³ã®(ä»®)ä½œæˆ



## ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ã‚’ãƒ˜ãƒƒãƒ€ãƒ¼ã«ç§»å‹•

bodyéƒ¨åˆ†ã«ä½œã£ãŸãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ã‚’Navlinksã«ç§»å‹•ã•ã›ã¾ã™ã€‚

src\app\[lng]\ModeTogglePage\page.tsx
<ModeToggle />
ğŸ‘†ã“ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’åˆ©ç”¨ã—ã¾ã™ã€‚



```src\components\layout\Navbar\Navlinks.tsx
'use client';

import Link from 'next/link';
import { usePathname, useRouter } from 'next/navigation';

import ModeToggle from '@/app/[lng]/ModeTogglePage/page';
import { handleRequest } from '@/utils/auth-helpers/client';
import { SignOut } from '@/utils/auth-helpers/server';
import { getRedirectMethod } from '@/utils/auth-helpers/settings';

import s from './Navbar.module.css';

interface NavlinksProps {
  user?: any;
}

export default function Navlinks({ user }: NavlinksProps) {
  // eslint-disable-next-line
  const router = getRedirectMethod() === 'client' ? useRouter() : null;

  return (
    <div className="relative flex flex-row justify-between py-4 align-center md:py-6">
      <div className="flex items-center flex-1">
        <Link href="/" className={s.logo} aria-label="Logo">
          VNS.BLUE
        </Link>
        <nav className="ml-6 space-x-2 lg:block">
          <ModeToggle />
          <Link className={s.link} href="/">
            è¨€èª
          </Link>
          <Link className={s.link} href="/">
            åºƒå‘Š
          </Link>
        </nav>
        <nav className="ml-6 space-x-2 lg:block">
          <Link href="/" className={s.link}>
            Pricing
          </Link>
          {user && (
            <Link href="/account" className={s.link}>
              Account
            </Link>
          )}
        </nav>
      </div>
      <div className="flex justify-end space-x-8">
        {user ? (
          <form onSubmit={(e) => handleRequest(e, SignOut, router)}>
            {/* eslint-disable-next-line react-hooks/rules-of-hooks */}
            <input type="hidden" name="pathName" value={usePathname()} />
            <button type="submit" className={s.link}>
              Sign out
            </button>
          </form>
        ) : (
          <Link href="/signin" className={s.link}>
            Sign In
          </Link>
        )}
      </div>
    </div>
  );
}

```

<body>éƒ¨åˆ†ã«ã‚ã‚‹ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ã¯å‰Šé™¤ã—ã¦ã‚‚å¤§ä¸ˆå¤«ã§ã™ã€‚



```src\app\page.tsx
<Link href="./ModeTogglePage">ButtonTestPage</Link>

```



----------------------------------------

## å‹•ä½œç¢ºèª

```terminal
npm run dev

```

ã§ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã—ã¦å‹•ä½œç¢ºèªã‚’ã—ã¾ã™ã€‚

Navbarã§ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®åˆ‡ã‚Šæ›¿ãˆãŒç¢ºèªã§ãã‚Œã°ä½œæ¥­ã¯å®Œäº†ã§ã™ã€‚



----------------------------------------
----------------------------------------
----------------------------------------

ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ç®¡ç†ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

# Storybook

Get started with Storybook â€¢ Storybook docs

https://storybook.js.org/docs/get-started

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```terminal
pnpm dlx storybook@latest init

```

â€»åˆå›ã¯è‡ªå‹•ã§StorybookãŒç«‹ã¡ä¸ŠãŒã‚Šã€Storybookãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ãŒå§‹ã¾ã‚Šã¾ã™ã€‚
ã“ã®Storybookã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã¯ã‹ãªã‚Šå‡ºæ¥ãŒè‰¯ã„ã®ã§ã€ä¸€åº¦ã‚„ã£ã¦ã¿ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚

## å®Ÿè¡Œæ–¹æ³•

```terminal
pnpm run storybook

```

http://localhost:6006/



## Storybookã§ã®TailwindCSSã®è¨­å®š

Storybook ã§ã‚‚ TailwindCSS ãŒä½¿ãˆã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

TailwindCSSã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’
`.storybook\preview.ts`
ğŸ‘†ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§èª­ã¿è¾¼ã¾ã›ã¾ã™ã€‚

â€»ã“ã®ã‚¢ãƒ—ãƒªã§ã¯ã€TailwindCSSã®è¨­å®šã¯
`src/styles/main.css`
ã«æ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚



`import "../src/styles/globals.css"`
ã‚’ â†“ ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ ã—ã¾ã™ã€‚

```.storybook\preview.ts
import type { Preview } from '@storybook/react';

import '../src/styles/main.css';

const preview: Preview = {
  parameters: {
    controls: {
      matchers: {
        color: /(background|color)$/i,
        date: /Date$/i
      }
    }
  }
};

export default preview;

```


## TailwindCSSã‚’è©¦ã™

TailwindCSSãŒåŠ¹ã„ã¦ã„ã‚‹ã‹ã©ã†ã‹ã®ãŠè©¦ã—ã® Buttonã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã€‚

```src\app\button\Button.tsx
interface ButtonProps {
  label: string;
  onClick?: () => void;
}

export const Button = ({
  label,
}: ButtonProps) => {
  return (
    <button
      type="button"
      className="flex items-center justify-center px-4 py-2 text-white bg-indigo-600 border border-transparent rounded-md shadow-sm hover:text-red-400 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
    >
      {label}
    </button>
  );
};

```

```src\app\button\Button.stories.tsx
import type { Meta, StoryObj } from '@storybook/react';
import { Button } from './Button';

const meta = {
  title: 'TailwindCSS/Button',
  component: Button,
  parameters: {
    layout: 'centered',
  },
  tags: ['autodocs'],
} satisfies Meta<typeof Button>;

export default meta;
type Story = StoryObj<typeof meta>;

export const Primary: Story = {
  args: {
    label: 'Button TailwindCSS',
  },
};

```

```src\app\page.tsx
import { Button } from './button/Button';

ãƒ»ãƒ»ãƒ»

<Button label="Storybook Test Button" />

ãƒ»ãƒ»ãƒ»

```
ğŸ‘† é©å½“ãªå ´æ‰€ã«Buttonã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æŒ¿å…¥ã—ã¦ã„ã¾ã™ã€‚

å‹•ä½œç¢ºèª

```terminal
pnpm run dev

pnpm run storybook

```

ğŸ‘†ãã‚Œãã‚Œåˆ¥ã®Terminalã§å®Ÿè¡Œã—ã¾ã™ã€‚

Storybook
http://localhost:6006/

TailwindCSSã®æ–‡å­—è‰²ãªã©ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å€¤ãŒåæ˜ ã•ã‚Œã¦ã„ã‚Œã°æˆåŠŸã§ã™ã€‚



## å‚è€ƒ

Storybookè¶…å…¥é–€ï¼ˆï¼‹Next.jsï¼‹TypeScriptï¼‰ #React - Qiita

https://qiita.com/masakinihirota/items/ac552b8b492d2b962818



----------------------------------------
----------------------------------------
----------------------------------------

# Supabase

â€»é–‹ç™ºã§åˆ©ç”¨ã™ã‚‹Supabaseã¯Webä¸Šã®ã‚µãƒ¼ãƒãƒ¼ã¨ã€
Docker Desktopã§ç«‹ã¡ä¸Šã’ãŸã®ã¨2ç¨®é¡ã‚ã‚Šã¾ã™ã€‚
ã“ã‚Œã‚‰ã‚’ä¾¿å®œä¸Šã‚µãƒ¼ãƒãƒ¼ã€ãƒ­ãƒ¼ã‚«ãƒ«ã¨å‘¼ã³ã¾ã™ã€‚

Docker Desktopã‚’åˆ©ç”¨ã—ã¦
ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã«Supabaseã‚’å°å…¥ã—ã¾ã™ã€‚

Supabaseã®è©±ã‚’ã™ã‚‹ã¨é•·ããªã‚‹ã®ã§ã€å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ä¸‹è¨˜ã®è¨˜äº‹ã‚’ã”è¦§ãã ã•ã„ã€‚

## Supabaseã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨è¨˜äº‹

Local Dev with CLI | Supabase Docs

https://supabase.com/docs/guides/cli

Supabase ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒ ï¼‹ ã‚µãƒ¼ãƒãƒ¼é‹ç”¨ 2023å¹´9æœˆ (with Next.js 13 App router) #Docker - Qiita

https://qiita.com/masakinihirota/items/be94b4c74a7850a4b79c

Supabase ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒ ï¼‹ ãƒªãƒ¢ãƒ¼ãƒˆã‚µãƒ¼ãƒãƒ¼ #PostgreSQL - Qiita

https://qiita.com/masakinihirota/items/f12d16c31e6775f26b84

Next.js 13 App router ã¨ Supabase ã§ã®ï¼”ã¤ã®ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³• #Next.js - Qiita

https://qiita.com/masakinihirota/items/b4b168a056dc10776d87

Supabase Auth ã‚¹ã‚­ãƒ¼ãƒ ã¨ ãã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®è©³ç´° #PostgreSQL - Qiita

https://qiita.com/masakinihirota/items/7f65f732ecbafbd5cb00

etc.



## ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®Supabaseã®å°å…¥

Docker Desktopã‚’åˆ©ç”¨ã—ã¦
ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã«Supabaseã‚’å°å…¥ã—ã¾ã™ã€‚

é–‹ç™ºã¯ã€
ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§Postgresã®DBã‚’è§¦ã£ã¦é–‹ç™ºã—ã¾ã™ã€‚
ãã—ã¦ãã‚Œã‚’ã‚µãƒ¼ãƒãƒ¼ã®DBã«åæ˜ ã•ã›ã‚‹æ–¹æ³•ã§è¡Œã£ã¦ã„ãã¾ã™ã€‚



### Supabase CLIã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ

```terminal
scoop update supabase

```

## Supabaseã«ãƒ­ã‚°ã‚¤ãƒ³

```terminal
supabase login

```

è‡ªå‹•ã§ãƒ–ãƒ©ã‚¦ã‚¶ãŒé–‹ãã¾ã™ã€‚
ãƒ­ã‚°ã‚¤ãƒ³ã§ããŸã‚‰é–‰ã˜ã¾ã™ã€‚



# Supabaseã®ã‚µãƒ¼ãƒãƒ¼ã¨ãƒ­ãƒ¼ã‚«ãƒ«ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒªãƒ³ã‚¯

```terminal
supabase link --project-ref [project-id]

```

â€»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚



```terminal
supabase projects list

```

ã‚µãƒ¼ãƒãƒ¼ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§ãŒè¦‹ã‚ŒãŸã‚‰ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸã§ã™ã€‚

â€»projects listè¡¨ç¤ºã§ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒè¤‡æ•°ã‚ã‚‹ã¨ã€LINKEDã«â—ã®ãƒã‚§ãƒƒã‚¯ãŒå…¥ã£ã¦ã„ã¾ã™ã€‚


ã‚µãƒ¼ãƒãƒ¼ã¨ãƒ­ãƒ¼ã‚«ãƒ«ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ³

```terminal
supabase migration list

```

â€»ã“ã‚Œã¯ã‚ãã¾ã§ã‚‚ãƒ­ãƒ¼ã‚«ãƒ«ã‹ã‚‰è¦‹ãŸçŠ¶æ³ã§ã™ã€‚
ã‚µãƒ¼ãƒãƒ¼ã®æœ€æ–°ã®æƒ…å ±ã§ãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚



# å‹ã®å–å¾— DB(ãƒ­ãƒ¼ã‚«ãƒ«)

```terminal
supabase gen types typescript --local > src/types/types_db.ts

```


# å‹ã®å–å¾— DB(ã‚µãƒ¼ãƒãƒ¼)

```terminal
supabase gen types typescript --project-id ***** > src/types/types_db.ts

```



# Supabaseã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®åŸºç¤

ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«æ–°è¦ä½œæˆã™ã‚‹å ´åˆ

```terminal
supabase migration new new_employee

```

supabase/migrations/<timestamp>_new_employee.sql
â†‘ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã‚‹ã®ã§ SQLæ–‡ã‚’è¨˜å…¥ã—ã¾ã™ã€‚

ä¾‹

```<timestamp>_new_employee.sql
create table public.employees (
  id integer primary key generated always as identity,
  name text
);

```

â†“ç·¨é›†ã—ãŸãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åæ˜ ã•ã›ã¾ã™ã€‚

```terminal
supabase db reset

```

â€»ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯supabase/migrations ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚ã‚‹
ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã™ã¹ã¦åæ˜ ã•ã›ã¾ã™ã€‚

ã“ã‚Œã§æœ€æ–°ã®çŠ¶æ…‹ã«ãªã‚Šã¾ã™ã€‚

Tips
ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚‹æ™‚
ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚ã¾ã™ã€‚

```terminal
supabase migration new new_employee < create_employees_table.sql

```


Supabaseã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
ã‚µãƒ¼ãƒãƒ¼å´ã®é©ç”¨æ–¹æ³•

â†“REMOTEï¼ˆã‚µãƒ¼ãƒãƒ¼ï¼‰å´ã¸ã®é©ç”¨æ–¹æ³•

```terminal
supabase migration repair 20230618024722 --status applied
supabase migration repair 20231017082823 --status applied

```


Supabaseã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
ãƒ­ãƒ¼ã‚«ãƒ«å´ã®å‰Šé™¤æ–¹æ³•
ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¶ˆã™ã ã‘

â†“REMOTEï¼ˆã‚µãƒ¼ãƒãƒ¼ï¼‰å´ã®å‰Šé™¤æ–¹æ³•

```terminal
supabase migration repair 20231017052010 --status reverted
supabase migration repair 20231017082823 --status reverted

```


Supabase ã‚µãƒ¼ãƒãƒ¼ã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰ã®å¤‰æ›´ãŒã‚ã‚‹å ´åˆã«å–ã‚Šå…¥ã‚Œã¾ã™ã€‚

```terminal
supabase db pull

```

Supabase ã‚µãƒ¼ãƒãƒ¼ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ç¾åœ¨ã®ã‚¹ã‚­ãƒ¼ãƒã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ï¼ˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼‰ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚¹ã‚­ãƒ¼ãƒã‚’ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

`supabase/migrations/<timestamp>_remote_schema.sql`
ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã¾ã™ã€‚


```terminal
supabase db push

```

ãƒ—ãƒƒã‚·ãƒ¥ã—ãŸã‚‰ã€ãƒ­ãƒ¼ã‚«ãƒ«ã¨ãƒªãƒ¢ãƒ¼ãƒˆã®ä¸¡æ–¹ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§ç§»è¡Œãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒæœ€æ–°ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

```terminal
#ã‚¹ã‚­ãƒ¼ãƒã®ã¿
supabase db dump -f supabase/schema.sql

#ãƒ‡ãƒ¼ã‚¿ã®ã¿
supabase db dump -f supabase/seed.sql --data-only

```

ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç®¡ç†ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚


----------------------------------------
----------------------------------------
----------------------------------------

# ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®èªè¨¼çŠ¶æ…‹ã‚’åˆ¤æ–­ã™ã‚‹

â€»èªè¨¼ã¯ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã«é ¼ã£ã¦ã„ã‚‹ã®ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒèªè¨¼ã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã®æœ‰ç„¡ã ã‘ã¯è‡ªåˆ†ã§ãƒã‚§ãƒƒã‚¯ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

Next.jsã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¢ãƒ—ãƒªï¼ˆ`pnpm run dev`ï¼‰ã‚’èµ·å‹•ã•ã›ã¦ã€
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®èªè¨¼çŠ¶æ…‹ã‚’ç¢ºèªã—ã¾ã™ã€‚

```src\app\page.tsx
ãƒ»ãƒ»ãƒ»
      {/* userTestãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯ */}
      {/* ãƒ†ã‚¹ãƒˆãªã®ã§ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®ãƒªãƒ³ã‚¯ */}
      <Link href="/ja/userTest">userTest</Link>
ãƒ»ãƒ»ãƒ»

```

```src\app\[lng]\userTest\page.tsx
import { createClient } from '@/utils/supabase/server';

export default async function Page() {
  const supabase = createClient();
  const {
    data: { user }
  } = await supabase.auth.getUser();

  console.log('user: ', user);

  return (
      <div className="">
        {user ? (
          <div>
            ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ä¸­
          </div>
        ) : (
          <div>
            æœªãƒ­ã‚°ã‚¤ãƒ³
          </div>
        )}
      </div>
  );
}

```



## è§£èª¬
1. `import { createClient } from '@/utils/supabase/server';`
   - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆé–¢æ•°ã‚’importã—ã¾ã™ã€‚

2. `const supabase = createClient();`
   - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚

3. `const { data: { user } } = await supabase.auth.getUser();`
   - ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‹ã‚‰ç¾åœ¨ã®èªè¨¼çŠ¶æ…‹ï¼ˆãƒ­ã‚°ã‚¤ãƒ³ä¸­ã¾ãŸã¯ãƒ­ã‚°ã‚¢ã‚¦ãƒˆä¸­ï¼‰ã‚’ç¢ºèªã—ã¾ã™ã€‚
èªè¨¼ã•ã‚Œã¦ã„ã‚‹å ´åˆã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ãŒå–å¾—ã•ã‚Œã¾ã™ã€‚ã“ã®æƒ…å ±ã«ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ­ãƒ¼ãƒ«ã‚„ãã®ä»–ã®å±æ€§ã‚‚å«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

4. `console.log('useræƒ…å ±: ', user);`
   - ç¢ºèªã®ãŸã‚userãƒ‡ãƒ¼ã‚¿ã®ä¸­èº«ã‚’è¦‹ã¾ã™ã€‚

5. `user ?`
   - æ¡ä»¶æ–‡ã‚’ä½¿ç”¨ã—ã¦ã€è¡¨ç¤ºã™ã‚‹htmlæƒ…å ±ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™ã€‚



Clientã‚’ä½œã‚‹ã®ã¯Supabaseã®ä¸­èº«ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚
Supabaseã®ä¸­ã«ã¯å„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®çŠ¶æ…‹ãŒä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã€‚
ã ã‹ã‚‰ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ã„ãã¤ä½œã‚ã†ãŒçµæœã¯åŒã˜ã€‚



<details><summary>useræƒ…å ±ã®ä¸­èº«</summary></details>

```
useræƒ…å ±:  {
  id: 'bcce1407-f302-4d1f-8ff9-6da8371576d9',
  aud: 'authenticated',
  role: 'authenticated',
  email: '*****@gmail.com',
  email_confirmed_at: '2024-04-30T00:50:06.100161Z',
  phone: '',
  confirmed_at: '2024-04-30T00:50:06.100161Z',
  last_sign_in_at: '2024-05-08T00:24:19.109395Z',
  app_metadata: { provider: 'github', providers: [ 'github' ] },
  user_metadata: {
    avatar_url: 'https://avatars.githubusercontent.com/u/7696510?v=4',
    email: '*****@gmail.com',
    email_verified: true,
    full_name: 'masakinihirota',
    iss: 'https://api.github.com',
    name: 'masakinihirota',
    phone_verified: false,
    preferred_username: 'masakinihirota',
    provider_id: '7696510',
    sub: '7696510',
    user_name: 'masakinihirota'
  },
  identities: [
    {
      identity_id: '0af821e2-683d-4ddc-8314-eb2cba169b6d',
      id: '7696510',
      user_id: 'bcce1407-f302-4d1f-8ff9-6da8371576d9',
      identity_data: [Object],
      provider: 'github',
      last_sign_in_at: '2024-04-30T00:50:06.09504Z',
      created_at: '2024-04-30T00:50:06.095073Z',
      updated_at: '2024-05-08T00:24:18.260691Z',
      email: '*****@gmail.com'
    }
  ],
  created_at: '2024-04-30T00:50:06.090609Z',
  updated_at: '2024-05-08T00:24:19.117078Z',
  is_anonymous: false
}

```



----------------------------------------
----------------------------------------
----------------------------------------

# ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã§ç”¨æ„ã•ã‚Œã¦ã„ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«

Supabase schemaã®publicã®ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ã‚µãƒ³ãƒ—ãƒ«ãŒç”¨æ„ã—ãŸ5ã¤ãŒã™ã§ã«ã‚ã‚Šã¾ã™ã€‚
Supabase schemaã®authã®ãƒ†ãƒ¼ãƒ–ãƒ«ã¯Supabaseã®ã‚·ã‚¹ãƒ†ãƒ ã§ç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚

Supabaseã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰ã€
å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®Table Editorã‹ã‚‰è¦‹ã¦ã¿ã¾ã™ã€‚

customers
prices
products
subscriptions
users

ã®5ã¤ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚

ä»Šå›ã¯usersã‚’è¦‹ã¦ã¿ã¾ã™ã€‚

å‚è€ƒ

RLS(Row Level Security)å…¥é–€ã‚¬ã‚¤ãƒ‰ Supabase(Postgres)ãƒ‡ãƒ¼ã‚¿ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®åŸºç¤ #PostgreSQL - Qiita

https://qiita.com/masakinihirota/items/011c9ee596f6e4bcc78a



## Supabaseã®public.usersãƒ†ãƒ¼ãƒ–ãƒ«

### Supabaseã®public.usersãƒ†ãƒ¼ãƒ–ãƒ«ã®RLS

ãƒ†ãƒ¼ãƒ–ãƒ«public.usersã‚’é¸æŠã—ã€å³ä¸Šã«
2Auth policies
ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚

ğŸ‘‡ãã†ã™ã‚‹ã¨ã€ç¾åœ¨æœ‰åŠ¹ãªRLSãŒè¦‹ã‚Œã¾ã™ã€‚


#### UPDATE

```update.sql
alter policy "Can update own user data."
on "public"."users"
to public
using (
  (auth.uid() = id)
);

```

ğŸ‘†ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«ã®æƒ…å ±ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼è‡ªèº«ã®ã¿ãŒæ›´æ–°



#### SELECT

```select.sql
alter policy "Can view own user data."
on "public"."users"
to public
using (
  (auth.uid() = id)
);

```

ğŸ‘†ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«ã®æƒ…å ±ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼è‡ªèº«ã®ã¿ãŒå–å¾—



### API Docs

Table Editorã®å³ä¸Š API Docsãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚

ç¾åœ¨ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

```Columns
Name	Format	Type	Description
id	uuid	string
full_name	text	string
avatar_url	text	string
billing_address	jsonb	json
payment_method	jsonb	json

```




åŸºæœ¬æ§‹æ–‡ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

### Read rows

usersãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰å…¨ã¦ã®ã‚«ãƒ©ãƒ ã‚’èª­ã¿è¾¼ã¿

```Read all rows
let { data: users, error } = await supabase
  .from('users')
  .select('*')

```



ç‰¹å®šã®ã‚«ãƒ©ãƒ ã‚’èª­ã¿è¾¼ã¿

```Read specific columns
let { data: users, error } = await supabase
  .from('users')
  .select('some_column,other_column')

```



usersãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã€other_tableã¨ã„ã†é–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ã‚‚ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—

```Read referenced tables
// å‚ç…§ã•ã‚Œã¦ã„ã‚‹åˆ¥ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚‚å–å¾—
let { data: users, error } = await supabase
  .from('users')
  .select(`
    some_column,
    other_table (
      foreign_key
    )
  `)

```



ãƒ‘ã‚®ãƒãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãã§ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—

```With pagination
// ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
const { data: users, error } = await supabase
  .from('users')
  .select('*')
  .range(0, 9); // å–å¾—ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã®ç¯„å›²ã‚’æŒ‡å®šï¼ˆ0ã‹ã‚‰9ä»¶ã¾ã§ï¼‰

```



### Filtering

usersãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹éš›ã«ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚’è¡Œã†æ–¹æ³•

```With filtering
let { data: users, error } = await supabase
  .from('users')
  .select("*")

  // æ§˜ã€…ãªãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ¡ä»¶ã‚’æŒ‡å®š
  .eq('column', 'Equal to') // ç­‰ã—ã„
  .gt('column', 'Greater than') // ã‚ˆã‚Šå¤§ãã„
  .lt('column', 'Less than') // ã‚ˆã‚Šå°ã•ã„
  .gte('column', 'Greater than or equal to') // ä»¥ä¸Š
  .lte('column', 'Less than or equal to') // ä»¥ä¸‹
  .like('column', '%CaseSensitive%') // ã‚±ãƒ¼ã‚¹ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãªéƒ¨åˆ†ä¸€è‡´
  .ilike('column', '%CaseInsensitive%') // ã‚±ãƒ¼ã‚¹ã‚¤ãƒ³ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãªéƒ¨åˆ†ä¸€è‡´
  .is('column', null) // NULLã§ã‚ã‚‹
  .in('column', ['Array', 'Values']) // é…åˆ—ã®ä¸­ã«å«ã¾ã‚Œã‚‹
  .neq('column', 'Not equal to') // ç­‰ã—ããªã„

// é…åˆ—ã«é–¢ã™ã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ¡ä»¶
  .contains('array_column', ['array', 'contains']) // é…åˆ—ã®è¦ç´ ã‚’å«ã‚€
  .containedBy('array_column', ['contained', 'by']); // é…åˆ—ã®è¦ç´ ã«å«ã¾ã‚Œã‚‹

```



### Insert rows

insertã¯ãƒ†ãƒ¼ãƒ–ãƒ«ã«æŒ¿å…¥ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä¸€æ‹¬æŒ¿å…¥ã‚„UPSERTã‚‚å¯èƒ½ã§ã™ã€‚

insertã¯UPSERTç”¨ã«ç½®æ›ã•ã‚ŒãŸå€¤ã‚‚è¿”ã—ã¾ã™ã€‚

æŒ¿å…¥

```Insert a row
const { data, error } = await supabase
  .from('users')
  .insert([
    { some_column: 'someValue', other_column: 'otherValue' },
  ])
  .select()

```

è¤‡æ•°æŒ¿å…¥

```Insert many rows
const { data, error } = await supabase
  .from('users')
  .insert([
    { some_column: 'someValue' },
    { some_column: 'otherValue' },
  ])
  .select()

```

ç‰¹å®šã®æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹è¡Œã‚’æ›´æ–°ã¾ãŸã¯æŒ¿å…¥ã™ã‚‹æ–¹æ³•

upsertãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€æŒ‡å®šã•ã‚ŒãŸæ¡ä»¶ã«ä¸€è‡´ã™ã‚‹è¡ŒãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯æ›´æ–°ã—ã€å­˜åœ¨ã—ãªã„å ´åˆã¯æ–°ã—ã„è¡Œã‚’æŒ¿å…¥ã—ã¾ã™ã€‚

```Upsert matching rows
// ç‰¹å®šã®æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹è¡Œã‚’æ›´æ–°ã¾ãŸã¯æŒ¿å…¥
const { data, error } = await supabase
  .from('users')
  .upsert({ some_column: 'someValue' }) // æ›´æ–°ã¾ãŸã¯æŒ¿å…¥ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æŒ‡å®š
  .select(); // æ›´æ–°ã¾ãŸã¯æŒ¿å…¥å¾Œã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—

```



### Update rows

updateã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã™ã¹ã¦ã®è¡Œã«ãƒãƒƒãƒã—ã¾ã™ã€‚eqã€ltã€is ãªã©ã®æ°´å¹³ãƒ•ã‚£ãƒ«ã‚¿ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ç‰¹å®šã®è¡Œã‚’æ›´æ–°ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

updateã¯UPDATEã§ç½®æ›ã•ã‚ŒãŸå€¤ã‚‚è¿”ã—ã¾ã™ã€‚

```Update matching rows
const { data, error } = await supabase
  .from('users')
  .update({ other_column: 'otherValue' })
  .eq('some_column', 'someValue')
  .select()

```



### Delete rows

deleteã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã™ã¹ã¦ã®è¡Œã«ãƒãƒƒãƒã™ã‚‹ã®ã§ã€ãƒ•ã‚£ãƒ«ã‚¿ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚
`Delete matching rows
// ç‰¹å®šã®æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹è¡Œã‚’å‰Šé™¤
const { error } = await supabase
  .from('users')
  .delete()
  .eq('some_column', 'someValue')

```



### Subscribe to changes

Subscribeã¯ã€PostgreSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ç‰¹å®šã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãŠã‘ã‚‹å¤‰æ›´ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ç›£è¦–ã—ã¾ã™ã€‚

ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ã€'custom-all-channel'ã¨ã„ã†ã‚«ã‚¹ã‚¿ãƒ ãƒãƒ£ãƒ³ãƒãƒ«ã‚’ä½œæˆã—ã€postgres_changesã‚¤ãƒ™ãƒ³ãƒˆã‚’ç›£è¦–ã—ã¦ã„ã¾ã™ã€‚

event: '*'ã¨ã—ã¦ã™ã¹ã¦ã®ã‚¤ãƒ™ãƒ³ãƒˆã«å¯¾ã—ã¦ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒ–ã—ã€schema: 'public'ã¨table: 'users'ã§publicã‚¹ã‚­ãƒ¼ãƒã®usersãƒ†ãƒ¼ãƒ–ãƒ«ã®å¤‰æ›´ã‚’ç›£è¦–ã—ã¦ã„ã¾ã™ã€‚

å¤‰æ›´ãŒç™ºç”Ÿã™ã‚‹ãŸã³ã«ã€ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ãŒå‘¼ã³å‡ºã•ã‚Œã€å¤‰æ›´ã®è©³ç´°ãŒå«ã¾ã‚Œã‚‹ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ãŒã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚


```Subscribe to all events
// ã™ã¹ã¦ã®ã‚¤ãƒ™ãƒ³ãƒˆã«å¯¾ã—ã¦ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒ–
const channels = supabase.channel('custom-all-channel')
  .on(
    'postgres_changes',
    { event: '*', schema: 'public', table: 'users' },
    (payload) => {
      console.log('Change received!', payload)
    }
  )
  .subscribe()

```



ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ã€'custom-insert-channel'ã¨ã„ã†ã‚«ã‚¹ã‚¿ãƒ ãƒãƒ£ãƒ³ãƒãƒ«ã‚’ä½œæˆã—ã€postgres_changesã‚¤ãƒ™ãƒ³ãƒˆã‚’ç›£è¦–ã—ã¦ã„ã¾ã™ã€‚event: 'INSERT'ã¨ã—ã¦æŒ¿å…¥ã‚¤ãƒ™ãƒ³ãƒˆã«ã®ã¿ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒ–ã—ã€schema: 'public'ã¨table: 'users'ã§publicã‚¹ã‚­ãƒ¼ãƒã®usersãƒ†ãƒ¼ãƒ–ãƒ«ã®å¤‰æ›´ã‚’ç›£è¦–ã—ã¦ã„ã¾ã™ã€‚æŒ¿å…¥ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã™ã‚‹ãŸã³ã«ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå‡ºåŠ›ã•ã‚Œã¾ã™ã€‚

```Subscribe to inserts
// æŒ¿å…¥ã‚¤ãƒ™ãƒ³ãƒˆã«å¯¾ã—ã¦ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒ–
const channels = supabase.channel('custom-insert-channel')
  .on(
    'postgres_changes',
    { event: 'INSERT', schema: 'public', table: 'users' },
    (payload) => {
      console.log('Change received!', payload)
    }
  )
  .subscribe()

```



```Subscribe to updates
// æ›´æ–°ã‚¤ãƒ™ãƒ³ãƒˆã«å¯¾ã—ã¦ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒ–
const channels = supabase.channel('custom-update-channel')
  .on(
    'postgres_changes',
    { event: 'UPDATE', schema: 'public', table: 'users' },
    (payload) => {
      console.log('Change received!', payload)
    }
  )
  .subscribe()

```



```Subscribe to deletes
// å‰Šé™¤ã‚¤ãƒ™ãƒ³ãƒˆã«å¯¾ã—ã¦ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒ–
const channels = supabase.channel('custom-delete-channel')
  .on(
    'postgres_changes',
    { event: 'DELETE', schema: 'public', table: 'users' },
    (payload) => {
      console.log('Change received!', payload)
    }
  )
  .subscribe()

```



```Subscribe to specific rows
const channels = supabase.channel('custom-filter-channel')
  .on(
    'postgres_changes',
    { event: '*', schema: 'public', table: 'users', filter: 'some_column=eq.some_value' },
    (payload) => {
      console.log('Change received!', payload)
    }
  )
  .subscribe()

```





	----------------------------------------
	----------------------------------------
	----------------------------------------

	publicä»¥å¤–ã®ã‚¹ã‚­ãƒ¼ãƒã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•

	ç¬¬äºŒå¼•æ•°ã«ã‚¹ã‚­ãƒ¼ãƒåã‚’æŒ‡å®šã—ã¾ã™ã€‚


	ã‚¹ã‚­ãƒ¼ãƒãŒpublicä»¥å¤–ã®å ´åˆã€fromãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°ã«ã‚¹ã‚­ãƒ¼ãƒåã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

	ä¾‹ãˆã°ã€todoã‚¹ã‚­ãƒ¼ãƒã®å ´åˆã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«æŒ‡å®šã§ãã¾ã™ã€‚

	const todos = await supabase.from('todo', { schema: 'todo' }).select('*');

	ã“ã“ã§ã¯ã€fromãƒ¡ã‚½ãƒƒãƒ‰ã®ç¬¬2å¼•æ•°ã«ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨ã—ã¦schemaã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚schemaã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã¯ã€ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå­˜åœ¨ã™ã‚‹ã‚¹ã‚­ãƒ¼ãƒåã‚’æŒ‡å®šã—ã¾ã™ã€‚ä¸Šè¨˜ã®ä¾‹ã§ã¯ã€todoã‚¹ã‚­ãƒ¼ãƒã«ã‚ã‚‹todoãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ã™ã¹ã¦ã®TODOã‚’å–å¾—ã—ã¦ã„ã¾ã™ã€‚


	----------------------------------------

	Javascriptã§ã®ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•
	Supabaseã®å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®Table Editorã®å³ä¸Šã«ã‚ã‚‹
	ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®API Docsã‚’é–‹ã



----------------------------------------
----------------------------------------
----------------------------------------

# Supabaseã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•

å‚è€ƒ
Next.js 13 App router ã¨ Supabase ã§ã®ï¼”ã¤ã®ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³• #Next.js - Qiita

https://qiita.com/masakinihirota/items/b4b168a056dc10776d87

## ä¸‹æº–å‚™

### todosãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ

```todos.sql
create table if not exists todos (
  id uuid default gen_random_uuid() primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  title text,
  is_complete boolean default false,
  user_id uuid references auth.users default auth.uid()
);

-- Set up Row Level Security (RLS)
-- See https://supabase.com/docs/guides/auth/row-level-security for more details.
alter table todos
  enable row level security;

create policy "Authenticated users can select todos" on todos
  for select to authenticated using (true);

create policy "Authenticated users can insert their own todos" on todos
  for insert to authenticated with check (auth.uid() = user_id);

```

ğŸ‘†SQL Editorã§å®Ÿè¡Œã™ã‚‹ã¨ã€
public.todosãƒ†ãƒ¼ãƒ–ãƒ«ãŒå‡ºæ¥ã¾ã™ã€‚



### ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ

```dummy.sql
insert into todos(title)
values
  ('Create Supabase project'),
  ('Create Next.js app from Supabase Starter template'),
  ('Keep building cool stuff!');

```

ğŸ‘†SQL Editorã§å®Ÿè¡Œã™ã‚‹ã¨ã€
public.todosãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ãŒæŒ¿å…¥ã•ã‚Œã¾ã™ã€‚

ä»¥ä¸Šã§ä¸‹æº–å‚™ã¯å®Œäº†ã§ã™ã€‚



----------------------------------------

#### ãƒ•ã‚©ãƒ«ãƒ€ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã®è¿½åŠ 

```terminal
mkdir src\app\examples\client-component
mkdir src\app\examples\route-handler
mkdir src\app\examples\server-action
mkdir src\app\examples\server-component

touch src\app\examples\client-component\page.tsx
touch src\app\examples\route-handler\page.tsx
touch src\app\examples\server-action\page.tsx
touch src\app\examples\server-component\page.tsx

```



#### ãƒªãƒ³ã‚¯ã®è¿½åŠ 

ğŸ‘‡é©å½“ãªå ´æ‰€ã«ãƒªãƒ³ã‚¯ã‚’å¼µã‚Šã¾ã™ã€‚

```src\app\page.tsx
ãƒ»ãƒ»ãƒ»
      <br />
      <Link href="./ja/examples/client-component">Client Component Example</Link>
      <br />
      <Link href="./ja/examples/route-handler">Route Handler Example</Link>
      <br />
      <Link href="./ja/examples/server-action">Server Action Example</Link>
      <br />
      <Link href="./ja/examples/server-component">Server Component Example</Link>
      <br />

ãƒ»ãƒ»ãƒ»

```



### å‹ã®å–å¾—

todosãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ–°ãŸã«ä½œã£ãŸã®ã§ã€å‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚
src\types\types_db.tsã¯å‹ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ãŒã€ã“ã®å‹ãƒ•ã‚¡ã‚¤ãƒ«(types_db.ts)ã¯ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ãŒç”¨æ„ã—ã¦ã„ã‚‹å‹ãƒ•ã‚¡ã‚¤ãƒ«ãªã®ã§ã€Stripeé–¢é€£ã®å‹ãŒæ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚

ãã‚Œã¨ã¯åˆ¥ã«ãƒ­ãƒ¼ã‚«ãƒ«ã®å‹ãƒ•ã‚¡ã‚¤ãƒ«(types_db.ts)ã‚’ä½œæˆã—ã¾ã™ã€‚

```terminal
supabase gen types typescript --local > src/types/types_db.ts

```


----------------------------------------

## 1 ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ Supabaseã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹æ–¹æ³•

```src\app\[lng]\examples\client-component\page.tsx
'use client'

import { useEffect, useState } from 'react'

// Supabase ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½œæˆ
import { createClient } from '@/utils/supabase/client';

export default function ClientComponent() {
  const [todos, setTodos] = useState<any[]>([])
  const supabase = createClient();

  useEffect(() => {
    const getTodos = async () => {
      const { data } = await supabase.from('todos').select()
      if (data) {
        setTodos(data)
      }
    }

    getTodos()
  }, [supabase, setTodos])

  return (<pre>{JSON.stringify(todos, null, 2)}</pre>)
}

```

### å‹•ä½œç¢ºèª

todosãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ãŒç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã®ã‚’ç¢ºèªã—ã¦ãŠãã¾ã™ã€‚
ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ã¨todosãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã‚Œã¾ã™ã€‚
ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¦ã„ã‚‹ã¨todosãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚


----------------------------------------

# å…¥å‡ºåŠ›

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ

```
import { createClient } from "@supabase/supabase-js";

// Create a single supabase client for interacting with your database
export const supabase = createClient(
  process.env.NEXT_PUBLIC_SUPABASE_URL!,
  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
);

```

ğŸ‘†ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½œã‚‹

é–¢æ•°ã‚’ä½œã‚‹

```
export const getAllTodos = async () => {
  const todos = await supabase.from('todo').select('*');
  return todos.data;
};

```

```
export const addTodo = async (title: string) => {
  console.log('addTodo() title:', title);

  await supabase.from('todo').insert({ title });
};

```

```
export const deleteTodo = async (id: number) => {
  await supabase.from('todo').delete().eq('id', id);
};

```



----------------------------------------
----------------------------------------
----------------------------------------

# ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³

Next.jsã§ã¯ã€

`_ãƒ•ã‚©ãƒ«ãƒ€å`

â†‘ã“ã®ã‚ˆã†ã«æ›¸ãã¨ã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã§ç„¡è¦–ã•ã‚Œã¾ã™ã€
ãã®æ©Ÿèƒ½ã‚’åˆ©ç”¨ã—ã¦
_componentsã‚’ä½œæˆã—ã¾ã™ã€‚
ãã†ã—ã¦ã€ã“ã®ä¸­ã«1ãƒšãƒ¼ã‚¸åˆ†ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ãã¾ã™ã€‚
ã“ã‚Œã§ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‹ã‚‰å¤–ã‚ŒãŸ1ãƒšãƒ¼ã‚¸åˆ†ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå‡ºæ¥ã¾ã™ã€‚

å…±é€šã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯å¤–å´ã«ã‚ã‚‹ã€å…±é€šã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã«ç½®ãã¾ã™ã€‚

åŸºæœ¬ã®å¿…è¦ãƒ•ã‚¡ã‚¤ãƒ«
fetch.tsx
business.tsx
loading.tsx
error.tsx
page.tsx
***.stories.tsx
***.test.tsx



----------------------------------------

# 1ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

## ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ 

1ãƒšãƒ¼ã‚¸ã®ä»®ã®è¦‹ãŸç›®ã‚’ä½œã‚‹

## ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆ

1ç”»é¢ã®ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ã‹ã‚‰å¿…è¦ãªãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¨­è¨ˆã™ã‚‹

## ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ

è¨­è¨ˆã—ãŸãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å®Ÿéš›ã«Supabaseã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œã‚‹

## ãƒ‡ãƒ¼ã‚¿å…¥åŠ›

ä½œã£ãŸãƒ†ãƒ¼ãƒ–ãƒ«ã«ã€ãƒ†ã‚¹ãƒˆç”¨ã®ä»®ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ•°ä»¶å…¥åŠ›ã™ã‚‹

## ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ã€å–å¾—

Next.jsã‹ã‚‰Supabaseã¸ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹
ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹

## ãƒ‡ãƒ¼ã‚¿åŠ å·¥

å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’åŠ å·¥ã™ã‚‹


## ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º

åŠ å·¥ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘å–ã£ã¦
1ãƒšãƒ¼ã‚¸ã«è¡¨ç¤ºã™ã‚‹

SupabaseDB ã‚’ä½¿ã£ã¦ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã€ãã‚Œã‚’è¡¨ç¤ºã™ã‚‹Next.jsã‚¢ãƒ—ãƒª

## ãƒ‡ãƒ¼ã‚¿å–å¾— fetchã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```fetch.tsx
import { createClient } from '@supabase/supabase-js';

// Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ä½œæˆ
const supabase = createClient('SUPABASE_URL', 'SUPABASE_KEY');

// ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹é–¢æ•°
export async function fetchData() {
  // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
  const { data, error } = await supabase.from('table_name').select('*');

  if (error) {
    console.error('Error fetching data:', error.message);
    return null;
  }

  return data;
}

```



## ãƒ‡ãƒ¼ã‚¿åŠ å·¥ ãƒ“ã‚¸ãƒã‚¹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```business.tsx
import { fetchData } from './fetch';

// ãƒ‡ãƒ¼ã‚¿ã‚’åŠ å·¥ã™ã‚‹é–¢æ•°
export function processData(data: any[]) {
  // ã“ã“ã§ãƒ‡ãƒ¼ã‚¿ã®åŠ å·¥ã‚„å‡¦ç†ã‚’è¡Œã†
  // ä¾‹: ç‰¹å®šã®æ¡ä»¶ã«åŸºã¥ã„ãŸãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚„ä¸¦ã¹æ›¿ãˆ

  return data;
}

```



## ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```page.tsx
// page.tsx
import { useEffect, useState } from 'react';
import { fetchData } from './fetch';
import { processData } from './business';

export default function Page() {
  const [data, setData] = useState<any[]>([]);

  // ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã€stateã«ã‚»ãƒƒãƒˆã™ã‚‹
  useEffect(() => {
    const getData = async () => {
      const fetchedData = await fetchData();
      if (fetchedData) {
        const processedData = processData(fetchedData);
        setData(processedData);
      }
    };
    getData();
  }, []);

  // ãƒ‡ãƒ¼ã‚¿ã®è¡¨ç¤º
  return (
    <div>
      <h1>Data</h1>
      <ul>
        {data.map((item, index) => (
          <li key={index}>{/* ãƒ‡ãƒ¼ã‚¿ã®è¡¨ç¤º */}</li>
        ))}
      </ul>
    </div>
  );
}

```

å®Ÿéš›ã®ã‚³ãƒ¼ãƒ‰ä¾‹ã‚’ä½œã£ã¦ãã ã•ã„ã€‚



----------------------------------------
----------------------------------------
----------------------------------------

# ãƒ†ã‚¹ãƒˆ

Presentation/Logicã‚’åˆ†é›¢ã—ã¦ã€ãƒ†ã‚¹ãƒˆã—ã‚„ã™ã•ã‚’ã‚ã‚‰ã‹ã˜ã‚æ‹…ä¿ã™ã‚‹
ESLint prettier é™çš„è§£æ
Storybookã®UIã‚«ã‚¿ãƒ­ã‚°
Snapshotãƒ†ã‚¹ãƒˆ
VRT

ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®"ã¡ã‚‡ã†ã©ã„ã„"è‡ªå‹•ãƒ†ã‚¹ãƒˆã®ã¯ã˜ã‚ã‹ãŸ - Atrae Tech Blog
https://atraetech.hatenablog.com/entry/2022/09/30/105747

è‡ªå‹•ãƒ†ã‚¹ãƒˆã®ã—ã‚„ã™ã•ã«ä¸»çœ¼ã‚’ç½®ã



é–¢æ•°å˜ä½ã®ãƒ†ã‚¹ãƒˆ
Unit Test
	vitest
	Jest

ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå˜ä½ã®ãƒ†ã‚¹ãƒˆ
Integration Test
	React Testing Library

å…¨ä½“ã®å‹•ä½œã®ãƒ†ã‚¹ãƒˆ
End to end Test(E2E)
	Playwright



----------------------------------------
----------------------------------------
----------------------------------------

# ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•ç”Ÿæˆ 1

App routerã§å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€æŒ™ã«ä½œã‚‹æ‹¡å¼µæ©Ÿèƒ½

VSCodeæ‹¡å¼µæ©Ÿèƒ½
Next.js CLI - Visual Studio Marketplace
https://marketplace.visualstudio.com/items?itemName=KristiyanVelkov.nextjs-cli

ğŸ‘† pages.tsxã€layouts.tsxã€ errors.tsxã€ not-found.tsx ä»–ã‚’ã¾ã¨ã‚ã¦è‡ªå‹•ç”Ÿæˆã—ã¾ã™ã€‚



# ãƒ•ã‚¡ã‚¤ãƒ«ã®è‡ªå‹•ç”Ÿæˆ 2

scaffdogã‚’å°å…¥ã—ã¦Storybookã‚’ä½¿ã£ãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä½œæˆã‚’å¹¸ã›ã«ã—ã¦ã¿ãŸ #storybook - Qiita
https://qiita.com/yr_tms/items/5ccaf2d140bea1d6c2d1

ğŸ‘† Next.jsä»¥å¤–ã®ãƒ•ã‚¡ã‚¤ãƒ«ã€Storyãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ä¸€ç·’ã«ä½œã‚ŠãŸã„ã®ãªã‚‰ã°
é–‹ç™ºã«æ…£ã‚Œã¦ãã¦ã€å¤§é‡ã«ä½œã‚‹ã‚ˆã†ã«ãªã£ãŸã‚‰ã“ã¡ã‚‰ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚



# ãƒ•ã‚¡ã‚¤ãƒ«ã®è‡ªå‹•ç”Ÿæˆ 3

Nextjs snippets - Visual Studio Marketplace
https://marketplace.visualstudio.com/items?itemName=PulkitGangwar.nextjs-snippets

ğŸ‘† ã‚¹ãƒ‹ãƒšãƒƒãƒˆå½¢å¼ã§ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã¾ã™ã€‚ ãŸã ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ã¯æ‰‹å‹•ã§ä½œã‚Šã¾ã™ã€‚

æ‹¡å¼µæ©Ÿèƒ½ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã€çŸ­ç¸®ã‚³ãƒ¼ãƒ‰ã‚’è¦šãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

â€»ã‚¹ãƒ‹ãƒšãƒƒãƒˆã¯VScodeã®åŸºæœ¬æ©Ÿèƒ½ã«ã‚ã‚‹ã®ã§ã€ãã®ä»–ã®ã‚¹ãƒ‹ãƒšãƒƒãƒˆã‚‚è‡ªä½œã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚



----------------------------------------
----------------------------------------
----------------------------------------

# ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º

å†è€ƒ ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º #TDD - Qiita
https://qiita.com/masakinihirota/items/0a714d729d14da5cc7f4

ç›®æ¨™
è¨­è¨ˆæ›¸ã‚’ä½œã£ã¦ã‹ã‚‰ã€ãã‚Œã‚’å…ƒã«ãƒ†ã‚¹ãƒˆãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚
1ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«æœ€ä½1ã¤ã®ãƒ†ã‚¹ãƒˆã‚’ä½œã‚Šã¾ã™ã€‚
ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ãƒ†ã‚¹ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

â€»è¨­è¨ˆæ›¸ã¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œæˆå¾Œã«è€ƒãˆã¾ã™ã€‚



é–‹ç™ºã¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’
ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º
ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³
ã§è¡Œã„ã¾ã™ã€‚

ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã¯ã€åŒã˜éšå±¤ã«ã‚³ãƒ¼ãƒ‰ã¨ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’ä¸€ç·’ã«ä¸¦ã¹ã¦ãŠãé–‹ç™ºæ‰‹æ³•ã§ã™ã€‚

ä¾‹
src/component/about.tsx			ï¼œï¼œaboutã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
src/component/about.test.tsx		ï¼œï¼œaboutã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«

ã‚³ãƒ¼ãƒ‰ã¨ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’ä¸€ç·’ã«ç½®ãã€‚


ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã«
vitest
React Testing Library
ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚

# vitest

Testing: Vitest | Next.js

https://nextjs.org/docs/app/building-your-application/testing/vitest

next.js/examples/with-vitest at canary Â· vercel/next.js

https://github.com/vercel/next.js/tree/canary/examples/with-vitest



ç¾åœ¨ã€vitestã¯éåŒæœŸã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ã¯å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

pnpm i @vitejs/plugin-react

â€»ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ -D ãƒ•ãƒ©ã‚°ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨èªè­˜ã—ãªã„ã€‚

pnpm i server-only

pnpm i -D @testing-library/jest-dom @testing-library/react @testing-library/user-event @vitest/ui jsdom vitest



## VSCodeæ‹¡å¼µæ©Ÿèƒ½

Vitest - Visual Studio Marketplace

https://marketplace.visualstudio.com/items?itemName=ZixuanChen.vitest-explorer

ã“ã®æ‹¡å¼µæ©Ÿèƒ½ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã«ã¯ã€npm run test ã‚’å®Ÿè¡Œã•ã›ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
(vitest ã® ã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰)

VSCodeã®ã‚¨ãƒ‡ã‚£ã‚¿ç”»é¢ã®è¡Œã®å·¦ã«GREENã‚„REDã®ã‚¢ã‚¤ã‚³ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚
å·¦ã‚¯ãƒªãƒƒã‚¯ã§ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
å³ã‚¯ãƒªãƒƒã‚¯ã§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒé–‹ãã¾ã™ã€‚

## ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®è¿½åŠ 

```package.json
    "test": "vitest",
    "test:ui": "vitest --ui",
    "coverage": "vitest run --coverage",

```

testã¯ã‚¦ã‚©ãƒƒãƒå½¢å¼ã§ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ä¿å­˜ã™ã‚‹ãŸã³ã«ãƒ†ã‚¹ãƒˆãŒå›ã‚Šã¾ã™ã€‚
test:uiã¯ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ†ã‚¹ãƒˆçµæœã‚’è¡¨ç¤ºã—ã¦ãã‚Œã¾ã™ã€‚



## vitestã®ã‚³ãƒ³ãƒ•ã‚£ã‚°è¨­å®š

touch vitest.config.ts

```vitest.config.ts
/// <reference types="vitest" />
import react from "@vitejs/plugin-react";
import { defineConfig } from "vitest/config";

// https://vitejs.dev/config/
export default defineConfig({
  plugins: [react()],
  test: {
    globals: true,
    environment: "jsdom",
    include: ["app/**/*.test.{js,ts,jsx,tsx}"],
  },
});

```



----------------------------------------

## ãƒ†ã‚¹ãƒˆå®Ÿè£…ç·¨

### 4ã¤ã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰

1. åŸºæœ¬ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
1. Hooksã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
1. å‹•çš„ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
1. RSC(React Server Components)ã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰



#### ã‚µãƒ³ãƒ—ãƒ«01 åŸºç¤ ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ãã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰

ä¸€ç•ªã‚·ãƒ³ãƒ—ãƒ«ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œã‚Šã€
ãã“ã«æŒ‡å®šã•ã‚ŒãŸæ–‡å­—ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã©ã†ã‹ãƒ†ã‚¹ãƒˆã‚’ã—ã¾ã™ã€‚


mkdir src\app\sample\ClientComponent
touch src\app\sample\ClientComponent\Index.tsx
touch src\app\sample\ClientComponent\Index.test.tsx


```src\app\sample\ClientComponent\Index.tsx
"use client"
import React from "react"

export default function ClientComponent() {
  return <h1>Client Component</h1>
}

```



```src\app\sample\ClientComponent\Index.test.tsx
import { render, screen } from "@testing-library/react"
import React from "react"
import { expect, test } from "vitest"

import ClientComponent from './Index';

test("App Router: Works with Client Components", () => {
  render(<ClientComponent />)
  expect(
    screen.getByRole("heading", { level: 1, name: "Client Component" })
  ).toBeDefined()
})

```

ãƒ†ã‚¹ãƒˆã®å‹•ä½œç¢ºèª

npm test



ãƒ–ãƒ©ã‚¦ã‚¶ã§è¡¨ç¤ºã—ã¾ã™ã€‚

```app/page.tsx
import ClientComponent from '@/app/sample/ClientComponent/Index';

ãƒ»ãƒ»ãƒ»

      ãƒ†ã‚¹ãƒˆ
      <ClientComponent />

```

å‹•ä½œç¢ºèª

npm run dev



#### ã‚µãƒ³ãƒ—ãƒ«02 Hooksã‚’ä½¿ç”¨ã—ãŸã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ãã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰

Hooksã‚’åˆ©ç”¨ã—ã¦ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ï¼‹ï¼‘ã—ã¦ã„ãã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä½œæˆ

ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

touch src\app\sample\Counter\Counter.tsx
touch src\app\sample\Counter\Counter.test.tsx


```src\app\sample\Counter\Counter.tsx
"use client"

import React from "react"
import { useState } from "react"

const Counter = () => {
  const [count, setCount] = useState(0)
  return (
    <div>
      ãƒ†ã‚¹ãƒˆç”¨ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼
      <h2>{count}</h2>
      <button type="button" onClick={() => setCount(count + 1)}>
        +
      </button>
    </div>
  )
}

export default Counter

```

useStateã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã§ 'use client'ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’ä»˜ã‘ã¾ã™ã€‚



ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«

```src\app\sample\Counter\Counter.test.tsx
import { render, screen, fireEvent } from "@testing-library/react"
import React from "react"
import { expect, test } from "vitest"

import Counter from './Counter';

test("App Router: Works with Client Components (React State)", () => {
  render(<Component />)
  expect(screen.getByRole("heading", { level: 2, name: "0" })).toBeDefined()
  fireEvent.click(screen.getByRole("button"))
  expect(screen.getByRole("heading", { level: 2, name: "1" })).toBeDefined()
})

```

ãƒ†ã‚¹ãƒˆã®å‹•ä½œç¢ºèª

npm test



ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã«ã‚‚è¡¨ç¤ºã•ã›ã¾ã™ã€‚



```app\page.tsx
import Counter from '@/app/sample/Counter/Counter';
import ClientComponent from '@/app/sample/ClientComponent/Index';

ãƒ»ãƒ»ãƒ»

      ãƒ†ã‚¹ãƒˆ
      <ClientComponent />
      <Counter />

```

å‹•ä½œç¢ºèª

npm run dev



#### ã‚µãƒ³ãƒ—ãƒ«03 å‹•çš„ãªãƒ«ãƒ¼ãƒˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ãŸå ´åˆã®ãƒ†ã‚¹ãƒˆ

mkdir src\app\sample\[slug]
touch src\app\sample\[slug]\Page.tsx
touch src\app\sample\[slug]\Page.test.tsx


```src\app\sample\[slug]\Page.tsx
type Params = {
  params: {
    slug: string
  }
}

export async function generateMetadata({ params }: Params) {
  return { title: `Post: ${params.slug}` }
}

export default function Page({ params }: Params) {
  return <h1>Slug: {params.slug}</h1>
}

```



```src\app\sample\[slug]\Page.test.tsx
import { render, screen } from "@testing-library/react"
import { expect, test } from "vitest"

import Index from './Page';

test("App Router: Works with dynamic route segments", () => {
  render(<Page params={{ slug: "Test" }} />)
  expect(
    screen.getByRole("heading", { level: 1, name: "Slug: Test" })
  ).toBeDefined()
})

```

ãƒ†ã‚¹ãƒˆã®å‹•ä½œç¢ºèª

npm test



ã“ã®ãƒ†ã‚¹ãƒˆã¯ã€Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ`Page`ãŒã€å‹•çš„ãªãƒ«ãƒ¼ãƒˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦æ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã®ãƒ†ã‚¹ãƒˆã§ã™ã€‚

ãƒ†ã‚¹ãƒˆã§ã¯ã€`render()`é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦`Page`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã—ã€`params`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«`{ slug: "Test" }`ã‚’æ¸¡ã—ã¦ã„ã¾ã™ã€‚ãã®å¾Œã€`screen.getByRole()`é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚ŒãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰`<h1>`è¦ç´ ã‚’å–å¾—ã—ã€ãã®ãƒ†ã‚­ã‚¹ãƒˆãŒ`Slug: Test`ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚

ã¤ã¾ã‚Šã€ã“ã®ãƒ†ã‚¹ãƒˆã¯ã€`Page`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒã€å‹•çš„ãªãƒ«ãƒ¼ãƒˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦ã€æ­£ã—ã`slug`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚Šã€è¡¨ç¤ºã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚



## ãƒ–ãƒ©ã‚¦ã‚¶ã«è¡¨ç¤ºã—ã¾ã™ã€‚

http://localhost:3000/sample/123

123ãŒslugã«ç›¸å½“ã—ã¾ã™ã€ãã—ã¦123ã‚’ç”¨ã„ã¦å‹•çš„ãªãƒšãƒ¼ã‚¸ç”ŸæˆãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

ã“ã®æ©Ÿèƒ½ã‚’ä½¿ã†ã“ã¨ã§æ—¥ä»˜ï¼‹ã‚¿ã‚¤ãƒˆãƒ«ã¨ã„ã£ãŸURLã‚’äº‹å‰ã«ç”¨æ„ã—ãªãã¦ã‚‚å‹•çš„ã«ãƒšãƒ¼ã‚¸ãŒä½œæˆã§ãã¾ã™ã€‚



Topãƒšãƒ¼ã‚¸ã‚’ç·¨é›†ã—ã¾ã™ã€‚

```src\app\page.tsx

export default async function Index() {
  const blogId = '123'; <<è¿½åŠ 

ãƒ»ãƒ»ãƒ»

      ãƒ†ã‚¹ãƒˆ
      <ClientComponent />
      <Counter />
      <Link href={`/sample/${blogId}`}>Blogãƒšãƒ¼ã‚¸</Link>

```

å‹•ä½œç¢ºèª

npm run dev



#### ã‚µãƒ³ãƒ—ãƒ«04 RSCã®ãƒ†ã‚¹ãƒˆ

React server componentsã®ãƒ†ã‚¹ãƒˆ

ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆã€‚

Hooksã‚‚ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªæ“ä½œã‚‚ãªã„ã®ã§ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«å‡ºæ¥ã¾ã™ã€‚

mkdir src\app\sample_rsc
touch src\app\sample_rsc\Index.tsx
touch src\app\sample_rsc\Index.test.tsx


```src\app\sample_rsc\Index.tsx
// import 'server-only' does not currently
// work with Vitest

export default function Page() {
  return <h1>App Router</h1>
}

```

server-onlyã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§å®Œå…¨ã«ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§ã®ã¿å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚
ã—ã‹ã—ç¾åœ¨vitestã§å‹•ãã¾ã›ã‚“ã€‚

```src\app\sample_rsc\Index.test.tsx
import { render, screen } from '@testing-library/react';
import { expect, test } from 'vitest';

import Index from './Index';

test('App Router: Works with Server Components', () => {
  render(<Index />);
  expect(
    screen.getByRole('heading', { level: 1, name: 'App Router' })
  ).toBeDefined();
});

```

ãƒ†ã‚¹ãƒˆã®å‹•ä½œç¢ºèª

npm test



topãƒšãƒ¼ã‚¸ã«è¡¨ç¤ºã•ã›ã¾ã™ã€‚

```app\page.tsx
import Counter from '@/app/sample/Counter/Counter';
import ClientComponent from '@/app/sample/ClientComponent/Index';
import Page from '@/app/sample_rsc/Index';

ãƒ»ãƒ»ãƒ»

      ãƒ†ã‚¹ãƒˆ 4ç¨®é¡
      <ClientComponent />
      <Counter />
      <Link href={`/blog/${blogId}`}>Blogãƒšãƒ¼ã‚¸</Link>
      <Page />

```



å‹•ä½œç¢ºèª

npm run dev



ä»¥ä¸Šã€4ã¤ã®ã‚³ãƒ¼ãƒ‰ã¨ãã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã§ã—ãŸã€‚

ãƒ†ã‚¹ãƒˆã®ã‚³ãƒ¼ãƒ‰ã¯è‰²ã‚“ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¶²ç¾…ã§ãã‚‹ã®ã§å„è‡ªèª¿ã¹ã¦ãã ã•ã„ã€‚



å¤–éƒ¨ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç­‰ï¼‰ã‚’å–å¾—ã—ã¦è¡¨ç¤ºã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãªã©
ãƒ¢ãƒƒã‚¯ã‚’ä½œã‚Œã°ã„ã„ï¼Ÿ

ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆã¯vitest
ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã„ã‚ã„ã‚ãªpropsã‚’è©¦ã™ã«ã¯Storybook
ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®é–‹ç™ºã¯ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º



----------------------------------------
----------------------------------------
----------------------------------------

# plop

plopã¨ã„ã†é››å½¢ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•ç”Ÿæˆãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦ã€
ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿç¾ã—ã¾ã™ã€‚

## Next.js ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
component ã‚µãƒ¼ãƒãƒ¼orã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ

## æ©Ÿèƒ½ã§ãƒ•ã‚¡ã‚¤ãƒ«åˆ†é›¢

ãƒ•ã‚§ãƒƒãƒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ ã®ãƒ•ã‚¡ã‚¤ãƒ«
ãƒ­ã‚¸ãƒƒã‚¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ ã®ãƒ•ã‚¡ã‚¤ãƒ«
ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ ã®ãƒ•ã‚¡ã‚¤ãƒ«

Storybook
ãƒ†ã‚¹ãƒˆ



##

componentã¯
ã‚µãƒ¼ãƒãƒ¼ã‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§ä½¿ã„åˆ†ã‘ã‚‹



## ãƒ•ã‚§ãƒƒãƒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
'use server'
ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
è¡¨ç¤ºã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’Supabaseã‹ã‚‰å–å¾—ã—ã¦ãã‚‹ã€‚



## ãƒ­ã‚¸ãƒƒã‚¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’åŠ å·¥ã™ã‚‹



## ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
'use client

page.tsx

åŠ å·¥ã—ãŸãƒ‡ãƒ¼ã‚¿ãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹
shadcn/UIã‚’ä½¿ã£ã¦è¡¨ç¤ºã™ã‚‹ã€‚

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
ãƒœã‚¿ãƒ³ã‚„hooksãªã©ã§åˆ©ç”¨



## Storybook ãƒ•ã‚¡ã‚¤ãƒ« SFC3

***.stories.tsx



## ãƒ†ã‚¹ãƒˆ ãƒ•ã‚¡ã‚¤ãƒ«

***.test.tsx






----------------------------------------

#

<details><summary>ã‚³ãƒ©ãƒ  ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ¯ãƒ¼ã‚¯ã¨ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯</summary>

## ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ¯ãƒ¼ã‚¯ã¸æ”¹ç§°ã™ã‚‹ææ¡ˆ

**ç¾çŠ¶ï¼šãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã¨ã„ã†è¨€è‘‰ãŒæŒã¤èª¤è§£**

ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã¨ã„ã†è¨€è‘‰ã¯ã€ã€Œãƒªãƒ¢ã‚³ãƒ³ã€ç­‰ã‚’é€£æƒ³ã•ã›ã‚‹ãŸã‚ã€**é ãã‹ã‚‰é›¢ã‚ŒãŸå ´æ‰€ã‚’ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã™ã‚‹**ã¨ã„ã†ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒå¼·ã„ã§ã™ã€‚

**ææ¡ˆï¼šã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ¯ãƒ¼ã‚¯ã¨ã„ã†å‘¼ç§°ã®ãƒ¡ãƒªãƒƒãƒˆ**

* **å ´æ‰€ã®åˆ¶ç´„ã‚’æ˜ç¢ºã«ç¤ºã™:** ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã¨ã„ã†è¡¨ç¾ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆç’°å¢ƒã•ãˆã‚ã‚Œã°ã€ã©ã“ã‹ã‚‰ã§ã‚‚ä»•äº‹ãŒã§ãã‚‹ã¨ã„ã†**å ´æ‰€ã®è‡ªç”±åº¦**ã‚’æ˜ç¢ºã«ç¤ºã—ã¾ã™ã€‚
* **æŸ”è»Ÿãªåƒãæ–¹ã‚’å¼·èª¿:** æ™‚é–“ã‚„å ´æ‰€ã«ç¸›ã‚‰ã‚Œãªã„ã€**å¤šæ§˜ãªåƒãæ–¹**ã‚’å¯èƒ½ã«ã™ã‚‹ã¨ã„ã†ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å¼·èª¿ã§ãã¾ã™ã€‚
* **å›½éš›çš„ãªé€šç”¨æ€§:** è‹±èªã® "online work" ã¯ã€ä¸–ç•Œå…±é€šã§ç†è§£ã•ã‚Œã‚‹ãŸã‚ã€**ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªè¦–ç‚¹**ã«ã‚‚é©ã—ã¦ã„ã¾ã™ã€‚

**æ”¹ç§°ã«ã‚ˆã‚‹æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ**

* ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã¨ã„ã†è¨€è‘‰ãŒæŒã¤èª¤è§£ã‚’è§£æ¶ˆã—ã€**ã‚ˆã‚Šæ­£ç¢ºãªã‚¤ãƒ¡ãƒ¼ã‚¸**ã‚’æµ¸é€ã•ã›ã‚‹ã€‚
* **å¤šæ§˜ãªåƒãæ–¹ã¸ã®ç†è§£**ã‚’ä¿ƒé€²ã—ã€å°å…¥ã‚’å¾ŒæŠ¼ã—ã™ã‚‹ã€‚
* **ãƒ†ãƒ¬ãƒ¯ãƒ¼ã‚¯æ¨é€²æ³•**ãªã©ã®æ³•æ•´å‚™ã‚„ã€**ç¤¾ä¼šçš„ãªèªçŸ¥åº¦å‘ä¸Š**ã«è²¢çŒ®ã™ã‚‹ã€‚

**å…·ä½“çš„ãªæ”¹ç§°æ–¹æ³•**

* ä¼æ¥­ã‚„å›£ä½“ãŒç‡å…ˆã—ã¦ã€ç¤¾å†…æ–‡æ›¸ã‚„å¯¾å¤–çš„ãªæƒ…å ±ç™ºä¿¡ã«ãŠã„ã¦**ã€Œã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ¯ãƒ¼ã‚¯ã€**ã¨ã„ã†å‘¼ç§°ã‚’ä½¿ç”¨ã™ã‚‹ã€‚
* ãƒ¡ãƒ‡ã‚£ã‚¢ã‚„æ”¿åºœæ©Ÿé–¢ã‚‚ã€å ±é“ã‚„æ”¿ç­–ç«‹æ¡ˆã«ãŠã„ã¦**ã€Œã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ¯ãƒ¼ã‚¯ã€**ã¨ã„ã†å‘¼ç§°ã‚’ç©æ¥µçš„ã«ä½¿ç”¨ã™ã‚‹ã€‚
* ä¸€èˆ¬å¸‚æ°‘ã¸ã®å•“è’™æ´»å‹•ã‚’è¡Œã„ã€**ã€Œã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ¯ãƒ¼ã‚¯ã€**ã¨ã„ã†è¨€è‘‰ã‚’åºƒãèªçŸ¥ã•ã›ã‚‹ã€‚

**æ‡¸å¿µç‚¹ã¨å¯¾å¿œ**

* **æ—¢å­˜ã®ã€Œãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã€ã¨ã„ã†è¨€è‘‰ã¨ã®æ··åŒ**ï¼š
    * ã—ã°ã‚‰ãã®é–“ã¯ã€**ã€Œãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã€**ã¨**ã€Œã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ¯ãƒ¼ã‚¯ã€**ã®ä¸¡æ–¹ã®å‘¼ç§°ã‚’ä½¿ã„åˆ†ã‘ã€ä½µè¨˜ã™ã‚‹ã“ã¨ã§ã€æ··ä¹±ã‚’é¿ã‘ã‚‹ã€‚
* **ä¸€éƒ¨ã®äººã®æŠµæŠ—æ„Ÿ**ï¼š
    * **ã€Œã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ¯ãƒ¼ã‚¯ã€**ã®ãƒ¡ãƒªãƒƒãƒˆã‚’ä¸å¯§ã«èª¬æ˜ã—ã€ç†è§£ã‚’å¾—ã‚‹åŠªåŠ›ã‚’ã™ã‚‹ã€‚

**çµè«–**

ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ¯ãƒ¼ã‚¯ã¨æ”¹ç§°ã™ã‚‹ã“ã¨ã¯ã€**å ´æ‰€ã®åˆ¶ç´„ã‚’æ˜ç¢ºã«ç¤ºã—ã€æŸ”è»Ÿãªåƒãæ–¹ã‚’å¼·èª¿ã™ã‚‹**ã¨ã„ã†ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚Šã¾ã™ã€‚

**æ”¹ç§°ã«ã‚ˆã£ã¦ã€**å¤šæ§˜ãªåƒãæ–¹ã¸ã®ç†è§£**ã‚’ä¿ƒé€²ã—ã€**ç¤¾ä¼šå…¨ä½“ã«ãŠã‘ã‚‹åƒãæ–¹ã®å¤‰é©**ã‚’åŠ é€Ÿã•ã›ã‚‹ã“ã¨ãŒæœŸå¾…ã§ãã¾ã™ã€‚

**â€»** ä¸Šè¨˜ã¯ã‚ãã¾ã§ä¸€ä¾‹ã§ã‚ã‚Šã€å…·ä½“çš„ãªæ”¹ç§°æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€é–¢ä¿‚è€…é–“ã§è­°è«–ã‚’æ·±ã‚ã¦ã„ãå¿…è¦ãŒã‚ã‚‹ã“ã¨ã‚’ä»˜è¨˜ã—ã¾ã™ã€‚



</details>



##





##





----------------------------------------

# Zod

TypeScriptå‘ã‘ã®ã‚¹ã‚­ãƒ¼ãƒå®£è¨€ã¨ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã®ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚

ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ãŒæœŸå¾…é€šã‚Šã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€å‹å®‰å…¨ãªæ–¹æ³•ã§ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’å®šç¾©ã—ã€ãã‚Œã«åŸºã¥ã„ã¦ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œè¨¼ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```
pnpm add zod

```

## ç°¡å˜ãªç¢ºèª

é©å½“ãªå ´æ‰€ã«ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œã£ã¦
ãã“ã«ã€ğŸ‘‡Page.tsxã‚’ä½œã£ã¦ã€ãã®å ´æ‰€ã‚’é–‹ãã¾ã™ã€‚

```Page.tsx
import { z } from 'zod';

export default function Page() {
  const stringScheme = z.string();

  // 'apple'ãŒå‡ºåŠ›ã•ã‚Œã¾ã™ã€‚
  const result = stringScheme.parse('apple')
  console.log(result);

  // ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ã€‚
  const resultError = stringScheme.parse(true)
  console.log(resultError);

  return (
    <div>
      Zodãƒ†ã‚¹ãƒˆ
    </div>
  );
}

```



## ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ãªå‹

* z.string()ï¼šæ–‡å­—åˆ—
* z.number()ï¼šæ•°å€¤
* z.bigint()ï¼šbigintå‹
* z.boolean()ï¼šbooleanå‹
* z.date()ï¼šæ—¥ä»˜
* z.symbol()ï¼šã‚·ãƒ³ãƒœãƒ«
* z.undefined()ï¼šundefined
* z.null()ï¼šnull
* z.void()ï¼švoid
* z.any()ï¼šanyå‹
* z.unknown()ï¼šunknownå‹
* z.never()ï¼šneverå‹



## ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹

ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã®ã‚¹ã‚­ãƒ¼ãƒã‚’å®šç¾©ã™ã‚‹ã«ã¯ã€z.object()é–¢æ•°ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```
const User = z.object({
  name: z.string(),
  age: z.number(),
});

```



## TypeScriptã®å‹ã®ç”Ÿæˆ

Zodã¯ã€ã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰TypeScriptã®å‹ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```
 const FormData = z.object({
    name: z.string().min(2).max(50),
    age: z.number()
  });

  type FormDataType = z.infer<typeof FormData>;

```

ã“ã®ä¾‹ã§ã¯ã€FormDataã¨ã„ã†åå‰ã®ã‚¹ã‚­ãƒ¼ãƒã‚’å®šç¾©ã—ã€ãã®ä¸­ã«nameã¨ageã¨ã„ã†2ã¤ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å®šç¾©ã—ã¦ã„ã¾ã™ã€‚

nameãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯2æ–‡å­—ä»¥ä¸Š50æ–‡å­—ä»¥ä¸‹ã®æ–‡å­—åˆ—ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã€ageãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯æ•°å€¤å‹ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

z.inferå‹ã‚¬ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€FormDataã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰TypeScriptã®å‹ã§ã‚ã‚‹FormDataTypeã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚



----------------------------------------
----------------------------------------
----------------------------------------

# ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ (ãƒ‡ã‚¸ã‚¿ãƒ«åº)

ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½¿ã†ã‹ã©ã†ã‹ã¯å„è‡ªãŒåˆ¤æ–­ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚

ã“ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨ã¯åˆ¥ã®å ´æ‰€ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```terminal
git clone https://github.com/digital-go-jp/design-system-example-components .

pnpm i

pnpm run storybook

```



----------------------------------------

#

Nextra ç„¡æ–™ã§ç°¡å˜ã«ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’Markdownã§ç·¨é›†å‡ºæ¥ã‚‹é™çš„ã‚µã‚¤ãƒˆã‚’ä½œã‚‹ãƒ„ãƒ¼ãƒ« (ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç·¨) #Next.js - Qiita
https://qiita.com/masakinihirota/items/c9c80914b227a1716cdc

ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«æ›¸ã‹ã‚Œã¦ã„ã‚‹ã“ã¨ãŒå…¨ã¦æ­£ã—ãæœ€å„ªå…ˆã•ã‚Œã‚‹ã€‚



----------------------------------------
----------------------------------------
----------------------------------------


ã“ã‚Œã§ã€ã ã„ãŸã„ä¸€èˆ¬çš„ãªã‚µã‚¤ãƒˆã®åœŸå°ãŒä½œã‚Œã¾ã—ãŸã€‚

ã“ã®åœŸå°ã‹ã‚‰ã€è‡ªåˆ†ã®ã‚ªãƒªã‚¸ãƒŠãƒ«ã®ã‚³ãƒ¼ãƒ‰ã‚’åŸ‹ã‚ã¦ã„ãã¾ã™ã€‚


----------------------------------------
----------------------------------------
----------------------------------------

ä»¥ä¸‹ æœªå®Ÿè£…

----------------------------------------

# googleèªè¨¼ Slackèªè¨¼

googleèªè¨¼ã¨Slackèªè¨¼ã¯ã€GitHubèªè¨¼ã ã‘ã§ã¯è¶³ã‚Šãªã„å ´åˆè¿½åŠ ã—ã¾ã™ã€‚



Next.js + Supabase ã‚¢ãƒ—ãƒªã§ã‚µãƒ¼ãƒãƒ¼ã‚„ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã§ã€èªè¨¼ã«å¿…è¦ãª Client ID ã¨ Client secrets ã®å–å¾—ã€‚(Slackã€Googleã€GitHub) #GitHub - Qiita
https://qiita.com/masakinihirota/items/706326a64dab3ffbf55b

ãƒ­ãƒ¼ã‚«ãƒ«ã§GitHubèªè¨¼ãªã©ã‚’å‹•ã‹ã™ãŸã‚ã®
Supabaseè¨­å®šãƒ•ã‚¡ã‚¤ãƒ« config.toml

```supabase\config.toml

[auth.external.github]
enabled = true
client_id = "env(GITHUB_CLIENT_ID)"
secret = "env(GITHUB_SECRET)"
# Overrides the default auth redirectUrl.
redirect_uri = ""

[auth.external.google]
enabled = true
client_id = "env(GOOGLE_CLIENT_ID)"
secret = "env(GOOGLE_SECRET)"
# Overrides the default auth redirectUrl.
redirect_uri = ""

[auth.external.azure]
enabled = false
client_id = "env(AZURE_CLIENT_ID)"
secret = "env(AZURE_SECRET)"
url = "https://login.microsoftonline.com/f242226b-5204-4bb2-86ff-69e42c87814c"
# Overrides the default auth redirectUrl.
redirect_uri = ""

[auth.external.slack]
enabled = true
client_id = "env(SLACK_CLIENT_ID)"
secret = "env(SLACK_SECRET)"
# Overrides the default auth redirectUrl.
redirect_uri = ""

```


----------------------------------------

# GitHubèªè¨¼ ç„¡æ–™

Login with GitHub | Supabase Docs

https://supabase.com/docs/guides/auth/social-login/auth-github

GitHub ãƒ­ã‚°ã‚¤ãƒ³ã®è¨­å®šã¯ã€æ¬¡ã® 3 ã¤ã®éƒ¨åˆ†ã§æ§‹æˆã•ã‚Œã¾ã™ã€‚

1. GitHubä¸Šã§ GitHub OAuth ã‚¢ãƒ—ãƒªã‚’ä½œæˆãŠã‚ˆã³æ§‹æˆã™ã‚‹ã€‚
2. GitHub OAuth ã‚­ãƒ¼ã‚’Supabase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«è¿½åŠ ã—ã¾ã™ã€‚
3. ãƒ­ã‚°ã‚¤ãƒ³ ã‚³ãƒ¼ãƒ‰ã‚’Supabase JS ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ ã‚¢ãƒ—ãƒªã«è¿½åŠ ã—ã¾ã™ã€‚



ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ ãƒˆãƒ¼ã‚¯ãƒ³ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã¯æ„å›³çš„ã«ä¿å­˜ã•ã‚Œã¾ã›ã‚“ã€‚
ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ ãƒˆãƒ¼ã‚¯ãƒ³ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã¯æ„å›³çš„ã«ä¿å­˜ã•ã‚Œã¾ã›ã‚“ã€‚
ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ ãƒˆãƒ¼ã‚¯ãƒ³ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã¯æ„å›³çš„ã«ä¿å­˜ã•ã‚Œã¾ã›ã‚“ã€‚

OAuthãƒ•ãƒ­ãƒ¼ã‚’å®Œäº†ã—ãŸãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã®å¤–ã§ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä½¿ç”¨ã—ãŸã„å ´åˆã¯ã€
ç®¡ç†ä¸‹ã®å®‰å…¨ãªã‚µãƒ¼ãƒãƒ¼ã«ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ‰‹å‹•ã§é€ä¿¡ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚


â€»ãƒ­ãƒ¼ã‚«ãƒ«ã§ã“ã®è¨­å®šã¯ä½¿ãˆãªã„
ã‚ãã¾ã§ã‚‚Supabaseã®ã‚µãƒ¼ãƒãƒ¼ã®ã¿

## 1. GitHub Oauth ã‚¢ãƒ—ãƒªã‚’ä½œæˆã™ã‚‹

æœ€åˆã«Supabaseã§Calll backã®å€¤ã‚’å–å¾—ã—ã¾ã™ã€‚

Supabase ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã¸ç§»å‹•

Dashboard | Supabase
https://supabase.com/dashboard/projects

å·¦å´ã®ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®Authentication
Providersã‚’é¸æŠã€‚

GitHubã‚’é¸æŠ

GitHub enabled ãƒœã‚¿ãƒ³ã‚’ã‚ªãƒ³ã«ã—ã¾ã™ã€‚



è¨­å®šã—ã¾ã™ã€‚

Client ID
ã¾ã ç™»éŒ²ã—ã¾ã›ã‚“ã€‚

Client Secret
ã¾ã ç™»éŒ²ã—ã¾ã›ã‚“ã€‚

Callback URL (for OAuth) ï¼œï¼œå›ºå®š
https://vivxvupohephesnkxkxo.supabase.co/auth/v1/callback
https://vivxvupohephesnkxkxo.supabase.co/auth/v1/callback

â†‘ã“ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å–å¾—ã—ã¾ã™ã€‚
ãã—ã¦GitHubå´ã§ç™»éŒ²ã—ã¾ã™ã€‚



GitHubã¸ç§»å‹•ã—ã¾ã™ã€‚

masakinihirota (masakinihirota)
https://github.com/masakinihirota

GitHubã®å³ä¸Šã®å†™çœŸã‹ã‚‰ setting
ä¸€ç•ªä¸‹ã®Developer settings
OAuth Apps

å³ä¸Šå†™çœŸä¸‹ã®New OAuth Appãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚

ä½œæˆã—ã¾ã™ã€‚

Application name
vns.blue
vns.blue

masakinihirota
masakinihirota

Homepage URL
https://www.vns.blue/
https://www.vns.blue/

https://www.masakinihirota.com/
https://www.masakinihirota.com/

Application description
vns
vns
masakinihirota
masakinihirota

å–å¾—ã—ãŸCallback URL ã‚’ç™»éŒ²ã—ã¾ã™ã€‚
Authorization callback URL

masakinihirota
https://vivxvupohephesnkxkxo.supabase.co/auth/v1/callback
https://vivxvupohephesnkxkxo.supabase.co/auth/v1/callback

Register Buttonãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚



ç™»éŒ²ã™ã‚‹ã¨
vns.blueã®Client IDç­‰ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
or
masakinihirotaã®Client IDç­‰ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

Supabase ã«æˆ»ã£ã¦GitHubã§å–å¾—ã—ãŸå€¤ã‚’ç™»éŒ²ã—ã¾ã™ã€‚

GitHub
vns
vns
masakinihirota
masakinihirota

Client ID
****************

Client Secret (æºå¸¯èªè¨¼ãŒå¿…è¦)
****************



Callback URL (for OAuth)
vns.blueã¯ã©ã¡ã‚‰ã‹
	https://gzctqdrrnnkaxwwtzbsw.supabase.co/auth/v1/callback
	https://gzctqdrrnnkaxwwtzbsw.supabase.co/auth/v1/callback
or
	https://moymglaixrfalkqfifpq.supabase.co/auth/v1/callback
	https://moymglaixrfalkqfifpq.supabase.co/auth/v1/callback

masakinihirota
https://vivxvupohephesnkxkxo.supabase.co/auth/v1/callback
https://vivxvupohephesnkxkxo.supabase.co/auth/v1/callback

Saveãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚

ä»¥ä¸Šã§GitHubã¨Supabaseé–“ã®èªè¨¼ã®è¨­å®šãŒçµ‚ã‚ã‚Šã¾ã—ãŸã€‚

Supabaseã«GitHubã®æƒ…å ±ã‚’ç™»éŒ²ã—ã¾ã™ã€‚

Client ID
ã¨
Client Secret



# å®Ÿéš›ã«GitHubã§èªè¨¼ã‚’ã—ã¦ã¿ã‚‹

ä»•çµ„ã¿
ãƒ¦ãƒ¼ã‚¶ãŒã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ã™ã‚‹ã€‚
Supabaseã¯auth.usersãƒ†ãƒ¼ãƒ–ãƒ«ã«æ–°ã—ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã™ã‚‹ã€‚
Supabaseã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®UUIDã‚’å«ã‚€æ–°ã—ã„JWTã‚’è¿”ã™ã€‚
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®å…¨ã¦ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯JWTã‚’é€ä¿¡ã—ã¾ã™ã€‚
Postgresã¯JWTã‚’æ¤œæŸ»ã—ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã£ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç‰¹å®šã—ã¾ã™ã€‚
ãƒ¦ãƒ¼ã‚¶ã®UIDã¯ã€è¡Œã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’åˆ¶é™ã™ã‚‹ãƒãƒªã‚·ãƒ¼ã§ä½¿ç”¨ã§ãã¾ã™ã€‚
Supabaseã¯Postgresã®ç‰¹åˆ¥ãªé–¢æ•°ã€auth.uid()ã‚’æä¾›ã—ã€
JWTã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ã®UIDã‚’æŠ½å‡ºã—ã¾ã™ã€‚
ã“ã‚Œã¯ãƒãƒªã‚·ãƒ¼ã‚’ä½œæˆã™ã‚‹éš›ã«ç‰¹ã«ä¾¿åˆ©ã§ã™ã€‚



ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†
Supabaseã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’èªè¨¼ãƒ»ç®¡ç†ã™ã‚‹ãŸã‚ã®è¤‡æ•°ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’æä¾›ã—ã¾ã™ï¼š

ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—
ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ã‚µã‚¤ãƒ³ã‚¤ãƒ³
ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ¬ã‚¹/ãƒ¯ãƒ³ã‚¿ã‚¤ãƒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰(OTP)ã«ã‚ˆã‚‹ã‚µã‚¤ãƒ³ã‚¤ãƒ³
OAuthã«ã‚ˆã‚‹ã‚µã‚¤ãƒ³ã‚¤ãƒ³
ã‚µã‚¤ãƒ³ã‚¢ã‚¦ãƒˆ

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ã™ã‚‹ã¨ã€
Supabaseã¯ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªIDã‚’å‰²ã‚Šå½“ã¦ã¾ã™ã€‚

ã“ã®IDã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã©ã“ã‹ã‚‰ã§ã‚‚å‚ç…§ã§ãã¾ã™ã€‚
ä¾‹ãˆã°ã€user_idãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ä½¿ã£ã¦auth.usersãƒ†ãƒ¼ãƒ–ãƒ«ã®idã‚’
å‚ç…§ã™ã‚‹profilesãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

Redirect URLs | Supabase Docs

https://supabase.com/docs/guides/auth/concepts/redirect-urls#vercel-preview-urls

ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURL
Supabase Authã§ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURLã‚’è¨­å®šã™ã‚‹ã€‚



æ¦‚è¦

ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ¬ã‚¹ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã‚„ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ—ãƒ­ãƒã‚¤ãƒ€ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€
Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒ¡ã‚½ãƒƒãƒ‰ã«ã¯ã€
èªè¨¼å¾Œã«ãƒ¦ãƒ¼ã‚¶ã‚’ã©ã“ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã›ã‚‹ã‹ã‚’æŒ‡å®šã™ã‚‹
redirectToãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ã¯SITE_URLã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã¾ã™ãŒã€
SITE_URLã‚’å¤‰æ›´ã—ãŸã‚Šã€
ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆã®URLã‚’è¨±å¯ãƒªã‚¹ãƒˆã«è¿½åŠ ã—ãŸã‚Šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

å¿…è¦ãªURLã‚’è¨±å¯ãƒªã‚¹ãƒˆã«è¿½åŠ ã—ãŸã‚‰ã€
redirectToãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã›ãŸã„URLã‚’
æŒ‡å®šã—ã¾ã™ã€‚

ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURLã«ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã‚’ä½¿ã†ã€‚
Supabaseã§ã¯ã€
ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURLã‚’è¨±å¯ãƒªã‚¹ãƒˆã«è¿½åŠ ã™ã‚‹éš›ã«
ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

Netlifyã‚„Vercelã®ã‚ˆã†ãªãƒ—ãƒ­ãƒã‚¤ãƒ€ã‹ã‚‰ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼URLã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã«ã€
ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã®ãƒãƒƒãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ã†ã“ã¨ãŒã§ãã¾ã™ã€‚


----------------------------------------

# Googleèªè¨¼ ç„¡æ–™

Login with Google | Supabase Docs

https://supabase.com/docs/guides/auth/social-login/auth-google

Supabase ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ Google ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’æ§‹æˆã™ã‚‹ã€‚



## è¨­å®šé–‹å§‹

Enable Sign in with Google ã‚’ã‚ªãƒ³ã«ã—ã¾ã™ã€‚

Client ID (for OAuth)
*****

Client Secret (for OAuth)
*****

Authorized Client IDs (for Android, One Tap, and Chrome extensions)
*****

Skip nonce checks
iOSé–¢é€£ã‚‰ã—ã„ã®ã§ä»Šå›ã¯ç„¡è¦–ã—ã¾ã™ã€‚

Callback URL (for OAuth)
masakinihirota
https://vivxvupohephesnkxkxo.supabase.co/auth/v1/callback




## ã“ã“ã‹ã‚‰Googleå´ã®è¨­å®šã‚’èª¿ã¹ã¾ã™ã€‚

è©±é¡Œã®Supabaseã§ã‚µã‚¯ãƒƒã¨Googleèªè¨¼æ©Ÿèƒ½ã‚’ã¤ãã£ã¦ã¿ãŸï¼ - Qiita

https://qiita.com/kaho_eng/items/a37ff001ea9eae226183

GCP(Google Cloud Platform) ã§ã€Googleãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

https://cloud.google.com/

ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã‚’ã—ã¾ã™ã€‚

å³ä¸Šã®ã€Œã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã€ã‚’æŠ¼ã—ã¾ã™ã€‚
ç”»é¢é·ç§»å…ˆå·¦ä¸Šã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é¸æŠã‚’æŠ¼ã—ã¾ã™ã€‚
å³ä¸Šã®æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’æŠ¼ã—ã¾ã™ã€‚

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã¨å ´æ‰€ã‚’è¨­å®šã—ã¾ã™ã€‚

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå
masakinihirota

å ´æ‰€
çµ„ç¹”ãªã—

ä½œæˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚

ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ãƒ–ãƒ©ã‚¦ã‚¶ã®æœ€ä¸Šæ®µã«ä½œæˆã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåãŒã§ã¦ã„ã‚Œã°OKã§ã™ã€‚

APIã¨ã‚µãƒ¼ãƒ“ã‚¹
OAuthåŒæ„ç”»é¢
ã‚’é¸æŠã—ã¾ã™ã€‚

ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç¨®é¡ã€ã‚’é¸æŠã—ã¾ã™ã€‚
å¤–éƒ¨ã‚’é¸æŠã—ä½œæˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚



ã‚¢ãƒ—ãƒªç™»éŒ²ã®ç·¨é›† ç”»é¢ã«ãªã‚Šã¾ã™ã€‚

ã‚¢ãƒ—ãƒªå
vns.blue

masakinihirota

ãƒ¦ãƒ¼ã‚¶ãƒ¼ ã‚µãƒãƒ¼ãƒˆãƒ¡ãƒ¼ãƒ«
masakinihirota@gmail.com

ã‚¢ãƒ—ãƒªã®ãƒ­ã‚´
è¨­å®šã—ãªã„


ã‚¢ãƒ—ãƒªã®ãƒ‰ãƒ¡ã‚¤ãƒ³

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸
https://masakinihirota.com/

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ ãƒãƒªã‚·ãƒ¼ ãƒªãƒ³ã‚¯
è¨­å®šã—ãªã„

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ åˆ©ç”¨è¦ç´„ ãƒªãƒ³ã‚¯
è¨­å®šã—ãªã„

æ‰¿èªæ¸ˆã¿ãƒ‰ãƒ¡ã‚¤ãƒ³
masakinihirota.com

ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼ã®é€£çµ¡å…ˆæƒ…å ±
masakinihirota@gmail.com

ã€Œä¿å­˜ã—ã¦æ¬¡ã¸ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚

éæ©Ÿå¯†ã®ã‚¹ã‚³ãƒ¼ãƒ—
ç‰¹ã«è¨­å®šã—ã¾ã›ã‚“

æ©Ÿå¯†æ€§ã®é«˜ã„ã‚¹ã‚³ãƒ¼ãƒ—
ç‰¹ã«è¨­å®šã—ã¾ã›ã‚“

åˆ¶é™ä»˜ãã®ã‚¹ã‚³ãƒ¼ãƒ—
ç‰¹ã«è¨­å®šã—ã¾ã›ã‚“

ã€Œä¿å­˜ã—ã¦æ¬¡ã¸ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚



çœç•¥å¯èƒ½ãªæƒ…å ±
ç‰¹ã«è¨­å®šã—ã¾ã›ã‚“

ã€Œä¿å­˜ã—ã¦æ¬¡ã¸ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚



OAuth åŒæ„ç”»é¢
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç¨®é¡
å¤–éƒ¨

ã‚¢ãƒ—ãƒªå
masakinihirota

ã‚µãƒãƒ¼ãƒˆãƒ¡ãƒ¼ãƒ«
masakinihirota@gmail.com

ã‚¢ãƒ—ãƒªã®ãƒ­ã‚´
æŒ‡å®šã•ã‚Œã¦ã„ã¾ã›ã‚“

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ ãƒãƒªã‚·ãƒ¼ ãƒªãƒ³ã‚¯
è¨­å®šã—ãªã„

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ åˆ©ç”¨è¦ç´„ ãƒªãƒ³ã‚¯
è¨­å®šã—ãªã„

æ‰¿èªæ¸ˆã¿ãƒ‰ãƒ¡ã‚¤ãƒ³
masakinihirota.com

é€£çµ¡å…ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
masakinihirota@gmail.com

ã€Œãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«æˆ»ã‚‹ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚



å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®èªè¨¼æƒ…å ±ã‚’æŠ¼ã—ã¾ã™ã€‚

APIã‚­ãƒ¼
*****

OAuth2.0 ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ ID
ç·¨é›†ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚

åå‰
masakinihirota

æ‰¿èªæ¸ˆã¿ã® JavaScript ç”Ÿæˆå…ƒ
https://masakinihirota.com

æ‰¿èªæ¸ˆã¿ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ URIï¼œï¼œï¼œSupabaseã® Callback URL (for OAuth)
*****
ã‚’è¨­å®šã—ã¾ã™ã€‚

ã€Œä¿å­˜ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚

ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚¢ã‚¤ã‚³ãƒ³ã‚’æŠ¼ã™ã¨

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆID
*****

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ
*****

ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
Supabaseå´ã«è¨­å®šã—ã¾ã™ã€‚

Supabaseå´ã«æˆ»ã£ã¦
ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIDã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’ç™»éŒ²ã—ã¾ã™ã€‚

Supabaseå´ã§è¨­å®šã—ãŸã‚‰ ã€ŒSaveã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚



----------------------------------------

# Slackèªè¨¼ ç„¡æ–™

GitHubã¨ä¼¼ãŸã‚ˆã†ãªæ„Ÿã˜ã§ç™»éŒ²ã§ãã¾ã™ã€‚

Supabaseã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ Slackã®ãƒ­ã‚°ã‚¤ãƒ³
Login with Slack | Supabase Docs
https://supabase.com/docs/guides/auth/social-login/auth-slack


## Supabaseã® Slackã‚’é–‹ãã¾ã™ã€‚

å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®Authentication
Providers
Slack

Slack enabledã‚’ã‚ªãƒ³ã«ã—ã¾ã™ã€‚

Client ID
*****

Client Secret
*****

Callback URL (for OAuth)
*****



Slack é–‹ç™ºè€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’é–‹ãã¾ã™ã€‚
Slack API: Applications | Slack
https://api.slack.com/apps
ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€ã€ŒCreate an appã€ã‹ã‚‰æ–°ã—ãã‚¢ãƒ—ãƒªã‚’ä½œæˆã—ã¾ã™ã€‚

ãƒ–ãƒ©ã‚¦ã‚¶å†…ã«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒé–‹ãã¾ã™
ã‚¯ãƒªãƒƒã‚¯From scratch

ã‚¢ãƒ—ãƒªã®åå‰ã‚’å…¥åŠ›ã—ã¾ã™
masakinihirota

Pick a workspace to develop your app in:
ã©ã®ã‚¢ãƒ—ãƒªã«å…¥ã‚Œã‚‹ã‹ã‚’é¸æŠã—ã¾ã™ã€‚

ã€ŒCreate Appã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚

## App Credentials

Slackå·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®
Basic Informationãƒšãƒ¼ã‚¸

App Credentialsã®é …ç›®ã‹ã‚‰

App ID
[App ID]
[App ID]


Client ID
*****

Client Secret
*****

Signing Secret
*****

Verification Token
*****

https://api.slack.com/apps/[App ID]/oauth?
Slack å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®
OAuth & Permissions
ãƒšãƒ¼ã‚¸ã‚’é–‹ãã¾ã™ã€‚

Redirect URLï½“ã®é …ç›®ã‹ã‚‰
ã€ŒAdd New Redirect URLã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚

Supabaseã®Slackã®é …ç›®ã®
Callback URL (for OAuth)
https://*****.supabase.co/auth/v1/callback
https://*****.supabase.co/auth/v1/callback
ã‚’è²¼ã‚Šä»˜ã‘ã¾ã™ã€‚

ã€ŒSave URLsã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚


# Next.jså´ã®å®Ÿè£…

pnpm add @supabase/supabase-js @supabase/ui

/libsãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã€é…ä¸‹ã«supabaseClient.tsãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

supabaseClient.tsã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«è¨˜è¿°ã—ã€Clientã‚’åˆæœŸåŒ–ã—ã¾ã™ã€‚



## å‚è€ƒ

Supabase Authã§Slackèªè¨¼ã‚’è©¦ã—ã¦ã¿ãŸ | DevelopersIO

https://dev.classmethod.jp/articles/supbase-auth-slack/



----------------------------------------

# Middleware

è¤‡æ•°ã®Middlewareã‚’ä½œæˆã—ã¾ã™ã€‚

## Qiitaè¨˜äº‹

Next.js 14 App router Middlewareã‚’è¤‡æ•°ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ†å‰²ã™ã‚‹æ–¹æ³• #Next.js - Qiita

https://qiita.com/masakinihirota/items/c84daec1a48ee0a02199

Next.jsã§ã®åˆå¿ƒè€…å‘ã‘ Middleware.tså…¥é–€ (v13.1.0) ï¼‹ å…¬å¼ãƒãƒ‹ãƒ¥ã‚¢ãƒ« è§£èª¬ ï¼‹ è¤‡æ•°ã®Middlewareã®å®Ÿè£…æ–¹æ³• #Next.js - Qiita

https://qiita.com/masakinihirota/items/30a5e06e3288031b9788



## middleware.tsã®ä½œæˆ

middleware.ts ã¯srcç›´ä¸‹ã«ç§»å‹•ã•ã›ã¾ã™ã€‚



## ã‚ªãƒªã‚¸ãƒŠãƒ«ã®middleware.tsã®è§£èª¬

```middleware.ts
import { type NextRequest } from 'next/server';
import { updateSession } from '../src/utils/supabase/middleware';

export async function middleware(request: NextRequest) {
  return await updateSession(request);
}

export const config = {
  matcher: [
    /*
     * Match all request paths except:
     * - _next/static (static files)
     * - _next/image (image optimization files)
     * - favicon.ico (favicon file)
     * - images - .svg, .png, .jpg, .jpeg, .gif, .webp
     * Feel free to modify this pattern to include more paths.
     */
    '/((?!_next/static|_next/image|favicon.ico|.*\\.(?:svg|png|jpg|jpeg|gif|webp)$).*)'
  ]
};

```

AIã«ã‚³ãƒ¼ãƒ‰ã‚’ãƒšã‚¿ã£ã¨è²¼ã‚Šä»˜ã‘ã¦èã„ãŸã»ã†ãŒæ—©ãæ­£ç¢ºã ã¨æ€ã„ã¾ã™ãŒã€

updateSession(request);

â†‘ã“ã®é–¢æ•°ã¯ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’æ›´æ–°ã—ã¦ã€ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ãªã©ã‚’å¼¾ãåŠ¹æœãŒã‚ã‚Šã¾ã™ã€‚

configã®matcherè¨­å®šã¯ã€
ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®é¸åˆ¥ã‚’ã™ã‚‹æ©Ÿèƒ½ã«ãªã‚Šã¾ã™ã€‚

ã“ã®ä¾‹ã§ã¯ã€é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã€ç”»åƒä»¥å¤–ã¨ã„ã†è¨­å®šã«ãªã‚Šã¾ã™ã€‚
ã¤ã¾ã‚Šã€é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã€ç”»åƒä»¥å¤–ã®ã™ã¹ã¦ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã€ã“ã®Middlewareã§ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

æ­£è¦è¡¨ç¾ã‚’çŸ¥ã£ã¦ã„ã‚Œã°ç°¡å˜ã§ã™ã€‚


## Middlewareã«é©ã—ãŸæ©Ÿèƒ½

Middlewareã¯ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ä¸­é–“ã§å‡¦ç†ã‚’è¡Œã†é–¢æ•°ã§ã™ã€‚ãã®ãŸã‚ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚„ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å‡¦ç†ã™ã‚‹æ©Ÿèƒ½ã«é©ã—ã¦ã„ã¾ã™ã€‚

èªè¨¼ãƒã‚§ãƒƒã‚¯
ç”»åƒå‡¦ç†(åœ§ç¸®ã€ã‚µã‚¤ã‚ºå¤‰æ›´ ä»–)
ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ­ã‚®ãƒ³ã‚°
ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
ã‚­ãƒ£ãƒƒã‚·ãƒ¥åˆ¶å¾¡
ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
ãƒ‡ãƒ¼ã‚¿å¤‰æ›
å›½éš›åŒ–
ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡

ã“ã‚Œã‚’ï¼ˆå…¨éƒ¨å®Ÿè£…ã™ã‚‹ã¨ã¯é™ã‚Šã¾ã›ã‚“ãŒï¼‰1ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¾ã¨ã‚ã‚‹ã®ã¯
ã‚¹ãƒ‘ã‚²ãƒ†ã‚£ã‚³ãƒ¼ãƒ‰ã«ãªã‚‹ã®ã¯é–“é•ã„ãªã„ã®ã§ã€
æ©Ÿèƒ½å˜ä½ã§è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ†ã‘ã¾ã™ã€‚






## Middlewareã®åˆ†å‰²

ã‚ªãƒªã‚¸ãƒŠãƒ«ã®middleware.tsã‚’ã€
è¤‡æ•°ã®middleware.tsã«åˆ†å‰²ã—ã¾ã™ã€‚

ã¾ãš
middlewareãƒ•ã‚©ãƒ«ãƒ€ã‚’srcãƒ•ã‚©ãƒ«ãƒ€ã®ç›´ä¸‹ã«ä½œã‚Šã¾ã™ã€‚

```
mkdir src/middlewares

```



æ©Ÿèƒ½å˜ä½æ¯ã«Middlewareãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

```
touch src/middlewares/middleware1.ts
touch src/middlewares/middleware2.ts
touch src/middlewares/middleware3.ts

```



```src\middleware.ts
import { chain } from './middlewares/chain';
import { withMiddleware1 } from './middlewares/middleware1';
import { withMiddleware2 } from './middlewares/middleware2';
import { withMiddleware3 } from './middlewares/middleware3';

export default chain([withMiddleware1, withMiddleware2, withMiddleware3]);

// Rootã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã¿
// export const config = {
//   matcher: ['/'],
// };

// ç”»åƒã¨é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é™¤ãã™ã¹ã¦ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šï¼‰
export const config = {
  matcher: [
    /*
     * Match all request paths except:
     * - _next/static (static files)
     * - _next/image (image optimization files)
     * - favicon.ico (favicon file)
     * - images - .svg, .png, .jpg, .jpeg, .gif, .webp
     * Feel free to modify this pattern to include more paths.
     */
    '/((?!_next/static|_next/image|favicon.ico|.*\\.(?:svg|png|jpg|jpeg|gif|webp)$).*)',
  ],
};

```



```src\middlewares\chain.ts
import { NextMiddleware, NextResponse } from 'next/server';

type MiddlewareFactory = (middleware: NextMiddleware) => NextMiddleware;

export function chain(
  functions: MiddlewareFactory[],
  index = 0
): NextMiddleware {
  const current = functions[index];

  if (current) {
    const next = chain(functions, index + 1);
    return current(next);
  }

  return () => NextResponse.next();
}

```



```src\middlewares\middleware1.ts
import { createClient } from '@/utils/supabase/middleware';
import { NextMiddleware, NextRequest, NextFetchEvent } from 'next/server';

export function withMiddleware1(middleware: NextMiddleware) {
  return async (request: NextRequest, event: NextFetchEvent) => {
    console.log(
      'middleware1.ts: request.nextUrl.pathname',
      request.nextUrl.pathname
    );

    // createClienté–¢æ•°ã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã‚‹
    // ã“ã®ã‚³ãƒ¼ãƒ‰ã¯Middlewareä¸Šã§ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ãƒã‚§ãƒƒã‚¯ã‚’ã—ãŸã„ã ã‘ã§
    // requestã‚„eventã‚’ä½¿ã£ã¦ã„ãªã„ã®ã§ã€ãã®ã¾ã¾ä½¿ã£ã¦ã‚‚å•é¡Œãªã„ã¨æ€ã„ã¾ã™ã€‚
    // Middleware1 2 3 ã§requestå¤‰æ•°ã‚’ä½¿ã„ã¾ã‚ã—ã¦ã„ã‚‹ã€‚(ãƒã‚±ãƒ„ãƒªãƒ¬ãƒ¼ï¼Ÿ)
    const { supabase } = createClient(request);
    // const { supabase, response } = createClient(request);

    await supabase.auth.getUser();

    return middleware(request, event);
  };
}

```

middleware1.ts ã«ã¯ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æ›´æ–°æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚
ã“ã‚Œã¯ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã®ãƒªãƒã‚¸ãƒˆãƒªã§ã‚‚æ›´æ–°ãƒã‚§ãƒƒã‚¯ã‚’ã—ã¦ã„ã¾ã™ã€‚



```src\middlewares\middleware2.ts
import { NextMiddleware, NextRequest, NextFetchEvent } from 'next/server';

export function withMiddleware2(middleware: NextMiddleware) {
  return async (request: NextRequest, event: NextFetchEvent) => {
    const url = request.url;
    console.log('middleware2.ts: request.url', url);

    return middleware(request, event);
  };
}

```

console.log ã®å‡ºåŠ›ã¯é©å½“ã«æ±ºã‚ã¦ã„ã¾ã™ã€‚



```src\middlewares\middleware3.ts
import { NextMiddleware, NextRequest, NextFetchEvent } from 'next/server';

export function withMiddleware3(middleware: NextMiddleware) {
  return async (request: NextRequest, event: NextFetchEvent) => {
    const credentials = request.credentials;
    console.log('middleware3.ts: request.credentials', credentials);

    return middleware(request, event);
  };
}

```

console.log ã®å‡ºåŠ›ã¯é©å½“ã«æ±ºã‚ã¦ã„ã¾ã™ã€‚




Middlewareã®æ©Ÿèƒ½ã¯ã€ã‚ã¨ã§å¿…è¦ã«ãªã£ãŸã‚‰è¿½åŠ ã—ã¾ã™ã€‚

ç¾åœ¨ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ãƒã‚§ãƒƒã‚¯ã‚’middleware1ã§è¡Œã£ã¦ã„ã¾ã™ã€‚



----------------------------------------

#

å‹å®‰å…¨ã®ãƒ–ãƒ­ã‚°

TypeScript ã‚¢ãƒ—ãƒªã‚’å¼·åŒ–ã™ã‚‹: ã‚¿ã‚¤ãƒ—ã‚»ãƒ¼ãƒ•ãªç¿»è¨³ã®ãŸã‚ã® i18next ã‚’ãƒã‚¹ã‚¿ãƒ¼ã™ã‚‹
https://locize.com/blog/i18next-typescript/


----------------------------------------

# ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†

ã€Next.jsã€‘ç®¡ç†è€…ç”¨ãƒšãƒ¼ã‚¸ã‚’ Route Groups ã§å®Ÿç¾ã™ã‚‹
https://zenn.dev/chot/articles/next-layout-for-admin-page

ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚‚é–²è¦§å¯
/posts
/posts/:postId
/mypage

ç®¡ç†è€…ã®ã¿é–²è¦§å¯
/dashboard
/settings

ç®¡ç†è€…ã‹ã©ã†ã‹
ç®¡ç†è€…ã‹ã©ã†ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹ layout.tsx ã‚’
Route Groups ç›´ä¸‹ã«è¨­ç½®ã—ã¦ã€
ç®¡ç†è€…ãƒšãƒ¼ã‚¸ã«å¯¾å¿œã™ã‚‹ page.tsx ã‚’ãã® Group ã«é…ç½®ã™ã‚‹ã ã‘ã§ã™ã€‚



----------------------------------------

# ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³ã®è¨­å®š

Vercelã§ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è¨­å®šã™ã‚‹æ–¹æ³• | YoheiKoãƒ–ãƒ­ã‚°
https://yoheiko.com/blog/vercel%E3%81%A7%E3%81%AE%E7%8B%AC%E8%87%AA%E3%83%89%E3%83%A1%E3%82%A4%E3%83%B3%E8%A8%AD%E5%AE%9A/



----------------------------------------

## ãƒ•ã‚¡ãƒ“ã‚³ãƒ³

é–‹ç™ºã‚¢ãƒ—ãƒªã®ã‚¤ãƒ¡ãƒ¼ã‚¸è‰²

é’ç³»çµ±ã®è‰²ã«æ±ºã‚ã‚‹ã€‚

RGB	#
0		00
126		7E
254		FE

#007EFE
#007EFE
#007EFE

ãƒ•ã‚¡ãƒ“ã‚³ãƒ³ã‚’ä½œã‚Šæ›¸ãæ›ãˆã¾ã™ã€‚

src\app\favicon.ico



----------------------------------------

ãƒ•ã‚¡ã‚¤ãƒ«å‘½åè¦å‰‡

åŸºæœ¬Next.jsã«å¾“ã†

ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
***.server.tsx
ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
***.client.tsx

DBã‚¢ã‚¯ã‚»ã‚¹ã€ãƒ•ã‚§ãƒƒãƒã—ã¦ã„ã‚‹ã¨ã“ã‚ã¯
ãƒ•ã‚¡ã‚¤ãƒ«åã«ä»˜ã‘ã‚‹
å‡ºæ¥ã‚‹é™ã‚Šåˆ†é›¢ã™ã‚‹



å½¹å‰²
ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
ãƒ‡ãƒ¼ã‚¿å–å¾—
ãƒ‡ãƒ¼ã‚¿åŠ å·¥

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º

Server Componentã‚’ä¸Šæ‰‹ãåˆ†é›¢ã§ããªã„æ‚©ã¿ã‚’è§£æ¶ˆã—ãŸã„ (Next.js App Router)
https://zenn.dev/kokone/articles/d04c9529d1cb21
zustand






## é–‹ç™ºã‚’åŠ©ã‘ã‚‹ å¤–éƒ¨ã‚¢ãƒ—ãƒª&å¤–éƒ¨ãƒ„ãƒ¼ãƒ«

Windows
Chrome
Firefox Developer Edition
VSCode
PowerShell
Vercel
GitHub
GitHub Copilot
GitHub Copilot chat
Docker
Docker Desktop



## é–‹ç™ºã‚’åŠ©ã‘ã‚‹ å¤–éƒ¨ã‚¢ãƒ—ãƒª&å¤–éƒ¨ãƒ„ãƒ¼ãƒ« ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢é€£

pgAdmin 4
DBeaver
Postman

pgAdmin - PostgreSQL Tools

https://www.pgadmin.org/

DBeaver Community | Free Universal Database Tool

https://dbeaver.io/

Postman API Platform | Sign Up for Free

https://www.postman.com/



## å¤–éƒ¨ã¸ã®å…¬é–‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”¨

Nextra
ScreenToGif



Nextra ç„¡æ–™ã§ç°¡å˜ã«ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’Markdownã§ç·¨é›†å‡ºæ¥ã‚‹é™çš„ã‚µã‚¤ãƒˆã‚’ä½œã‚‹ãƒ„ãƒ¼ãƒ« (ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç·¨) #Next.js - Qiita

https://qiita.com/masakinihirota/items/c9c80914b227a1716cdc

ScreenToGif - ç”»é¢ã‚’éŒ²ç”»ã—ã€ç·¨é›†ã—ã¦ GIFã€ãƒ“ãƒ‡ã‚ªã€ã¾ãŸã¯ãã®ä»–ã®å½¢å¼ã§ä¿å­˜ã—ã¾ã™ã€‚

https://www.screentogif.com/



## typesync

typesyncãƒ„ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

typesyncã¯ã€TypeScriptã®å‹å®šç¾©ã‚’èª¿ã¹ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã‚Œã¾ã™ã€‚
package.jsonã‚’è¦‹ã¦è¶³ã‚Šãªã„å‹å®šç¾©ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒã‚ã‚Œã°è‡ªå‹•ã§è¿½åŠ ã—ã¦ãã‚Œã¾ã™ã€‚

```terminal
# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pnpm i -D typesync

# ä½¿ã„æ–¹
npx typesync

```

----------------------------------------

ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
ãƒªã‚¹ãƒˆã‚¢
ã‚’è¨ˆç”»ã™ã‚‹ã€‚

----------------------------------------

VNS #Qiita-Sync - Qiita

https://qiita.com/masakinihirota/items/b191c5c1e94a0c449fea
