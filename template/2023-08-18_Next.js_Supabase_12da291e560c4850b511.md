<!--
title:   Next.js 13 App router Supabase èªè¨¼æ©Ÿèƒ½ä»˜ã vnsé–‹ç™ºç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
tags:    Next.js,Supabase,template,ãƒ¡ãƒ¼ãƒ«èªè¨¼
id:      12da291e560c4850b511
private: false
-->

# TODO

vnsè¨­è¨ˆ
ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆ
SQLã®ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ

ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å–å¾—
Stripeã‚’å°å…¥ã™ã‚‹
DBã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¯GitHub Actionsã§è¡Œã†ã‚ˆã†ã«ã™ã‚‹



æ°—ã¥ã„ãŸå•é¡Œç‚¹

èªè¨¼æ¸ˆã¿ã®çŠ¶æ…‹ãªã®ã«ã€ã•ã‚‰ã«èªè¨¼ç”»é¢ãŒé–‹ã‘ã‚‹ã€
ãªã®ã§ã€èªè¨¼çŠ¶æ…‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã€èªè¨¼æ¸ˆã¿ãªã‚‰TOPãƒšãƒ¼ã‚¸ãªã‚Šã«é·ç§»ã•ã›ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚
middleware.tsx


å„ªå…ˆåº¦ä½ã„TODO
discode ã‚„ã€ãã‚Œä»¥å¤–ã®
authenticationã‚’å¢—ã‚„ã™



----------------------------------------

# é‡è¦ã‚³ãƒãƒ³ãƒ‰

å‹ã®ç”Ÿæˆ DB
npx supabase gen types typescript --project-id gzctqdrrnnkaxwwtzbsw > src/types/database.types.ts

Supabaseé–‹å§‹
supabase start
å¤‰æ›´ãŒä¿å­˜ã•ã‚Œã‚‹
supabase stop
å¤‰æ›´ãŒç ´æ£„ã•ã‚Œã‚‹ï¼ãƒªã‚»ãƒƒãƒˆ
supabase stop --no-backup 




----------------------------------------

ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

ã‚µãƒ¼ãƒãƒ¼ã¨ãƒ­ãƒ¼ã‚«ãƒ«ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ³
supabase migration list

Supabaseã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
ã‚µãƒ¼ãƒãƒ¼å´ã®é©ç”¨æ–¹æ³•

â†“REMOTEï¼ˆã‚µãƒ¼ãƒãƒ¼ï¼‰å´ã¸ã®é©ç”¨æ–¹æ³•
supabase migration repair 20230618024722 --status applied
supabase migration repair 20231017082823 --status applied



Supabaseã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
ãƒ­ãƒ¼ã‚«ãƒ«å´ã®å‰Šé™¤æ–¹æ³•
ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¶ˆã™ã ã‘

â†“REMOTEï¼ˆã‚µãƒ¼ãƒãƒ¼ï¼‰å´ã®å‰Šé™¤æ–¹æ³•
supabase migration repair 20231017052010 --status reverted
supabase migration repair 20231017082823 --status reverted



ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ãŸå ´åˆã¯
supabase db reset

ã‚‚ã—ãã¯



ç¢ºèª
supabase migration list

ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
ã‚¹ã‚­ãƒ¼ãƒã®ã¿
supabase db dump -f supabase/schema.sql

ãƒ‡ãƒ¼ã‚¿ã®ã¿
supabase db dump -f supabase/seed.sql --data-only
ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç®¡ç†ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚



----------------------------------------

Supabaseãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã® èªè¨¼

åˆæœŸè¨­å®šã®çŠ¶æ…‹ã§ã¯OAuthï¼ˆGoogle GitHub Slackï¼‰èªè¨¼ã‚ã‚Šã¾ã›ã‚“ã€‚
ãªã®ã§Supabaseã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚‚APIkeyãŒã‚ã‚Œã°è‡ªç”±ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ãŒ
OAuthèªè¨¼ã‚’è¨­å®šã—ãŸå ´åˆãƒ­ãƒ¼ã‚«ãƒ«ã§ã‚‚Oauthèªè¨¼ã®è¨­å®šã‚’ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
(ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒãªã®ã§OAuthèªè¨¼ã®ã©ã‚Œã‹ä¸€ã¤ã‚’æœ‰åŠ¹ã«ã™ã‚Œã°ã„ã„ã¨æ€ã„ã¾ã™ã€‚)

ãã®è¨­å®šæ–¹æ³•ã¯
TODO



----------------------------------------

# åˆã‚ã«

Next.js App routerã¨Supbaseã‚’åœŸå°ã«ã—ã¦ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œã‚Šã¾ã—ãŸã€‚

ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨ã¯ã€å®Ÿéš›ã«ã¯å…·ä½“çš„ãªæ©Ÿèƒ½ã‚’æŒãŸãšã€å¤šæ•°ã®ãƒ„ãƒ¼ãƒ«ã®é›†åˆä½“ã§ã™ã€‚
ãã‚Œãã‚Œã®ãƒ„ãƒ¼ãƒ«ã‚’çµ„ã¿åˆã‚ã›ãŸéš›ã®ä¸å…·åˆãªã©ã‚’ç¢ºèªã—ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã«å‹•ä½œç¢ºèªã®ãŸã‚ã®ã‚³ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚
ã“ã®è¨˜äº‹ã¯ã€ãã‚Œã‚‰ã®è¨˜éŒ²ã‚’ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚

ã“ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ãˆã°ã€ã€Œä½œã‚ŠãŸã„æ©Ÿèƒ½ã«é›†ä¸­ã§ãã‚‹ã€ã¿ãŸã„ãªæ„Ÿã˜ã§ä½œã‚Šã¾ã—ãŸã€‚

Next.js Supabase i18n ãƒ¡ãƒ¼ãƒ«èªè¨¼ ãƒ†ã‚¹ãƒˆ Storybook shadcn/ui



# ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ãƒªãƒã‚¸ãƒˆãƒª

masakinihirota/vns_template

https://github.com/masakinihirota/vns_template/tree/template

â†‘ãƒ–ãƒ©ãƒ³ãƒ templateãŒã“ã®è¨˜äº‹ã®å†…å®¹ã«ãªã‚Šã¾ã™ã€‚(ãƒ¡ãƒ¼ãƒ«èªè¨¼)

https://github.com/masakinihirota/vns_template/tree/dev

â†‘ãƒ–ãƒ©ãƒ³ãƒ devãŒã“ã®è¨˜äº‹ã®å†…å®¹ï¼‹ãƒ¡ãƒ¼ãƒ«èªè¨¼ï¼‹OAuthèªè¨¼ï¼‹shadcn/uiã«ãªã‚Šã¾ã™ã€‚
ã“ã®è¨˜äº‹ã«ã€ã“ã®éƒ¨åˆ†ã®è©³ç´°ã¯æ›¸ã‹ã‚Œã¦ã„ã¾ã›ã‚“ã€‚è¨˜äº‹ã‚’æ›¸ãçµ‚ã‚ã£ãŸå¾Œã«è¿½åŠ ã—ãŸæ©Ÿèƒ½ã«ãªã‚Šã¾ã™ã€‚



# Webé–‹ç™ºä¸­ã«æ°—ã‚’ã¤ã‘ã‚‹ã“ã¨

GitHubã«pushã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ãŒã€ãã®å‰ã«å¿…ãšãƒ“ãƒ«ãƒ‰ã‚’ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚
é–‹ç™ºä¸­ã¯ç°¡å˜ã«å£Šã‚Œã¦ã—ã¾ã†ã®ã§ã€çŸ­ã„é–“éš”ã§pushã‚’ã™ã‚‹ã‚ˆã†ã«ã‚‚ã—ã¦ã„ã¾ã™ã€‚
(huskyã‚’ä½¿ç”¨)



# ä½¿ç”¨ãƒ„ãƒ¼ãƒ«

## ãƒ¡ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ« é–‹ç™ºã«ä½¿ã†ã‚‚ã®

Next.js 13 App router ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
Supabae Postgres ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
i18next å›½éš›åŒ–
NextUI ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰
Storybook ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç®¡ç†



## è£œåŠ©ãƒ„ãƒ¼ãƒ« é–‹ç™ºã‚’åŠ©ã‘ã‚‹ã‚‚ã®

vitest ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º
Plop ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ã®è‡ªå‹•ç”Ÿæˆ
eslint æ•´å½¢
prettier æ•´å½¢
lint-staged ãƒã‚§ãƒƒã‚¯
huskey ãƒã‚§ãƒƒã‚¯

Windows
VSCode
GitHub
Vercel



## å¤–éƒ¨ã¸ã®å…¬é–‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”¨
Nextra

äºˆå®š
Sdhach

äºˆå®š
Sdhach


----------------------------------------

Next.jsã§ã¯åŸºæœ¬çš„ã«ã™ã¹ã¦é™çš„ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã¨ãªã‚Šã¾ã™ã€‚

â†“ã“ã®è¨­å®šã¯å‹•çš„ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’å¼·åˆ¶ã—ã¾ã™ã€‚
export const dynamic = "force-dynamic";

â†‘ã©ã“ã‹ã‚‰ã‚‚importã—ãªã„ã®ã¯ä¸æ€è­°ã§ã—ãŸãŒ
Next.jsã§ã®ç‰¹æ®Šãªè¨­å®šã®ä¸€ã¤ã®ã‚ˆã†ã§ã™ã€‚


----------------------------------------

Next.jsã®ãƒ˜ãƒƒãƒ€ãƒ¼ã¯
metadataã‚’åˆ©ç”¨ã—ã¦è¨­å®šã—ã¾ã™ã€‚
<head></head>ã‚¿ã‚°ã§å›²ã‚“ã§è¨­å®šã¯ã—ã¾ã›ã‚“ã€‚

----------------------------------------

# Next.jsã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

æ¨å¥¨ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

npx create-next-app -e with-supabase

Next.jsã®å…¬å¼ã‚µãƒ³ãƒ—ãƒ«ã®ä¸€ã¤ã§ã™ã€‚
â†“ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ãã®ã¾ã¾åˆ©ç”¨ã—ã¾ã™ã€‚

next.js/examples/with-supabase at canary Â· vercel/next.js

https://github.com/vercel/next.js/tree/canary/examples/with-supabase



å‹•ä½œç¢ºèª
npm run dev

ã“ã‚Œã§ã¯ã¾ã ã€ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã¯å‹•ãã¾ã›ã‚“ã€‚
Supabaseã®ç’°å¢ƒãƒ•ã‚¡ã‚¤ãƒ«ãŒå¿…è¦ã§ã™ã€‚

Supabaseã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã£ã¦ç’°å¢ƒå¤‰æ•°ã‚’å–å¾—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚



# ç’°å¢ƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚‹

â€»Supabaseã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆæ¸ˆã¿ã§ã€
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®šæƒ…å ±ã¯çŸ¥ã£ã¦ã„ã‚‹ã‚‚ã®ã¨ã—ã¾ã™ã€‚

touch .env.local

```.env.local
NEXT_PUBLIC_SUPABASE_URL=https://zhlmcrnnjbsfhbnctenz.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=ey***********************************74

```

.env.local.example
ã¯å‰Šé™¤ã—ã¾ã™ã€‚



å‹•ä½œç¢ºèª
npm run dev
npm run build
npm run start

â€»npm run devã§èµ·å‹•ã—ã¦ã„ã‚‹ã¨ã€npm run buildã¯ã‚¨ãƒ©ãƒ¼ã‚’å‡ºã—ã¦æ­¢ã¾ã£ã¦ã—ã¾ã†ã®ã§ã€
npm run devã¯åœæ­¢ã•ã›ã¦ã‹ã‚‰ npm run buildã‚’å®Ÿè¡Œã•ã›ã¦ãã ã•ã„





----------------------------------------

ãƒ­ãƒ¼ã‚«ãƒ«ã®Supabaseã®è¨­å®šã¯å®Œäº†ã—ãŸã®ã§

ã“ã“ã§ä¸€æ—¦Next.jsã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ä¸­æ–­ã—ã¦

Supabaseã®ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã‚’è¨­å®šã—ã¾ã™ã€‚



â†“Supabase å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã‚ã‚‹ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

Local Development | Supabase Docs

https://supabase.com/docs/guides/cli/local-development

Managing Environments | Supabase Docs

https://supabase.com/docs/guides/cli/managing-environments



# Supabaseã§ã® ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã®ä½œæˆ

ã‚µãƒ¼ãƒãƒ¼ã«Supabaseã®ã‚¹ã‚­ãƒ¼ãƒã€ãƒ†ãƒ¼ãƒ–ãƒ«ãªã©ãŒä½œã‚‰ã‚Œã¦ã„ã‚‹å ´åˆ
ãƒ­ãƒ¼ã‚«ãƒ«ã«ãã®ç’°å¢ƒã‚’å†ç¾ã—ã¾ã™ã€‚

supabase init

supabase login

supabase link --project-ref $PROJECT_ID

â†“$PROJECT_IDãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ URL ã‹ã‚‰å–å¾—ã§ãã¾ã™ã€‚

https://supabase.com/dashboard/project/<project-id>

ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰ã®å¤‰æ›´ãŒã‚ã‚‹å ´åˆã«å–ã‚Šå…¥ã‚Œã‚‹ã€‚
supabase db pull

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯
supabase/migrations/<timestamp>_remote_schema.sql
ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚
ç¾åœ¨ã‚ˆã‚Šä»¥å‰ã®å¤‰æ›´ãŒè¨˜éŒ²ã•ã‚Œã¾ã™ã€‚

git add .
git commit -m "init supabase"
supabase start

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½œæˆæ–¹æ³•

##  ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ã€ç›´æ¥ç·¨é›†ã™ã‚‹ã€‚

supabase migration new new_employee

supabase/migrations/<timestamp>_new_employee.sql
â†‘ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã‚‹ã®ã§ SQLæ–‡ã‚’è¨˜å…¥ã—ã¾ã™ã€‚

ä¾‹

```<timestamp>_new_employee.sql
create table public.employees (
  id integer primary key generated always as identity,
  name text
);

```

â†“ç·¨é›†ã—ãŸãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åæ˜ ã•ã›ã¾ã™ã€‚

supabase db reset

â€»ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯supabase/migrations ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚ã‚‹
ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã™ã¹ã¦åæ˜ ã•ã›ã¾ã™ã€‚

ã“ã‚Œã§æœ€æ–°ã®çŠ¶æ…‹ã«ãªã‚Šã¾ã—ãŸã€‚

Tips
ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚‹æ™‚
ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚ã¾ã™ã€‚
supabase migration new new_employee < create_employees_table.sql



## è‡ªå‹•ã§ã‚¹ã‚­ãƒ¼ãƒã®å·®åˆ†ã‚’å–å¾—

ãƒ­ãƒ¼ã‚«ãƒ«ã®Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰SQL Editorãªã©ã‚’ä½¿ã£ã¦ã‚¹ã‚­ãƒ¼ãƒã®å¤‰æ›´ã‚’ã—ã¦ã€
ãã®å¾Œã€â†“ã“ã®ã‚³ãƒãƒ³ãƒ‰ã§ãã®å·®åˆ†ã‚’å–ã‚‹æ–¹æ³•ã§ã™ã€‚

supabase db diff -f new_employee

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã§ã‚’å®Ÿè¡Œã™ã‚‹ã¨
supabase/migrations/<timestamp>_new_employee.sql

â†‘ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ãŒè‡ªå‹•ã§ä½œæˆã•ã‚Œã¾ã™ã€‚

â†“ä¸­èº«ã¯ã“ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```
-- This script was generated by the Schema Diff utility in pgAdmin 4
-- For the circular dependencies, the order in which Schema Diff writes the objects is not very sophisticated
-- and may require manual changes to the script to ensure changes are applied in the correct order.
-- Please report an issue for any failure with the reproduction steps.

CREATE TABLE IF NOT EXISTS public.employees
(
    id integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    name text COLLATE pg_catalog."default",
    CONSTRAINT employees_pkey PRIMARY KEY (id)
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS public.employees
    OWNER to postgres;

GRANT ALL ON TABLE public.employees TO anon;

GRANT ALL ON TABLE public.employees TO authenticated;

GRANT ALL ON TABLE public.employees TO postgres;

GRANT ALL ON TABLE public.employees TO service_role;

```

â€»è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¸­èº«ã¯ã€æ‰‹å‹•ã§æ›¸ã‹ã‚ŒãŸã‚‚ã®ã‚ˆã‚Šã‚‚å†—é•·ã«ãªã‚Šã¾ã™ã€‚
ã“ã‚Œã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚¹ã‚­ãƒ¼ãƒå·®åˆ†ãƒ„ãƒ¼ãƒ«ãŒã€åˆæœŸã‚¹ã‚­ãƒ¼ãƒã«ã‚ˆã£ã¦è¿½åŠ ã•ã‚ŒãŸãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ç‰¹æ¨©ã‚’è€ƒæ…®ã—ã¦ã„ãªã„ãŸã‚ã§ã™ã€‚


â€»åˆ¥ã®æ–¹æ³•ã¨ã—ã¦ã€--use-migra experimental ãƒ•ãƒ©ã‚°ã‚’æ¸¡ã™ã¨ã€ migra ã‚’ä½¿ã£ã¦ã‚ˆã‚Šç°¡æ½”ãªãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
f file ãƒ•ãƒ©ã‚°ã‚’æŒ‡å®šã—ãªã„ã¨ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯æ¨™æº–å‡ºåŠ›ã«å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚

supabase db diff --use-migra



----------------------------------------

# Deploy a migration

é‹ç”¨ç’°å¢ƒã§ã¯ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒã‚·ãƒ³ã‹ã‚‰ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã®ã§ã¯ãªãã€
CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã€
GitHubActionsã§æ–°ã—ã„ç§»è¡Œã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚



ã“ã®ä¾‹ã§ã¯ã€2ã¤ã®Supabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆ1ã¤ã¯æœ¬ç•ªç’°å¢ƒç”¨ã€
ã‚‚ã†1ã¤ã¯ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒç”¨ï¼‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

ä»¥ä¸‹ã®ã‚ˆã†ã«ç’°å¢ƒã‚’æº–å‚™ã—ã¦ãã ã•ã„ï¼š

ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç”¨ã¨æœ¬ç•ªç”¨ã«åˆ¥ã€…ã® Supabase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹ã€‚
git ãƒªãƒã‚¸ãƒˆãƒªã‚’ GitHub ã«ãƒ—ãƒƒã‚·ãƒ¥ã—ã€GitHub ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã€‚

æ³¨æ„

ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã«ã¯æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒå¿…è¦ã§ã™ã€‚
æœ¬ç•ªç”¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¹ã‚­ãƒ¼ãƒã‚’åæ˜ ã™ã‚‹ãŸã‚ã«æ—¢ã«å¤‰æ›´ã•ã‚ŒãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ
ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚


## Configure GitHub Actions

Supabase CLI ã‚’éã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œã™ã‚‹ã«ã¯ã€
ã„ãã¤ã‹ã®ç’°å¢ƒå¤‰æ•°ãŒå¿…è¦ã§ã™ã€‚

SUPABASE_ACCESS_TOKEN ã¯ã‚ãªãŸã®å€‹äººã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã§ã™ã€‚
SUPABASE_DB_PASSWORD ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ã™ã€‚
SUPABASE_PROJECT_ID ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®å‚ç…§æ–‡å­—åˆ—ã§ã™ã€‚
ã“ã‚Œã‚‰ã‚’æš—å·åŒ–ã—ãŸã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã¨ã—ã¦ GitHub Actions ãƒ©ãƒ³ãƒŠãƒ¼ã«
è¿½åŠ ã™ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚


Supabaseå…¬å¼ GitHub Actions ã‚½ãƒ¼ã‚¹

supabase-action-example/.github/workflows at main Â· supabase/supabase-action-example

https://github.com/supabase/supabase-action-example/tree/main/.github/workflows


Push Database Migration to Prod Using Github Actions - SupabaseTips - YouTube

https://www.youtube.com/watch?v=rOLyOsBR1Uc

GitHub ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã®ç™»éŒ²

GitHub ã®è‡ªåˆ†ã®ãƒªãƒã‚¸ãƒˆãƒªã§ ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«ã‚ã‚‹Settingsã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«ã‚ã‚‹
Security ï¼ Secrets ï¼ Actionsã‚’ã‚¯ãƒªãƒƒã‚¯

Action secrets ç”»é¢

å³ã«ã‚ã‚‹ç·‘ã®ãƒœã‚¿ãƒ³ã€ŒNew repository sceretã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆå€¤ã‚’ç™»éŒ²ã—ã¾ã™ã€‚

ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³
SUPABASE_ACCESS_TOKEN

Supabaseã®DBãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰
PRODUCTION_DB_PASSWORD

Reference ID (=project-id)
PRODUCTION_PROJECT_ID

ä»¥ä¸Šã§ ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆå€¤ã®è¨­å®šã¯å®Œäº†ã§ã™



.github/workflows ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ï¼š

```.github/workflows/ci.yml
name: CI

on:
  pull_request:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - uses: supabase/setup-cli@v1
        with:
          version: latest

      - name: Start Supabase local development setup
        run: supabase start

      - name: Verify generated types are checked in
        run: |
          supabase gen types typescript --local > types.gen.ts
          if ! git diff --ignore-space-at-eol --exit-code --quiet types.gen.ts; then
            echo "Detected uncommitted changes after build. See status below:"
            git diff
            exit 1
          fi

```



```.github/workflows/staging.yml
name: Deploy Migrations to Staging

on:
  push:
    branches:
      - develop
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest

    env:
      SUPABASE_ACCESS_TOKEN: ${{ secrets.SUPABASE_ACCESS_TOKEN }}
      SUPABASE_DB_PASSWORD: ${{ secrets.STAGING_DB_PASSWORD }}
      SUPABASE_PROJECT_ID: ${{ secrets.STAGING_PROJECT_ID }}

    steps:
      - uses: actions/checkout@v3

      - uses: supabase/setup-cli@v1
        with:
          version: latest

      - run: supabase link --project-ref $SUPABASE_PROJECT_ID
      - run: supabase db push

```



```.github/workflows/production.yml
name: Deploy Migrations to Production

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest

    env:
      SUPABASE_ACCESS_TOKEN: ${{ secrets.SUPABASE_ACCESS_TOKEN }}
      SUPABASE_DB_PASSWORD: ${{ secrets.PRODUCTION_DB_PASSWORD }}
      SUPABASE_PROJECT_ID: ${{ secrets.PRODUCTION_PROJECT_ID }}

    steps:
      - uses: actions/checkout@v3

      - uses: supabase/setup-cli@v1
        with:
          version: latest

      - run: supabase link --project-ref $SUPABASE_PROJECT_ID
      - run: supabase db push

```

â†‘è‡ªåˆ†ã®é–‹ç™ºç’°å¢ƒã«åˆã†ã‚ˆã†ã«è¨­å®šã‚’å¤‰æ›´ã—ã¾ã™ã€‚

â†‘GitHub Actionsã®è¨­å®šãŒçµ‚ã‚ã£ãŸã‚‰gitã§ã‚³ãƒŸãƒƒãƒˆã—ã¦ã€GitHubã«PUSHã™ã‚‹ã¨ã€
ã‚³ãƒãƒ³ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

â€»pushæ™‚ã«å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«è¨­å®šã—ãŸå ´åˆ



å®Œå…¨ãªã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã¯ãƒ‡ãƒ¢ãƒªãƒã‚¸ãƒˆãƒªã§å…¥æ‰‹ã§ãã¾ã™ã€‚
ã“ã‚Œã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’gitã«ã‚³ãƒŸãƒƒãƒˆã—ã€
GitHubã®ãƒ¡ã‚¤ãƒ³ãƒ–ãƒ©ãƒ³ãƒã«ãƒ—ãƒƒã‚·ãƒ¥ã—ã¾ã™ã€‚
Supabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ä¸€è‡´ã™ã‚‹ã‚ˆã†ã«æ¬¡ã®ç’°å¢ƒå¤‰æ•°ã‚’æ›´æ–°ã—ã¾ã™ã€‚

SUPABASE_ACCESS_TOKEN
PRODUCTION_PROJECT_ID
PRODUCTION_DB_PASSWORD
STAGING_PROJECT_ID
STAGING_DB_PASSWORD

æ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚Œã°ã€
ãƒªãƒã‚¸ãƒˆãƒªã«ã¯CIã¨Releaseãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒã‚ã‚Šã€
mainãƒ–ãƒ©ãƒ³ãƒã¨developãƒ–ãƒ©ãƒ³ãƒã«ãƒ—ãƒƒã‚·ãƒ¥ã•ã‚ŒãŸæ–°ã—ã„ã‚³ãƒŸãƒƒãƒˆã‚’
ãƒˆãƒªã‚¬ãƒ¼ã¨ã—ã¦å‹•ä½œã—ã¾ã™ã€‚



ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

æ–°ã—ã„ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³#ã§PRã‚’é–‹ã
ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ‰‹é †ã«å¾“ã£ã¦ã€
supabase/migrations/<timestamp>_new_employee.sql
ã‚’ä½œæˆã—ã¾ã™ã€‚

developã‹ã‚‰æ–°ã—ã„ãƒ–ãƒ©ãƒ³ãƒfeat/employeeã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã—ã€
ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒŸãƒƒãƒˆã—ã¦GitHubã«ãƒ—ãƒƒã‚·ãƒ¥ã—ã¾ã™ã€‚

```terminal
git checkout -b feat/employee
git add supabase/migrations/<timestamp>_new_employee.sql
git commit -m "Add employee table"
git push --set-upstream origin feat/employee

```

feat/employee ã‹ã‚‰ develop ãƒ–ãƒ©ãƒ³ãƒã« PR ã‚’ã‚ªãƒ¼ãƒ—ãƒ³ã—ã€CI ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒèµ·å‹•ã—ãŸã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼ãŒè§£æ±ºã—ãŸã‚‰ã€ã“ã® PR ã‚’ãƒãƒ¼ã‚¸ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã®ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚


production#ã¸ã®ãƒªãƒªãƒ¼ã‚¹
ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒæ­£å¸¸ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèªã—ãŸã‚‰ã€developã‹ã‚‰mainã¸åˆ¥ã®PRã‚’ä½œæˆã—ã€æœ¬ç•ªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¸ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ãŸã‚ã«ãƒãƒ¼ã‚¸ã—ã¾ã™ã€‚

ãƒªãƒªãƒ¼ã‚¹ã‚¸ãƒ§ãƒ–ã¯ã€supabase/migrationsãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒãƒ¼ã‚¸ã•ã‚ŒãŸã™ã¹ã¦ã®æ–°ã—ã„ç§»è¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ã€ãƒªãƒ³ã‚¯ã•ã‚ŒãŸSupaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«é©ç”¨ã—ã¾ã™ã€‚PROJECT_IDç’°å¢ƒå¤‰æ•°ã‚’ä½¿ã£ã¦ã€ã‚¸ãƒ§ãƒ–ãŒãƒªãƒ³ã‚¯ã™ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’åˆ¶å¾¡ã§ãã¾ã™ã€‚



# Troubleshooting
 Production project to staging# æ–°ã—ã„ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ãƒ»ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹ã¨ãã€æœ¬ç•ªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ä»¥å‰ã«é©ç”¨ã—ãŸãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨åˆæœŸã‚¹ã‚­ãƒ¼ãƒã‚’åŒæœŸã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

ã²ã¨ã¤ã®æ–¹æ³•ã¯ã€Release ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã™ï¼š

æ–°ã—ã„ãƒ–ãƒ©ãƒ³ãƒ develop ã‚’ä½œæˆã—ã€ãƒ–ãƒ©ãƒ³ãƒã‚½ãƒ¼ã‚¹ã« main ã‚’é¸æŠã—ã¾ã™ã€‚develop ãƒ–ãƒ©ãƒ³ãƒã‚’ GitHub ã«ãƒ—ãƒƒã‚·ãƒ¥ã—ã¾ã™ã€‚GitHub ã® Actions ãƒ©ãƒ³ãƒŠãƒ¼ãŒã€æ—¢å­˜ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚

ã‚ã‚‹ã„ã¯ã€ãƒ­ãƒ¼ã‚«ãƒ«ã® CLI ã‚’ä½¿ã£ã¦ã€ãƒªãƒ³ã‚¯ã•ã‚ŒãŸãƒªãƒ¢ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é©ç”¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚



supabase db push


ãƒ—ãƒƒã‚·ãƒ¥ã—ãŸã‚‰ã€ãƒ­ãƒ¼ã‚«ãƒ«ã¨ãƒªãƒ¢ãƒ¼ãƒˆã®ä¸¡æ–¹ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§ç§»è¡Œãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒæœ€æ–°ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚

supabase migration list



# db pullã§ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ãŒæ‹’å¦ã•ã‚Œã¾ã—ãŸ

Supabaseãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é•·ãä½¿ã£ã¦ã„ã‚‹ã¨ã€db pullã‚’å®Ÿè¡Œã™ã‚‹éš›ã«ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ã«é­é‡ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚


```terminal
Error: Error running pg_dump on remote database: pg_dump: error: query failed: ERROR:  permission denied for table _type

pg_dump: error: query was: LOCK TABLE "graphql"."_type" IN ACCESS SHARE MODE

```

ã“ã®ã‚¨ãƒ©ãƒ¼ã‚’è§£æ±ºã™ã‚‹ã«ã¯ã€graphqlã‚¹ã‚­ãƒ¼ãƒã«postgresã®ãƒ­ãƒ¼ãƒ«ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’ä¸ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãã®ãŸã‚ã«ã¯ã€Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®SQLã‚¨ãƒ‡ã‚£ã‚¿ã‹ã‚‰ä»¥ä¸‹ã®ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚



```terminal
grant all on all tables in schema graphql to postgres, anon, authenticated, service_role;
grant all on all functions in schema graphql to postgres, anon, authenticated, service_role;
grant all on all sequences in schema graphql to postgres, anon, authenticated, service_role;

```



# db push# ã§ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ãŒæ‹’å¦ã•ã‚ŒãŸ

Supabase ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã€æ–°ã—ã„ç§»è¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆã« ALTER TABLE ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã€ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã¾ãŸã¯æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«é©ç”¨ã™ã‚‹ã¨ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

```terminal
ERROR: must be owner of table employees (SQLSTATE 42501); while executing migration <timestamp>

```



ã“ã‚Œã¯ã€Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ä½œæˆã•ã‚ŒãŸãƒ†ãƒ¼ãƒ–ãƒ«ã¯supabase_adminãƒ­ãƒ¼ãƒ«ãŒæ‰€æœ‰ã—ã€CLIã§å®Ÿè¡Œã•ã‚Œã‚‹ç§»è¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯postgresãƒ­ãƒ¼ãƒ«ãŒæ‰€æœ‰ã™ã‚‹ãŸã‚ã§ã™ã€‚

ã“ã‚Œã‚’è§£æ±ºã™ã‚‹ä¸€ã¤ã®æ–¹æ³•ã¯ã€ã“ã‚Œã‚‰ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ‰€æœ‰è€…ã‚’postgresãƒ­ãƒ¼ãƒ«ã«å†å‰²ã‚Šå½“ã¦ã™ã‚‹ã“ã¨ã§ã™ã€‚
ä¾‹ãˆã°ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®åå‰ãŒpublicã‚¹ã‚­ãƒ¼ãƒã®usersã§ã‚ã‚‹å ´åˆã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦æ‰€æœ‰è€…ã‚’å†å‰²ã‚Šå½“ã¦ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚



```terminal
ALTER TABLE users OWNER TO postgres;

```

ãƒ†ãƒ¼ãƒ–ãƒ«ä»¥å¤–ã«ã‚‚ã€å‹ã€é–¢æ•°ã€ã‚¹ã‚­ãƒ¼ãƒãªã©ã€ãã‚Œãã‚Œã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ä»–ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®æ‰€æœ‰è€…ã‚’å†å‰²ã‚Šå½“ã¦ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚



# æ–°ã—ã„ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒªãƒ™ãƒ¼ã‚¹ã™ã‚‹

ãƒãƒ¼ãƒ ãƒ¡ã‚¤ãƒˆãŒæ–°ã—ã„ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ git ãƒ¡ã‚¤ãƒ³ãƒ–ãƒ©ãƒ³ãƒã«ãƒãƒ¼ã‚¸ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

å¤ã„ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®åå‰ã‚’æ–°ã—ã„ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã§å¤‰æ›´ã™ã‚‹ã“ã¨ã§ã€ã“ã®ã‚·ãƒŠãƒªã‚ªã‚’ã†ã¾ãå‡¦ç†ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```terminal
git pull
supabase migration new dev_A
# Assume the new file is: supabase/migrations/<t+2>_dev_A.sql
mv <time>_dev_A.sql <t+2>_dev_A.sql
supabase db reset

```



ãƒªã‚»ãƒƒãƒˆã«å¤±æ•—ã—ãŸå ´åˆã¯ã€<t+2>_dev_A.sqlãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã™ã‚‹ã“ã¨ã§ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã‚’æ‰‹å‹•ã§è§£æ±ºã§ãã¾ã™ã€‚

ãƒ­ãƒ¼ã‚«ãƒ«ã§æ¤œè¨¼ã—ãŸã‚‰ã€å¤‰æ›´ã‚’Gitã«ã‚³ãƒŸãƒƒãƒˆã—ã¦GitHubã«ãƒ—ãƒƒã‚·ãƒ¥ã—ã¾ã™ã€‚


















â€»Supabaseã®ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã®è¨­å®šã¯ã“ã“ã§çµ‚äº†ã§ã™ã€‚



----------------------------------------

# GitHubã¸ã® PUSH ã¨ Vercelã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ ï¼‹ ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³

æ¬¡ã¯GitHubã®ãƒªãƒã‚¸ãƒˆãƒªã‚’Vercelã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚

Next.js âœ–ï¸ Supabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®Vercelã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ¢

https://zenn.dev/shgs/articles/6b7fde20a6a596



## GitHub ã¸ã®PUSH

GitHubã¸ã¯VSCodeã®æ©Ÿèƒ½ ã‚½ãƒ¼ã‚¹ç®¡ç†ã§ç°¡å˜ã«ãƒªãƒã‚¸ãƒˆãƒªãŒä½œæˆã•ã‚Œã€PUSHå‡ºæ¥ã¾ã—ãŸã€‚



## Vercel ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤

Vercelã¸GitHubã«ä½œã£ãŸãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚

https://vercel.com/

å³ä¸Šã® Add Newãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦
Projectã‚’é¸æŠã—ã¾ã™ã€‚

å…ˆç¨‹ä½œã£ãŸãƒªãƒã‚¸ãƒˆãƒªã‚’é¸ã³ Importãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚


Supabaseã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã®ã§
Environment Variablesã‚’è¨­å®šã—ã¾ã™ã€‚


NEXT_PUBLIC_SUPABASE_ANON_KEY="eyJh*************************X8"
NEXT_PUBLIC_SUPABASE_URL="https://gzctqdrrnnkaxwwtzbsw.supabase.co"

ç’°å¢ƒå¤‰æ•°ã‚’å…¥åŠ›ã—ãŸã‚‰ Add ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ä¸€ã¤ã¥ã¤ç™»éŒ²ã—ã¦ã„ãã¾ã™ã€‚

ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ã€ãƒ“ãƒ«ãƒ‰ãŒå®Œäº†ã™ã‚‹ã¾ã§ã—ã°ã‚‰ãå¾…ã¡ã¾ã™ã€‚


Congratulationsã¨è¡¨ç¤ºã•ã‚ŒãŸã‚‰æˆåŠŸã§ã™ã€‚



----------------------------------------

## ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³ã®è¨­å®š

Vercelã§ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è¨­å®šã™ã‚‹æ–¹æ³• | YoheiKoãƒ–ãƒ­ã‚°
https://yoheiko.com/blog/vercel%E3%81%A7%E3%81%AE%E7%8B%AC%E8%87%AA%E3%83%89%E3%83%A1%E3%82%A4%E3%83%B3%E8%A8%AD%E5%AE%9A/



----------------------------------------

# Vercelä¸Šã§Supabaseã¨é€£æºã™ã‚‹

Integrationsã«è¡Œã

é€£æºã™ã‚‹Supabaseã‚’æ¢ã—ã¾ã™ã€‚

Vercel | Works With Supabase
https://supabase.com/partners/integrations/vercel

ã“ã‚Œã§Supabaseã®ç’°å¢ƒå¤‰æ•°ãªã©ã¯è‡ªå‹•çš„ã«å–å¾—ã•ã‚Œã¾ã™ã€‚


ãƒ­ãƒ¼ã‚«ãƒ«ã«VercelãŒå–å¾—ã—ãŸç’°å¢ƒå¤‰æ•°ã‚’å–å¾—ã—ã¾ã™ã€‚

ãƒ­ãƒ¼ã‚«ãƒ«ã§Vercelã¸ã®ãƒ­ã‚°ã‚¤ãƒ³
npx vercel login
	GitHubã‚’é¸æŠã—ã¾ã™ã€‚



ãƒ­ãƒ¼ã‚«ãƒ«ä¸Šã‹ã‚‰Vercelã¨ãƒªãƒ³ã‚¯ã™ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é¸æŠ
npx vercel link
	ãƒªãƒ³ã‚¯ã™ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠã—ã¾ã™ã€‚



ç’°å¢ƒå¤‰æ•°ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã«å–å¾—ã—ã¾ã™ã€‚
npx vercel env pull
	.env.localã«å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚
	.gitignoreã«å…¥ã‚Œã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯è¨˜å…¥ã•ã‚Œã¦ã„ã¾ã™ã€‚ï¼‰

ã™ã§ã«.env.localãŒã‚ã‚‹å ´åˆã¯å‰Šé™¤ã—ã¦ã‹ã‚‰ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨å†ç”Ÿæˆã•ã‚Œã¾ã™ã€‚



ã“ã‚Œã§ãƒ­ãƒ¼ã‚«ãƒ«ã§é–‹ç™ºã‚’è¡Œã„ã€‚
GitHubã¸PUSHã™ã‚‹ã¨
è‡ªå‹•çš„ã«Vercelã¸ãƒ‡ãƒ—ãƒ­ã‚¤ãŒèµ°ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

ç’°å¢ƒã¯ã€é–‹ç™ºä¸­ã§ã™ã¨ç°¡å˜ã«å£Šã‚Œã‚‹ã®ã§éšæ™‚ã€Œæ³¨è¦–ã€ãŒå¿…è¦ã§ã™ã€‚



----------------------------------------



# srcãƒ•ã‚©ãƒ«ãƒ€ã®ä½œæˆ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ç§»å‹•

mkdir src

srcã®ä¸‹ã«appãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨componentsãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ç§»å‹•ã—ã¾ã™ã€‚


tsconfig.jsonãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€éƒ¨å¤‰æ›´

```tsconfig.json
    "paths": {
      "@/*": ["./src/*"]
    }

```




tailwind.config.jsãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€éƒ¨å¤‰æ›´

```tailwind.config.js
  content: [
    "./src/pages/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/components/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/app/**/*.{js,ts,jsx,tsx,mdx}",
  ],
  darkMode: "media",
  theme: {
ã€‚ã€‚ã€‚

```

â€»src/pages ã¯Next.jsã®pages dirã‚’ä½¿ã£ã¦ã„ãŸã¨ãã®åæ®‹ã§ã™ã€‚
Next.js 13 ã¯ pages dir ã¨ app dir ã®ä¸¡æ–¹ã‚’åŒæ™‚ã«ä½¿ãˆã‚‹ã®ã§æ®‹ã—ã¦ãŠãã¾ã™ã€‚

darkMode: "media",ã‚’è¿½åŠ ã—ã¾ã™ã€‚



mkdir src/styles

src\app\globals.css
ã‚’
src\styles\globals.css
ã¸ç§»å‹•ã—ã¾ã™ã€‚


ãƒ‘ã‚¹ã®ä¿®æ­£ã‚’ã—ã¾ã™ã€‚

```src\app\layout.tsx
import "@/styles/globals.css"

```



src\styles\globals.csså†…å®¹ã®ä¿®æ­£

```src\styles\globals.css
@tailwind base;
@tailwind components;
@tailwind utilities;

```

src\app\layout.tsx ãƒ‘ã‚¹ã®ä¿®æ­£

```
import "@/styles/globals.css";

```



package.jsonãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€éƒ¨å¤‰æ›´

```package.json
  "name": "vns.blue",
  "version": "0.1.0",

```

â€»åå‰ã¯è‡ªç”±ã«ã¤ã‘ã¦ãã ã•ã„ã€‚



# eslintã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

npm i eslint eslint-config-next


touch .eslintrc.json

.eslintrc.json(åˆæœŸ)

```.eslintrc.json
{
  "extends": "next/core-web-vitals"
}

```



## tsconfig.json

TypeScriptã‚’é–‹ç™ºã—ã‚„ã™ãã™ã‚‹

```tsconfig.json (å¤‰æ›´ç®‡æ‰€)
    "strict": false,
    "strictNullChecks": true,

```



"strict": false ã¯ã€ä»¥ä¸‹ã®è¨­å®šã‚’ç„¡åŠ¹ã«ã—ã¾ã™ã€‚

"noImplicitAny": trueï¼šæš—é»™çš„ã«anyå‹ã¨ã—ã¦è§£é‡ˆã•ã‚Œã‚‹å¼ã‚’è¨±å¯ã—ã¾ã›ã‚“ã€‚
"strictNullChecks": trueï¼šnullã¨undefinedã®æ‰±ã„ã«é–¢ã™ã‚‹å³å¯†ãªå‹ãƒã‚§ãƒƒã‚¯ã‚’æœ‰åŠ¹ã«ã—ã¾ã™ã€‚
"strictFunctionTypes": trueï¼šé–¢æ•°ã®å‹ãƒã‚§ãƒƒã‚¯ã‚’å³å¯†ã«è¡Œã„ã¾ã™ã€‚
"strictPropertyInitialization": trueï¼šã‚¯ãƒ©ã‚¹ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®åˆæœŸåŒ–ã‚’å³å¯†ã«è¡Œã„ã¾ã™ã€‚
"noImplicitThis": trueï¼šthisã®å‹ãƒã‚§ãƒƒã‚¯ã‚’å³å¯†ã«è¡Œã„ã¾ã™ã€‚

â†‘ã“ã®ï¼•ã¤ã®ã†ã¡

"strictNullChecks"ã ã‘æœ‰åŠ¹ã«ã—ã¾ã™ã€‚


å‹•ä½œç¢ºèª

npm run dev



----------------------------------------

# i18n

i18n with Next.js 13 and app directory / App Router (an i18next guide)

https://locize.com/blog/next-13-app-dir-i18n/

â†‘ã“ã®Blogã‚’å‚è€ƒã«â†“ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆã—ã¾ã—ãŸã€‚

masakinihirota/i18n

https://github.com/masakinihirota/i18n

i18nã‚µãƒ³ãƒ—ãƒ«(2023src\__vns\lab\nexti18n)ã®
(ã“ã‚Œã¯i18nextã®å…¬å¼Blogã‚µãƒ³ãƒ—ãƒ«ã‚’æµç”¨ã—ãŸã‚‚ã®ã§ã™ã€‚)
src\app\[lng]\ ä»¥ä¸‹
src\app\i18n\ ä»¥ä¸‹
ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚



ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm i accept-language i18next i18next-browser-languagedetector i18next-resources-to-backend react-cookie react-i18next



å‹•ä½œç¢ºèª
npm run dev
npm run build
npm run start



----------------------------------------

# Layout


```src\app\layout.tsx
import "@/styles/globals.css";

import { Metadata } from "next";

// Next.jsã§ã¯metadataã‚’ä½¿ã£ã¦ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®šã—ã¾ã™ã€‚
export const metadata: Metadata = {
  title: "VNS.BLUE",
  description: "VNS.BLUE",
  keywords: "VNS.BLUE, ã‚ªã‚¢ã‚·ã‚¹å®£è¨€",
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <body>
        {/* â†“ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã«å½±éŸ¿ã‚’ä¸ãˆã¦ã„ã‚‹ */}
        <main className="flex flex-col items-center min-h-screen bg-background">
          {children}
        </main>
      </body>
    </html>
  );
}

```

å‹•ä½œç¢ºèª
npm run dev
npm run build
npm run start



```src\app\page.tsx
import { createServerComponentClient } from "@supabase/auth-helpers-nextjs";
import { cookies } from "next/headers";
import Link from "next/link";
import LogoutButton from "../components/LogoutButton";

export const dynamic = "force-dynamic";

export default async function Index() {
  const supabase = createServerComponentClient({ cookies });

  const {
    data: { user },
  } = await supabase.auth.getUser();

  return (
    // å…¨ä½“ã‚’ç¸¦ã«ãªã‚‰ã¹ã¦ã„ã‚‹ã€å¹…ã„ã£ã±ã„ã«ä¸¦ã¹ã¦ã„ã‚‹
    <div className="flex flex-col items-center w-full">
      {/* navéƒ¨åˆ† Home ,Advertisement, Dark mode,Language, Login */}
      {/* ãƒŠãƒ“éƒ¨åˆ†ã®é«˜ã•ã‚’æ±ºã‚ã¦ã„ã‚‹ã€ãƒœãƒ¼ãƒ€ãƒ¼ãƒ©ã‚¤ãƒ³ãƒœãƒˆãƒ ã‚’æã„ã¦ã„ã‚‹ ãƒœãƒ¼ãƒ€ãƒ¼è‰²ã¯ç¾åœ¨ã®æ–‡å­—è‰²
      ãƒŠãƒ“éƒ¨åˆ†ã¨ãƒ¡ã‚¤ãƒ³éƒ¨åˆ†ã®åˆ†é›¢ç®‡æ‰€ */}
      <nav className="flex justify-center w-full h-16 border-b border-current">
        {/* ãƒŠãƒ“éƒ¨åˆ† ä¸Šä¸‹ä¸­å¤®ã«æƒãˆã¦ã„ã‚‹ æ¨ªã«å‡ç­‰ã«ãªã‚‰ã¹ã¦ã„ã‚‹ å¹…ã„ã£ã±ã„ã«ä½¿ã£ã¦ã„ã‚‹ */}
        <div className="flex items-center justify-between w-full">
          VNS.BLUE
          <div />
          Dark mode
          <div />
          Language
          <div />
          Advertisement
          <div>
            {user ? (
              <div className="flex items-center gap-4">
                Hey, {user.email}!
                <LogoutButton />
              </div>
            ) : (
              <Link
                href="/login"
                className="px-4 py-2 no-underline rounded-md bg-btn-background hover:bg-btn-background-hover"
              >
                Login
              </Link>
            )}
          </div>
        </div>
      </nav>
      <main className="flex flex-col w-full max-w-4xl p-3 text-xl text-foreground">
        <Link href="./examples/client-component">Client Component Example</Link>
        <Link href="./examples/route-handler">Route Handler Example</Link>
        <Link href="./examples/server-action">Server Action Example</Link>
        <Link href="./examples/server-component">Server Component Example</Link>
        <br />
        {/* <Link href={`/${lng}/login`}></Link> */}
        <Link href={`/en`}>è‹±èª</Link>
        <Link href="/de">ãƒ‰ã‚¤ãƒ„èª</Link>
        <Link href="/ja">æ—¥æœ¬èª</Link>
      </main>
      <div />
      <footer className="flex items-center justify-center h-16">
        VNS.BLUE 2023
      </footer>
    </div>
  );
}

```



```src\app\[lng]\layout.js
import { dir } from "i18next";
import { languages } from "../i18n/settings";

export async function generateStaticParams() {
  return languages.map((lng) => ({ lng }));
}

export default function RootLayout({ children, params: { lng } }) {
  return (
    <div lang={lng} dir={dir(lng)}>
      {children}
    </div>
  );
}

```



å‹•ä½œç¢ºèª
npm run dev
npm run build
npm run start



â€»Linkãƒœã‚¿ãƒ³ã§TOPç”»é¢ã«æˆ»ã‚‹ã¨ç”»é¢ãŒçœŸã£æš—
ãƒªãƒ­ãƒ¼ãƒ‰ã§æ²»ã‚‹



----------------------------------------

# Supabaseã¨ã®ã‚¢ã‚¯ã‚»ã‚¹

Next.js 13 App router ã¨ Supabase ã§ã®ï¼”ã¤ã®ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³• - Qiita

https://qiita.com/masakinihirota/items/b4b168a056dc10776d87


vns\app\_examples
ã‚’
vns\app\examples
ã«å¤‰æ›´ã—ã¾ã™ã€‚

Supabaseã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’é–‹ãã¾ã™ã€‚

SQL Editorã‚’é–‹ãã¾ã™ã€‚

```
create table if not exists todos (
  id uuid default gen_random_uuid() primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  title text,
  is_complete boolean default false,
  user_id uuid references auth.users default auth.uid()
);

-- Set up Row Level Security (RLS)
-- See https://supabase.com/docs/guides/auth/row-level-security for more details.
alter table todos
  enable row level security;

create policy "Authenticated users can select todos" on todos
  for select to authenticated using (true);

create policy "Authenticated users can insert their own todos" on todos
  for insert to authenticated with check (auth.uid() = user_id);

```

ã‚’è²¼ã‚Šä»˜ã‘ã¾ã™ã€‚

å³ä¸‹ã® ã€ŒRUN CTRLã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ æˆåŠŸã—ãŸã‚‰ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ â†“Successã‚’ç¢ºèªã§ãã¾ã™ã€‚

ã€ŒSuccess. No rows returnedã€

ã“ã‚Œã§ todos ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå‡ºæ¥ã¾ã—ãŸã€‚



ã‚·ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚µãƒ¼ãƒãƒ¼ã«é©ç”¨ã™ã‚‹

```
insert into todos(title)
values
  ('Create Supabase project'),
  ('Create Next.js app from Supabase Starter template'),
  ('Keep building cool stuff!');

```

ã‚·ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆã¨åŒæ§˜ã«SQLæ–‡ã‚’è²¼ã‚Šä»˜ã‘ã¦å®Ÿè¡Œã—ã¾ã™ã€‚

Supabaseã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã® Table Editor ã§ todosãƒ†ãƒ¼ãƒ–ãƒ«ã‚’é¸æŠã™ã‚‹ã¨ã€‚
ãƒ‡ãƒ¼ã‚¿ã‚‚å…¥ã£ã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚

ã“ã‚Œã§Supabaseå´ã®ä¸‹æº–å‚™ã¯å®Œäº†ã§ã™ã€‚

ã“ã‚Œã‹ã‚‰Next.jsã®ã‚³ãƒ¼ãƒ‰ã‹ã‚‰Supabaseã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦
ãã®ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã™ã‚‹ã¾ã§ã‚’å®Ÿè·µã—ã¾ã™ã€‚


4ã¤ã®æ¥ç¶šæ–¹æ³•

1. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ Supabaseã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹æ–¹æ³•
2. ãƒ«ãƒ¼ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã§ Supabaseã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹æ–¹æ³•
3. Server Actionsã§Supabaseã®DBã‚’æ“ä½œã™ã‚‹æ–¹æ³•
4. ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ Supabaseã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹æ–¹æ³•


ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«4ã¤ã®ãƒªãƒ³ã‚¯ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

```
Client Component Example
Route Handler Example
Server Action Example
Server Component Example

```




å‹•ä½œç¢ºèª

npm run dev

http://localhost:3000/

æ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã‚‹ã®ãªã‚‰ã°

ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã„å ´åˆ
ãƒ‡ãƒ¼ã‚¿ã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€
Server Actionã¯å®Ÿè¡Œã•ã‚Œã¾ã›ã‚“

ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹å ´åˆ
ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
Server Actionã‚’åˆ©ç”¨ã—ã¦ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ‡ãƒ¼ã‚¿ã‚’æŒ¿å…¥ã§ãã¾ã™ã€‚
â€»é€£æ‰“ã™ã‚‹ã¨é€£æ‰“ã—ãŸåˆ†ã ã‘ãƒ‡ãƒ¼ã‚¿ãŒæŒ¿å…¥ã•ã‚Œã¾ã™ã€‚

ã‚³ãƒ¼ãƒ‰ã®è§£èª¬ã¯Blogè¨˜äº‹ã‚’èª­ã‚“ã§ãã ã•ã„ã€‚

ã“ã‚Œã§æœ€ä½é™ã®Webã‚¢ãƒ—ãƒªãŒå®Œæˆã—ã¾ã—ãŸã€‚



>æœ€ä½é™ã®Webã‚¢ãƒ—ãƒªã¨ã¯ï¼Ÿ
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç™»éŒ²ã€ãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚‹ã€‚
DBã‚’ä½œã‚Šã€ãã®ä¸­ã«ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã€‚
ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’æŒ‡å®šã—ã¦å‘¼ã³å‡ºã—ã¦ã€ç”»é¢ã«è¡¨ç¤ºã•ã›ã‚‹ã€‚
ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã—ã¦DBã«ç™»éŒ²ã§ãã‚‹ã€‚
ãã®ç™»éŒ²ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã§ãã‚‹ã€‚



ä¸€æ®µè½ã¤ã„ãŸã®ã§
gitã®ã‚¿ã‚°ã‚’ä½œæˆ
tag i18n



----------------------------------------

# æ¬¡ã¸


åŸºæœ¬çš„ãªä½¿ã„æ–¹ huskey v8 ã‚³ãƒŸãƒƒãƒˆæ™‚ã«è‡ªå‹•ãƒ“ãƒ«ãƒ‰ or è‡ªå‹•ãƒ†ã‚¹ãƒˆ å¤±æ•—æ™‚ã«ã‚³ãƒŸãƒƒãƒˆã¯å®Ÿè¡Œã•ã‚Œãªã„ã€‚ æˆåŠŸæ™‚ã¯é€šå¸¸é€šã‚Šã€‚ - Qiita

https://qiita.com/masakinihirota/items/217ae8fc036e605e0482

# huskey ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

å…¬å¼ã‚µã‚¤ãƒˆ
Getting started | ğŸ¶ husky

https://typicode.github.io/husky/getting-started.html

ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯
"husky": "^8.0.0"



è‡ªå‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆæ¨å¥¨ï¼‰

```
npx husky-init && npm install

```



ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã‚‹ä¸­ã®è©³ç´°ã¯å…¬å¼ã‚µã‚¤ãƒˆã‚’å¾¡è¦§ãã ã•ã„ã€‚



## buildã‚³ãƒãƒ³ãƒ‰ã®è¿½åŠ 

ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã„ã¦ç·¨é›†ã—ã¾ã™ã€‚

```.husky\pre-commit
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

npm run build   ï¼œï¼œï¼œã“ã“ã«å®Ÿè¡Œã—ãŸã„npm scriptã‚’æ›¸ãã¾ã™ã€‚

```

ã“ã‚Œã§ã‚³ãƒŸãƒƒãƒˆæ™‚ã«ã€Œãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã€ã§ npm run build ãŒèµ°ã‚Š
buildãŒå¤±æ•—ã™ã‚‹ã¨ã‚³ãƒŸãƒƒãƒˆãŒã•ã‚Œã¾ã›ã‚“ã€‚ï¼œï¼œä¾¿åˆ©
buildãŒæˆåŠŸã™ã‚‹ã¨ã‚³ãƒŸãƒƒãƒˆã¯é€šå¸¸é€šã‚Šã§ã™ã€‚

å¾Œã§lintã‚³ãƒãƒ³ãƒ‰ç­‰ã‚’è¿½åŠ äºˆå®šã€‚


ã‚³ãƒãƒ³ãƒ‰ã®è¿½åŠ ã‚³ãƒãƒ³ãƒ‰

npm testã‚’è¿½åŠ ã—ãŸã„å ´åˆ

```terminal
npx husky add .husky/pre-commit "npm test"

```

ä¾‹ãˆã°ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®æ–¹ã ã‘ã«é–‹ç™ºã‚’é›†ä¸­ã—ã¦ã„ã‚‹ç­‰ã®å ´åˆã¯ã€
buildã‚³ãƒãƒ³ãƒ‰ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¦ buildæ™‚é–“ã‚’å‰Šã‚Œã°ã‚µã‚¯ã‚µã‚¯é–‹ç™ºã§ãã¾ã™ã€‚



git tag huskey



----------------------------------------

ãƒ•ã‚¡ãƒ“ã‚³ãƒ³

VNS.BLUEã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã®è‰²

é’ç³»çµ±ã®è‰²ã«æ±ºã‚ã‚‹ã€‚

RGB	#
0		00
126		7E
254		FE

#007EFE

ãƒ•ã‚¡ãƒ“ã‚³ãƒ³ã‚’ä½œã‚Šæ›¸ãæ›ãˆã¾ã™ã€‚

src\app\favicon.ico



----------------------------------------



## middleware

### Middleware ã®é…ç½®å ´æ‰€ã«ã¤ã„ã¦

Next.jsã§ã®Middleware ã¯
root/
app/
pages/
ã¨åŒã˜éšå±¤ã«é…ç½®ã§ãã¾ã™ã€‚

â€»é‡è¦: Next.jsã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã« srcãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œã£ãŸå ´åˆã¯ã€srcãƒ•ã‚©ãƒ«ãƒ€ã®ä¸‹ã«ç½®ãã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚




2ã¤ã®ãƒªãƒã‚¸ãƒˆãƒª
with-supabase
ã¨
i18n
ã“ã®2ã¤ã®middlewareã‚’ã¾ã¨ã‚ã¾ã™ã€‚

middleware.ts
ã«æ‹¡å¼µå­ã‚’å¤‰æ›´ã—ã¾ã™ã€‚



```middleware.ts
import { createMiddlewareClient } from "@supabase/auth-helpers-nextjs";
import { NextResponse } from "next/server";

import type { NextRequest } from "next/server";

import acceptLanguage from "accept-language";

import { fallbackLng, languages, cookieName } from "@/app/i18n/settings";

acceptLanguage.languages(languages);

export const config = {
  // matcher: '/:lng*'
  matcher: ["/((?!api|_next/static|_next/image|assets|favicon.ico|sw.js).*)"],
};

export async function middleware(req: NextRequest) {
  const res = NextResponse.next();

  // Create a Supabase client configured to use cookies
  const supabase = createMiddlewareClient({ req, res });

  // Refresh session if expired - required for Server Components
  // https://supabase.com/docs/guides/auth/auth-helpers/nextjs#managing-session-with-middleware
  await supabase.auth.getSession();

  let lng;
  if (req.cookies.has(cookieName))
    lng = acceptLanguage.get(req.cookies.get(cookieName)?.value);
  if (!lng) lng = acceptLanguage.get(req.headers.get("Accept-Language"));
  if (!lng) lng = fallbackLng;

  // Redirect if lng in path is not supported
  if (
    !languages.some((loc) => req.nextUrl.pathname.startsWith(`/${loc}`)) &&
    !req.nextUrl.pathname.startsWith("/_next")
  ) {
    return NextResponse.redirect(
      new URL(`/${lng}${req.nextUrl.pathname}`, req.url)
    );
  }

  const refererHeaderValue = req.headers.get("referer");

  if (refererHeaderValue !== null) {
    const refererUrl = new URL(refererHeaderValue);
    const lngInReferer = languages.find((l) =>
      refererUrl.pathname.startsWith(`/${l}`)
    );
    const res = NextResponse.next();
    if (lngInReferer) res.cookies.set(cookieName, lngInReferer);
    return res;
  }

  return res;
}

```



å‹•ä½œã€ã‚¨ãƒ©ãƒ¼ç¢ºèª
ãƒ–ãƒ©ã‚¦ã‚¶ã®èª¿æŸ»æ¤œè¨¼ç”»é¢ã‚’é–‹ã„ã¦ãŠã
ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã‚’é–‹ã

npm run dev



----------------------------------------

ã“ã“ã§ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã«ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã„ã‚‹ã®ã«æ°—ã¥ã

```
app-index.js:31 Warning: Extra attributes from the server: class
    at body
    at html
    at RedirectErrorBoundary

```

åŸå› ã¯
ãƒ–ãƒ©ã‚¦ã‚¶ã®æ‹¡å¼µæ©Ÿèƒ½

å•é¡Œè§£æ±º
https://www.slingacademy.com/article/next-js-warning-extra-attributes-from-the-server/



å¯¾å¿œç­–ã¯
ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆç”»é¢ã‚’åˆ©ç”¨ã™ã‚‹ã€‚ã¨ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã“ãªã„ã€‚

æ‹¡å¼µæ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ãªã„ã€‚ã¨ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã“ãªã„ã€‚

<body suppressHydrationWarning={true}>
bodyã‚¿ã‚°ã« ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¨­å®šã™ã‚‹ã™ã‚‹ã€‚

â†‘suppressHydrationWarningãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ã€
ReactãŒã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚ŒãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’
ãƒã‚¤ãƒ‰ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹éš›ã«ã€
è­¦å‘Šã‚’æŠ‘åˆ¶ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚



```src\app\layout.tsx
import "@/styles/globals.css";

import { Metadata } from "next";

// Next.jsã§ã¯metadataã‚’ä½¿ã£ã¦ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®šã—ã¾ã™ã€‚
export const metadata: Metadata = {
  title: "VNS.BLUE",
  description: "VNS.BLUE",
  keywords: "VNS.BLUE, ã‚ªã‚¢ã‚·ã‚¹å®£è¨€",
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html>
      <body suppressHydrationWarning={true}>{children}</body>
    </html>
  );
}

```



å‹•ä½œã€ã‚¨ãƒ©ãƒ¼ç¢ºèª
ãƒ–ãƒ©ã‚¦ã‚¶ã®èª¿æŸ»æ¤œè¨¼ç”»é¢ã‚’é–‹ã„ã¦ãŠã
ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã‚’é–‹ã

npm run dev





----------------------------------------

# eslint & prettier

VSCodeã®è¨­å®š Default Formatterã‚’Prettierã«ã™ã‚‹ã€‚

```setting.json
"editor.defaultFormatter": "esbenp.prettier-vscode"

```



# prettier

å…¬å¼ã‚µã‚¤ãƒˆ Install Prettier

https://prettier.io/docs/en/install.html

prettier ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

npm install -D prettier

eslint ã¨è¨­å®šãŒè¡çªã™ã‚‹ã®ã‚’é¿ã‘ã‚‹ãŸã‚ã®è¨­å®š

npm install -D eslint-config-prettier

ç©ºã®.prettierrc ã‚’ä½œæˆã—ã¦ã€Prettier ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã“ã¨ã‚’ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã‚„ãã®ä»–ã®ãƒ„ãƒ¼ãƒ«ã«çŸ¥ã‚‰ã›ã¾ã™ã€‚

touch .prettierrc

```.prettierrc

```

Prettier ã‚’ VSCode ã§ä½¿ã†ã«ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼ã‚’ Prettier ã«è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

.eslintrc.json ã« prettier è¨­å®šã®è¿½åŠ ã‚’ã—ã¾ã™ã€‚

```.eslintrc.json
{
  "extends": [
    "next/core-web-vitals",
    "prettier"
  ]
}

```

package.json ã« format ã‚³ãƒãƒ³ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```package.json (è¿½è¨˜)
"scripts": {
  "lint": "eslint --ext .ts,.js,.tsx . ",
  "format": "prettier --write ."
  ...

```

## .prettierrc è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®è¿½åŠ 

.prettierrc ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¨­å®šã—ã¾ã™ã€‚

```.prettierrc
{
  "tabWidth": 2,
  "useTabs": false,
  "trailingComma": "none",
  "semi": false
}

```

â€»ãƒ«ãƒ¼ãƒ«ã¯å„è‡ªã§å¥½ããªã‚ˆã†ã«è¨­å®šã—ã¦ãã ã•ã„ã€‚

â†“ ã“ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯æ¨å¥¨ã•ã‚Œãªããªã‚Šã¾ã—ãŸã€‚
eslint-plugin-prettier

æ¬¡ã«ã€.prettierignore ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ã€ã©ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã—ãªã„ã‹ã‚’ Prettier CLI ã¨ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã«çŸ¥ã‚‰ã›ã¾ã™ã€‚

touch .prettierignore

```.prettierignore
# Ignore artifacts:
build
coverage

# dotfile
.env*

# markdown
*.md

# next.js
/.next/
/out/

# production
/build

package-lock.json

*.stories.ts
*.stories.tsx

```



## Prettier ã‚³ãƒãƒ³ãƒ‰ä¸€è¦§

â€»é€šå¸¸ã¯ VSCode å´ã‚’è¨­å®šã™ã‚Œã°ã€ä¿å­˜æ™‚ã«è‡ªå‹•ã§å®Ÿè¡Œã•ã‚Œã‚‹ã®ã§ã€ã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“ã¤ã“ã¨ã¯ã»ã¨ã‚“ã©ã‚ã‚Šã¾ã›ã‚“ã€‚

å‹•ä½œç¢ºèªã®ãŸã‚ prettier ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

å…¨ä½“ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã—ã¾ã™ã€‚
npx prettier . --write

src ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã—ã¾ã™ã€‚
npx prettier src/ --write

å·¨å¤§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å ´åˆã«æ™‚é–“çŸ­ç¸®ã®ãŸã‚ãƒ•ã‚©ãƒ«ãƒ€ã‚’æŒ‡å®šã—ãŸã„å ´åˆ
npx prettier [ãƒ•ã‚©ãƒ«ãƒ€å] --write

ç›´æ¥ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã™ã‚‹å ´åˆ
npx prettier src\app\page.tsx --write

prettier ãŒå®Ÿè¡Œæ¸ˆã¿ã‹ã®ç¢ºèªï¼ˆä¸Šæ›¸ãã¯ã—ãªã„ï¼‰
npx prettier . --check



å‹•ä½œç¢ºèª
npm run buildç¢ºèª



----------------------------------------

# eslintã®è©³ç´°ãªè¨­å®š

## .eslintignore ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

.eslintignore ã‚’ä½œæˆã—ã¾ã™ã€‚

touch .eslintignore

â†“lint å¯¾è±¡ã‹ã‚‰å¤–ã—ãŸã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¨­å®šã—ã¾ã™ã€‚

```.eslintignore
# config
.eslintrc.json
.prettierrc
next.config.js
tailwind.config.js
tsconfig.json
postcss.config.js

# build dir
build/
bin/
obj/
out/
.next/

# è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«
package-lock.json

# Storybook
*.stories.ts
*.stories.tsx

# CSSãƒ•ã‚¡ã‚¤ãƒ«
*.css

# mdxãƒ•ã‚¡ã‚¤ãƒ«
*.mdx

# ã™ã¹ã¦ã®ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é™¤å¤–ã™ã‚‹
**/*.png
**/*.jpg
**/*.jpeg
**/*.gif
**/*.ico

node_modules
public

```


# ESLint ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«


next.js/packages/eslint-config-next/index.js at canary Â· vercel/next.js Â· GitHub

https://github.com/vercel/next.js/blob/canary/packages/eslint-config-next/index.js

ä¸Šè¨˜ã‚³ãƒ¼ãƒ‰ã‚’èª¿ã¹ã‚‹ã¨ next/core-web-vitals ã¯
next/recommended
react/recommended
react-hooks/recommended
ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã‚‹ã®ã§ã€â†‘ ã“ã‚Œã‚‰ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ä¸è¦ã§ã™ã€‚


# eslint-plugin-import

Next.js é–‹ç™º ESLint ã§ import æ–‡ã®è‡ªå‹•æŒ¿å…¥ã€è‡ªå‹•å‰Šé™¤ã€è‡ªå‹•ã‚½ãƒ¼ãƒˆ - Qiita

https://qiita.com/masakinihirota/items/fae505a58892b00550a7

npm install -D eslint-plugin-unused-imports --legacy-peer-deps
npm install -D @typescript-eslint/eslint-plugin@latest



```.eslintrc.json
{
  "extends": ["next/core-web-vitals", "prettier"],
  "plugins": ["unused-imports"],
  "rules": {
    "unused-imports/no-unused-imports": "warn"
  }
}

```

â€» â†‘ã“ã®è¨­å®šã¯å¿…è¦ãªæœ€å°é™ã®è¨­å®šã«ã—ã¦ã‚ã‚‹ã®ã§ã€è‡ªå‹•æŒ¿å…¥ã€è‡ªå‹•å‰Šé™¤ã®ç¢ºèªç”¨ã¨ã—ã¦æœ‰åŠ¹ã§ã™ã€‚




ã•ã‚‰ã«ã€ä¸¦ã¹æ›¿ãˆã®ãƒ«ãƒ¼ãƒ«ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```.eslintrc.json
{
  "extends": ["next/core-web-vitals", "prettier"],
  "plugins": ["unused-imports"],
  "rules": {
    // TypeScriptã§æœªä½¿ç”¨ã®å¤‰æ•°ã‚’è¨±å¯ã™ã‚‹ã‹ã©ã†ã‹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€offã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€æœªä½¿ç”¨ã®å¤‰æ•°ã‚’è¨±å¯ã—ã¾ã™ã€‚
    "@typescript-eslint/no-unused-vars": "off",
    // æœªä½¿ç”¨ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«é–¢ã™ã‚‹ãƒ«ãƒ¼ãƒ«ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€warnã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€æœªä½¿ç”¨ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆãŒã‚ã‚‹å ´åˆã«è­¦å‘Šã‚’å‡ºã—ã¾ã™ã€‚
    "unused-imports/no-unused-imports": "warn",
    // ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆé †åºã«é–¢ã™ã‚‹ãƒ«ãƒ¼ãƒ«ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€é…åˆ—ã®ä¸­ã«è¤‡æ•°ã®ã‚°ãƒ«ãƒ¼ãƒ—ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚å„ã‚°ãƒ«ãƒ¼ãƒ—ã¯ã€groupsãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚
    "import/order": [
      "warn",
      {
        "groups": [
          // builtin: Node.js ã«çµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
          // external: npm install ç­‰ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå¤–éƒ¨ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
          // internal: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã€ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚ŒãŸã‚‚ã®
          // parent: è¦ªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« ç›¸å¯¾ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚ŒãŸã‚‚ã®
          // sibling: å…„å¼Ÿãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« ç›¸å¯¾ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚ŒãŸã‚‚ã®
          // index: ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã§ã€ç›¸å¯¾ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚ŒãŸã‚‚ã®
          // object: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã§ã€ç›¸å¯¾ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚ŒãŸã‚‚ã®
          // type: å‹ãƒ•ã‚¡ã‚¤ãƒ«ã§ã€ç›¸å¯¾ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚ŒãŸã‚‚ã®
          "builtin",
          "external",
          "internal",
          ["parent", "sibling"],
          "index",
          "object",
          "type"
        ],
        // ãã‚Œãã‚Œã®groupsã¨ã®é–“ã¯1è¡Œåˆ†ç©ºã‘ã¾ã™ã€‚
        "newlines-between": "always",
        // ç‰¹å®šã®ã‚°ãƒ«ãƒ¼ãƒ—ã® import æ–‡ã‚’é™¤å¤–ã™ã‚‹ã‹ã©ã†ã‹ã‚’æŒ‡å®šã—ã¾ã™ã€‚
        "pathGroupsExcludedImportTypes": ["builtin", "external"],
        // order ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«ã—ã¾ã™ã€‚
        // caseInsensitive ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€å¤§æ–‡å­—å°æ–‡å­—ã‚’ç„¡è¦–ã—ã¦ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«ä¸¦ã¹ã‚‹ã‹ã©ã†ã‹ã‚’æŒ‡å®šã—ã¾ã™ã€‚
        "alphabetize": { "order": "asc", "caseInsensitive": true },
        "pathGroups": [
          // pattern: ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€src/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã®ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚
          // group: ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹ãŒä¸€è‡´ã—ãŸå ´åˆã«ã€ã©ã®ã‚°ãƒ«ãƒ¼ãƒ—ã«å±ã™ã‚‹ã‹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€internalã‚°ãƒ«ãƒ¼ãƒ—ã«å±ã™ã‚‹ã‚ˆã†ã«æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚
          // position: ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹ãŒä¸€è‡´ã—ãŸå ´åˆã«ã€ã©ã®ä½ç½®ã«æŒ¿å…¥ã™ã‚‹ã‹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€beforeã«æŒ‡å®šã—ã¦ã„ã‚‹ãŸã‚ã€ä»–ã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚ˆã‚Šã‚‚å‰ã«æŒ¿å…¥ã•ã‚Œã¾ã™ã€‚
          {
            "pattern": "src/**",
            "group": "internal",
            "position": "before"
          }
        ]
      }
    ]
  }
}

```




## ç¢ºèªç”¨ã®ãƒšãƒ¼ã‚¸

import æ–‡ã®è‡ªå‹•å‰Šé™¤ã‚„è‡ªå‹•æŒ¿å…¥ãŒè©¦ã›ã¾ã™ã€‚

```src\app\XXX.tsx
// importæ–‡ã®é †ç•ªã‚‚è‡ªå‹•æ•´å½¢ã•ã‚Œã¾ã™ã€‚
import { type NextPage } from "next";
import Link from "next/link";

const Home: NextPage = () => {
  return (
    <main>
      {/* TailwindCSSã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å€¤ã‚‚è‡ªå‹•æ•´åˆ—ã•ã‚Œã¾ã™ã€‚ */}
      <h1 className="pt-2 p-4">VNS.BLUE</h1>
      Next.js app router é–‹ç™ºç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ (Storybook Supabase shadcn/ui)
      <br />
      {/* â†“ã“ã®è¡Œã‚’æ¶ˆã™ã¨importæ–‡ãŒè‡ªå‹•å‰Šé™¤ã•ã‚Œã¾ã™ã€‚ */}
      <Link href="/">Home</Link>
    </main>
  );
};

export default Home;

```



```.eslintrc.json
{
  "extends": [
    "plugin:@typescript-eslint/recommended",
    "eslint:recommended",
    "next/core-web-vitals",
    "prettier"
  ],
  "parser": "@typescript-eslint/parser",
  "parserOptions": {
    // tsx ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®JSXæ§‹æ–‡ã‚’æ­£ã—ãè§£æã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
    "ecmaFeatures": {
      "jsx": true
    },
    "ecmaVersion": 2020,
    "sourceType": "module",
    "jsx": "react"
  },
  // react: Reactã®æ§‹æ–‡ã‚’è§£æã™ã‚‹ãŸã‚ã®ãƒ«ãƒ¼ãƒ«ã‚’æä¾›ã—ã¾ã™ã€‚
  // import: importæ–‡ã®æ§‹æ–‡ã‚’è§£æã™ã‚‹ãŸã‚ã®ãƒ«ãƒ¼ãƒ«ã‚’æä¾›ã—ã¾ã™ã€‚
  // unused-imports: æœªä½¿ç”¨ã®importæ–‡ã‚’æ¤œå‡ºã™ã‚‹ãŸã‚ã®ãƒ«ãƒ¼ãƒ«ã‚’æä¾›ã—ã¾ã™ã€‚
  "plugins": ["react", "import", "unused-imports"],
  "root": true,
  "rules": {
    // TypeScriptã§æœªä½¿ç”¨ã®å¤‰æ•°ã‚’è¨±å¯ã™ã‚‹ã‹ã©ã†ã‹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€offã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€æœªä½¿ç”¨ã®å¤‰æ•°ã‚’è¨±å¯ã—ã¾ã™ã€‚
    "@typescript-eslint/no-unused-vars": "off",
    "@typescript-eslint/no-explicit-any": "off",
    // æœªä½¿ç”¨ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«é–¢ã™ã‚‹ãƒ«ãƒ¼ãƒ«ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€warnã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€æœªä½¿ç”¨ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆãŒã‚ã‚‹å ´åˆã«è­¦å‘Šã‚’å‡ºã—ã¾ã™ã€‚
    "unused-imports/no-unused-imports": "warn",
    // ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆé †åºã«é–¢ã™ã‚‹ãƒ«ãƒ¼ãƒ«ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€é…åˆ—ã®ä¸­ã«è¤‡æ•°ã®ã‚°ãƒ«ãƒ¼ãƒ—ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚å„ã‚°ãƒ«ãƒ¼ãƒ—ã¯ã€groupsãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚
    "import/order": [
      // ã‚¨ãƒ©ãƒ¼ã ã¨å‹•ä½œãŒæ­¢ã¾ã‚Šã¾ã™ã€‚
      // è­¦å‘Šã ã¨è­¦å‘Šè¡¨ç¤ºã¯ã•ã‚Œã¾ã™ãŒå‹•ä½œã¯æ­¢ã¾ã‚Šã¾ã›ã‚“ã€‚
      "warn",
      {
        "groups": [
          // builtin: Node.js ã«çµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
          // external: npm install ç­‰ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå¤–éƒ¨ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
          // internal: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã€ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚ŒãŸã‚‚ã®
          // parent: è¦ªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« ç›¸å¯¾ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚ŒãŸã‚‚ã®
          // sibling: å…„å¼Ÿãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« ç›¸å¯¾ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚ŒãŸã‚‚ã®
          // index: ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã§ã€ç›¸å¯¾ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚ŒãŸã‚‚ã®
          // object: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã§ã€ç›¸å¯¾ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚ŒãŸã‚‚ã®
          // type: å‹ãƒ•ã‚¡ã‚¤ãƒ«ã§ã€ç›¸å¯¾ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚ŒãŸã‚‚ã®
          "builtin",
          "external",
          "internal",
          ["parent", "sibling"],
          "index",
          "object",
          "type"
        ],
        // ãã‚Œãã‚Œã®groupsã¨ã®é–“ã¯1è¡Œåˆ†ç©ºã‘ã¾ã™ã€‚
        "newlines-between": "always",
        // ç‰¹å®šã®ã‚°ãƒ«ãƒ¼ãƒ—ã® import æ–‡ã‚’é™¤å¤–ã™ã‚‹ã‹ã©ã†ã‹ã‚’æŒ‡å®šã—ã¾ã™ã€‚
        "pathGroupsExcludedImportTypes": ["builtin", "external"],
        // order ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«ã—ã¾ã™ã€‚
        // caseInsensitive ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€å¤§æ–‡å­—å°æ–‡å­—ã‚’ç„¡è¦–ã—ã¦ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«ä¸¦ã¹ã‚‹ã‹ã©ã†ã‹ã‚’æŒ‡å®šã—ã¾ã™ã€‚
        "alphabetize": { "order": "asc", "caseInsensitive": true },
        "pathGroups": [
          // pattern: ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€src/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã®ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚
          // group: ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹ãŒä¸€è‡´ã—ãŸå ´åˆã«ã€ã©ã®ã‚°ãƒ«ãƒ¼ãƒ—ã«å±ã™ã‚‹ã‹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€internalã‚°ãƒ«ãƒ¼ãƒ—ã«å±ã™ã‚‹ã‚ˆã†ã«æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚
          // position: ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹ãŒä¸€è‡´ã—ãŸå ´åˆã«ã€ã©ã®ä½ç½®ã«æŒ¿å…¥ã™ã‚‹ã‹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€beforeã«æŒ‡å®šã—ã¦ã„ã‚‹ãŸã‚ã€ä»–ã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚ˆã‚Šã‚‚å‰ã«æŒ¿å…¥ã•ã‚Œã¾ã™ã€‚
          {
            "pattern": "src/**",
            "group": "internal",
            "position": "before"
          }
        ]
      }
    ]
  }
}

```



## ESlintã§ã®ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œã™ã‚‹

### *.tsxãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹å ´åˆ

npx eslint src/**/*.tsx

### å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹å ´åˆ

npx eslint src/**/*

â€»ãƒã‚§ãƒƒã‚¯ã‚’ã—ãªã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—ã¯ .eslintignore ã«ç™»éŒ²ã—ã¾ã™ã€‚


## prettierã®ãƒ«ãƒ¼ãƒ«ã§æ›¸ãæ›ãˆã‚‹

npx prettier . --write



----------------------------------------

# lint-staged

npm i --save-dev lint-staged

npx husky set .husky/pre-commit "npx lint-staged"

```
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

npm run lint:fix
npx lint-staged
npm run build

```

```package.json
{
  "name": "vns.blue",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint --ext .ts,.js,.tsx . && prettier --check \"./**/*.{ts,js,tsx}\"",
    "lint:fix": "eslint --ext .ts,.js,.tsx . --fix && prettier --write \"./**/*.{ts,js,tsx,scss}\"",
    "format": "prettier --write './**/*.{js,ts,tsx}'"
  },
  "dependencies": {
    "@heroicons/react": "^2.0.18",
    "@nextui-org/react": "^2.1.12",
    "@supabase/auth-helpers-nextjs": "latest",
    "@supabase/supabase-js": "latest",
    "accept-language": "^3.0.18",
    "autoprefixer": "10.4.14",
    "eslint": "^8.49.0",
    "eslint-config-next": "^13.4.19",
    "framer-motion": "^10.16.4",
    "i18next": "^23.5.1",
    "i18next-browser-languagedetector": "^7.1.0",
    "i18next-resources-to-backend": "^1.1.4",
    "next": "latest",
    "next-themes": "^0.2.1",
    "postcss": "8.4.24",
    "react": "18.2.0",
    "react-cookie": "^6.1.1",
    "react-dom": "18.2.0",
    "react-i18next": "^13.2.2",
    "tailwindcss": "3.3.2",
    "typescript": "5.1.3"
  },
  "devDependencies": {
    "@types/node": "20.3.1",
    "@types/react": "18.2.12",
    "@types/react-dom": "18.2.5",
    "@types/tailwindcss": "^3.1.0",
    "@typescript-eslint/eslint-plugin": "^6.7.2",
    "encoding": "^0.1.13",
    "eslint-config-prettier": "^9.0.0",
    "eslint-plugin-unused-imports": "^3.0.0",
    "husky": "^8.0.0",
    "lint-staged": "^14.0.1",
    "prettier": "^3.0.3"
  },
  "lint-staged": {
    "*.{tsx,ts}": "npm run lint"
  }
}

```




# turborepo ã®å°å…¥

ãƒ“ãƒ«ãƒ‰ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç›®çš„ã§ turborepo ã‚’å°å…¥ã—ã¦ã¿ã¾ã™ã€‚
ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒåŠ¹ã„ã¦ã„ã‚‹å ´åˆã®ãƒ“ãƒ«ãƒ‰ã¯æ—©ããªã‚Šã¾ã™ãŒã€
å®Ÿé‹ç”¨ã§ã¯æ—©ããªã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ

Add Turborepo to your existing project â€“ Turborepo

https://turbo.build/repo/docs/getting-started/add-to-project

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

pnpm add turbo --global

```turbo.json
{
  "$schema": "https://turbo.build/schema.json",
  "pipeline": {
    "build": {
      "outputs": [".next/**", "!.next/cache/**"]
    },
    "lint": {}
  }
}

```



```.gitignore
# turborepo
.turbo

```


```.husky\pre-commit
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

turbo build lint:fix

```

ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã«æ•´å½¢ã¨ãƒ“ãƒ«ãƒ‰ã‚’è¡Œã†ã‚ˆã†ã«è¨­å®šã—ã¾ã™ã€‚

turbo build lint:fix



lint-stagedã¯æ›´æ–°ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®lint ãƒã‚§ãƒƒã‚¯ã‚’è¡Œã„ã¾ã™ã€‚
turbo lint ã¯å…¨ä½“ã®lint ãƒã‚§ãƒƒã‚¯ã‚’è¡Œã„ã¾ã™ã€‚



â€»å®Ÿéš›ã«ä½¿ã£ã¦ã¿ã¦

ä½•å‡¦ã‹ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã«ã€ã‚¨ãƒ©ãƒ¼ç®‡æ‰€ã‚’ä¿®æ­£ã—ã¦ã€turbo build ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦å‹•ä½œç¢ºèªã‚’ã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

ã‚‚ã—ã“ã®æ™‚ã« turbo build ã‚³ãƒãƒ³ãƒ‰ãŒæˆåŠŸã—ãŸå ´åˆã¯ã€GitHubã«PUSHã™ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã‚‚ turbo build lint:fix ã‚’å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«è¨­å®šã—ã¦ã‚ã‚‹ã®ã§ã€ã“ã®æ™‚ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’èª­ã¿è¾¼ã‚“ã§æ™‚é–“çŸ­ç¸®ãŒå‡ºæ¥ã¾ã™ã€‚



Next.js ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ç™ºã—ã‚„ã™ã„ã‚ˆã†ã«ã™ã‚‹lintã¨formatterãªã©ã®è¨­å®š

https://zenn.dev/brachio_takumi/articles/a8fecd8b1b2742

----------------------------------------

è¿½è¨˜ 2023å¹´10æœˆ9æ—¥

huskyã§è¿½åŠ ã—ã¾ã—ãŸã€‚

â†“ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

```
.husky\pre-commit

.husky\pre-push

```

pre-commitãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚³ãƒŸãƒƒãƒˆæ™‚ã«ã€
pre-pushã¯pushæ™‚ã«è‡ªå‹•å®Ÿè¡Œã—ã¾ã™ã€‚


```.husky\pre-commit
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# npm run format:fix
npm run lint-staged
git add .

```

```.husky\pre-push
#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

turbo build

```

â†‘ ã‚³ãƒŸãƒƒãƒˆæ™‚ã«ã¯ ESLintã¨ Prettierã‚’èµ°ã‚‰ã›ã¾ã™ã€‚
PUSHæ™‚ã«ã¯ãƒ“ãƒ«ãƒ‰ã‚’èµ°ã‚‰ã›ã¾ã™ã€‚

ãƒ­ãƒ¼ã‚«ãƒ«ã§è¤‡æ•°å›ã‚³ãƒŸãƒƒãƒˆã—ãŸã‚‰ã€ä¸€å®šæ™‚é–“ã®å¾Œãƒ“ãƒ«ãƒ‰ã‚’èµ°ã‚‰ã›ã‚‹ã¨ã„ã†æ–¹æ³•ã‚’å–ã£ã¦ã„ã¾ã™ã€‚

ãƒ“ãƒ«ãƒ‰ã«ã¯é•·ã„æ™‚é–“ãŒã‹ã‹ã‚‹ã®ã§ã“ã®æ–¹å¼ã‚’æ¡ç”¨ã—ã¦ã¿ã¾ã—ãŸã€‚

turborepoã‚’å°å…¥ã—ã¦ã„ã‚‹ã®ã¯åŒã˜ã‚³ãƒ¼ãƒ‰ã ã£ãŸå ´åˆã€ãƒ“ãƒ«ãƒ‰æ™‚ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å‚ç…§ã—ã¦ãã‚Œã¦æ™‚é–“çŸ­ç¸®ã«ãªã‚‹ã‹ã‚‰ã§ã™ã€‚



----------------------------------------

# ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®å®Ÿè£…

NextUIã®ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

# NextUIã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Next.js | NextUI - Beautiful, fast and modern React UI Library

https://nextui.org/docs/frameworks/nextjs

npm i @nextui-org/react framer-motion

npm i -D @types/tailwindcss



â€»ã‚‚ã—nextuiã‚’ pnpmã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãŸå ´åˆ

pnpmã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã¯ã€rootç›´ä¸‹ã« .npmrcãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚Šã€
ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

```.npmrc
public-hoist-pattern[]=*@nextui-org/*ã€‚

```

.npmrc ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿®æ­£ã—ãŸå¾Œã€pnpm install ã‚’å†åº¦å®Ÿè¡Œã—ã¦ã€ä¾å­˜é–¢ä¿‚ãŒæ­£ã—ãã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

Installation | NextUI - Beautiful, fast and modern React UI Library

https://nextui.org/docs/guide/installation





```tailwind.config.js
import { nextui } from "@nextui-org/react";

/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    "./src/pages/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/components/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/app/**/*.{js,ts,jsx,tsx,mdx}",
    "./node_modules/@nextui-org/theme/dist/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {},
  },
  darkMode: "class",
  plugins: [nextui()],
};

```



```app\globals.css
@tailwind base;
@tailwind components;
@tailwind utilities;

```



```src\app\page.tsx
import { createServerComponentClient } from "@supabase/auth-helpers-nextjs";
import { cookies } from "next/headers";
import Link from "next/link";

import LogoutButton from "../components/LogoutButton";

// å‹•çš„ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’å¼·åˆ¶ã—ã¾ã™ã€‚
export const dynamic = "force-dynamic";

export default async function Index() {
  const supabase = createServerComponentClient({ cookies });

  const {
    data: { user },
  } = await supabase.auth.getUser();

  return (
    // å…¨ä½“ã‚’ç¸¦ã«ãªã‚‰ã¹ã¦ã„ã‚‹ã€å¹…ã„ã£ã±ã„ã«ä¸¦ã¹ã¦ã„ã‚‹
    <div className="flex flex-col items-center w-full">
      {/* navéƒ¨åˆ† Home ,Advertisement, Dark mode,Language, Login */}
      {/* ãƒŠãƒ“éƒ¨åˆ†ã®é«˜ã•ã‚’æ±ºã‚ã¦ã„ã‚‹ã€ãƒœãƒ¼ãƒ€ãƒ¼ãƒ©ã‚¤ãƒ³ãƒœãƒˆãƒ ã‚’æã„ã¦ã„ã‚‹ ãƒœãƒ¼ãƒ€ãƒ¼è‰²ã¯ç¾åœ¨ã®æ–‡å­—è‰²
      ãƒŠãƒ“éƒ¨åˆ†ã¨ãƒ¡ã‚¤ãƒ³éƒ¨åˆ†ã®åˆ†é›¢ç®‡æ‰€ */}
      <nav className="flex justify-center w-full h-16 border-b border-current">
        {/* ãƒŠãƒ“éƒ¨åˆ† ä¸Šä¸‹ä¸­å¤®ã«æƒãˆã¦ã„ã‚‹ æ¨ªã«å‡ç­‰ã«ãªã‚‰ã¹ã¦ã„ã‚‹ å¹…ã„ã£ã±ã„ã«ä½¿ã£ã¦ã„ã‚‹ */}
        <div className="flex items-center justify-between w-full">
          VNS.BLUE
          <div />
          Dark mode
          <div />
          Language
          <div />
          Advertisement
          <div>
            {user ? (
              <div className="flex items-center gap-4">
                Welcome to VNS.BLUE, {user.email}!
                <LogoutButton />
              </div>
            ) : (
              <Link
                href="/login"
                className="px-4 py-2 no-underline rounded-md bg-btn-background hover:bg-btn-background-hover"
              >
                Login
              </Link>
            )}
          </div>
        </div>
      </nav>

      {/* ãƒ¡ã‚¤ãƒ³éƒ¨åˆ† */}
      <main className="flex flex-col w-full max-w-4xl p-3 text-xl text-foreground">
        <Link href="./examples/client-component">Client Component Example</Link>
        <Link href="./examples/route-handler">Route Handler Example</Link>
        <Link href="./examples/server-action">Server Action Example</Link>
        <Link href="./examples/server-component">Server Component Example</Link>
        <br />
        {/* <Link href={`/${lng}/login`}></Link> */}
        <Link href={`/en`}>è‹±èª</Link>
        <Link href="/de">ãƒ‰ã‚¤ãƒ„èª</Link>
        <Link href="/ja">æ—¥æœ¬èª</Link>
      </main>
      <h1 className="text-3xl font-bold underline">Hello world!</h1>
      <div />
      <footer className="flex items-center justify-center h-16">
        VNS.BLUE 2023
      </footer>
    </div>
  );
}

```



å‹•ä½œç¢ºèª
npm run dev

Hello world!ã®æ–‡å­—ã«TailwindCSSã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒæœ‰åŠ¹ã ã£ãŸã‚‰æˆåŠŸã§ã™ã€‚



# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®ç¶šã


touch src/app/providers.tsx

```app/providers.tsx
"use client";

import { NextUIProvider } from "@nextui-org/react";
import React from "react";

export function Providers({ children }: { children: React.ReactNode }) {
  return <NextUIProvider>{children}</NextUIProvider>;
}

```

â†‘ã“ã‚Œã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã™ã€‚

ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã‚’è¨­å®šã™ã‚‹å ´åˆãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã®Layoutã«è¨­å®šã‚’ã™ã‚‹ã®ã§ã™ãŒ
ã§ã‚‚ãã“ã®Layoutã§ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã—ã¦è¨­å®šã‚’ã™ã‚‹ã¨
Next.jsã®ãƒ„ãƒªãƒ¼ã®é ‚ç‚¹(root)ã‹ã‚‰
ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚

ãã‚“ãªã¨ãã¯ã“ã®ã‚ˆã†ãªãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã§
NextUIã®ãƒ©ãƒƒãƒ—éƒ¨åˆ†ã ã‘ã‚’åˆ‡ã‚Šå‡ºã—ã¦ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ã—ã¦
ã‚ã¨ã¯ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«æˆ»ã—ã¦ã„ã¾ã™ã€‚


æ¬¡ã«ã€ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒšãƒ¼ã‚¸ã«ç§»å‹•ã—ã€â†‘ã“ã‚Œã‚’NextUIProviderã§ãƒ©ãƒƒãƒ—ã—ã¾ã™ï¼š


```src\app\page.tsx
????


```




â€»NextUIã¯è‡ªå‹•çš„ã«lightã¨darkã®2ã¤ã®ãƒ†ãƒ¼ãƒã‚’ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«è¿½åŠ ã—ã¾ã™ã€‚

ãƒ€ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€
dark/lightã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€ã©ã¡ã‚‰ã®ãƒ†ãƒ¼ãƒã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚

<html>
<body>
<main>
â†‘ã“ã‚Œã‚‰ã®ã‚¿ã‚°ã« ãƒ†ãƒ¼ãƒè¦ç´ (dark light)ã‚’classNameã«è¿½åŠ ã™ã‚‹ã ã‘ã§ã™ã€‚


ä¾‹
`src\app\layout.tsx
<html lang='en' className='dark'>

```

â†‘ã“ã®ã‚ˆã†ã«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¨­å®šã—ã¦ãƒ¢ãƒ¼ãƒ‰ã‚’åˆ‡ã‚Šæ›¿ãˆã¦ã„ã¾ã™ã€‚



æ¬¡ã«å…¨ä½“ã«åæ˜ ã™ã‚‹ã‚ˆã†ã«ãƒ©ãƒƒãƒ—ã—ã¾ã™ã€‚


```src\app\layout.tsx
import "@/styles/globals.css";
import React from "react";

import { Providers } from "./providers";

import { Metadata } from "next";

// Next.jsã§ã¯metadataã‚’ä½¿ã£ã¦ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®šã—ã¾ã™ã€‚
export const metadata: Metadata = {
  title: "VNS.BLUE",
  description: "VNS.BLUE",
  keywords: "VNS.BLUE, ã‚ªã‚¢ã‚·ã‚¹å®£è¨€",
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en" className="dark">
      <body suppressHydrationWarning={true}>
        <Providers>
          {/* â†“ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã«å½±éŸ¿ã‚’ä¸ãˆã¦ã„ã‚‹ */}
          <main className="flex flex-col items-center min-h-screen bg-background">
            {children}
          </main>
        </Providers>
      </body>
    </html>
  );
}

```




è©³ã—ãã¯ãƒ†ãƒ¼ãƒã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã”è¦§ãã ã•ã„ã€‚

Customize theme | NextUI - Beautiful, fast and modern React UI Library

https://nextui.org/docs/customization/customize-theme

NextUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ã†
"use client"ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’ä½¿ã‚ãªãã¦ã‚‚ã€
NextUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ç›´æ¥ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸ

â€»â†‘é‡è¦




```app/page.tsx
import {Button} from '@nextui-org/button';

...

    <div>
      <Button>Click me</Button>
    </div>

```



å‹•ä½œç¢ºèª

npm run dev

ãƒœã‚¿ãƒ³ãŒæŠ¼ã›ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¦ã€TailwindCSSã‚‚åŠ¹ã„ã¦ã„ã¾ã™ã€‚


ã“ã‚Œã§ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã§ã‚‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ("use client")ã«ã›ãšã«ã€
ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚


----------------------------------------

# å‹•çš„ã«ãƒ†ãƒ¼ãƒã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹

ãƒ†ãƒ¼ãƒã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm i next-themes

Heroiconsã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install @heroicons/react

touch src/components/ThemeSwitcher.tsx



```src\app\layout.tsx
import "@/styles/globals.css";
import React from "react";

import { Providers } from "./providers";

import { Metadata } from "next";

// Next.jsã§ã¯metadataã‚’ä½¿ã£ã¦ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®šã—ã¾ã™ã€‚
export const metadata: Metadata = {
  title: "VNS.BLUE",
  description: "VNS.BLUE",
  keywords: "VNS.BLUE, ã‚ªã‚¢ã‚·ã‚¹å®£è¨€",
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <body suppressHydrationWarning={true}>
        {/* â†“ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã«å½±éŸ¿ã‚’ä¸ãˆã¦ã„ã‚‹ */}
        <main className="flex flex-col items-center min-h-screen bg-background">
          <Providers>{children}</Providers>
        </main>
      </body>
    </html>
  );
}

```



```src\app\providers.tsx
"use client";

import { NextUIProvider } from "@nextui-org/react";
import { ThemeProvider as NextThemesProvider } from "next-themes";
import React from "react";

export function Providers({ children }: { children: React.ReactNode }) {
  return (
    <NextUIProvider>
      <NextThemesProvider attribute="class" defaultTheme="dark">
        {children}
      </NextThemesProvider>
    </NextUIProvider>
  );
}

```



touch src\components\ThemeSwitcher.tsx

```src\components\ThemeSwitcher.tsx
"use client";

import { MoonIcon } from "@heroicons/react/24/outline";
import { SunIcon } from "@heroicons/react/24/solid";
import { Switch } from "@nextui-org/switch";
import { useTheme } from "next-themes";
import { useEffect, useState } from "react";

export function ThemeSwitcher() {
  const [mounted, setMounted] = useState(false);
  // eslint-disable-next-line no-unused-vars
  const { theme, setTheme } = useTheme();

  useEffect(() => {
    setMounted(true);
  }, []);

  if (!mounted) return null;

  return (
    <div>
      <Switch
        defaultSelected
        size="lg"
        color="primary"
        startContent={<SunIcon />}
        endContent={<MoonIcon />}
        onValueChange={(isSelected) => setTheme(isSelected ? "light" : "dark")}
      />
    </div>
  );
}

```



```src\app\page.tsx
import { Button } from "@nextui-org/button";
import { createServerComponentClient } from "@supabase/auth-helpers-nextjs";
import { cookies } from "next/headers";
import Link from "next/link";

import { ThemeSwitcher } from "@/components/ThemeSwitcher";

import LogoutButton from "../components/LogoutButton";

export default async function Index() {
  const supabase = createServerComponentClient({ cookies });

  const {
    data: { user },
  } = await supabase.auth.getUser();

  return (
    <div className="flex flex-col items-center w-full min-h-screen bg-background">
      <nav className="flex justify-center w-full h-16 border-b border-b-foreground/10">
        <div className="flex items-center justify-between w-full max-w-4xl p-3 text-sm text-foreground">
          <div />
          <div>
            {user ? (
              <div className="flex items-center gap-4">
                Hey, {user.email}!
                <LogoutButton />
              </div>
            ) : (
              <Link
                href="/login"
                className="px-4 py-2 no-underline rounded-md bg-btn-background hover:bg-btn-background-hover"
              >
                Login
              </Link>
            )}
          </div>
        </div>
      </nav>
      {/* èªè¨¼ã«é–¢ä¿‚ã®ãªã„ã‚¨ãƒªã‚¢
      Buttonã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãªã©ãŠè©¦ã—ç”¨ã®ã‚¨ãƒªã‚¢ */}
      <h1 className="text-3xl font-bold underline">VNS.BLUE</h1>
      <Link href="/authui">authui</Link>

      <Button>Click me</Button>
      <ThemeSwitcher />
    </div>
  );
}

```



ã“ã‚Œã§å¤ªé™½ã¨æœˆã®ã‚¢ã‚¤ã‚³ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã¯ãšã§ã™ã€‚
ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ã¨ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ãŒåˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™ã€‚

ã“ã‚Œã§å‹•çš„ãªãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã®è¨­å®šã¯çµ‚äº†ã§ã™ã€‚


git tag addDarkmode

----------------------------------------

# å‚è€ƒ

NextUI - Beautiful, fast and modern React UI Library

https://nextui.org/

pacocoursey/next-themes: Perfect Next.js dark mode in 2 lines of code. Support System preference and any other theme with no flashing

https://github.com/pacocoursey/next-themes

ã€Next.jsã€‘NextUI ã§ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«å¯¾å¿œã™ã‚‹æ–¹æ³•

https://zenn.dev/nelf03/articles/b4e5eef6a3b99a



----------------------------------------

# Supabase ã®ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã‚’æ§‹ç¯‰

Docker Desktopã‚’åˆ©ç”¨ã—ã¦
ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã«Supabaseã‚’å°å…¥ã—ã¾ã™ã€‚

ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§Postgresã®DBã‚’è§¦ã£ã¦é–‹ç™ºã—ã¾ã™ã€‚
ãã—ã¦ãã‚Œã‚’ã‚µãƒ¼ãƒãƒ¼ã®DBã«åæ˜ ã•ã›ã‚‹æ–¹æ³•ã‚’å–ã‚Šã¾ã™ã€‚

ã“ã‚Œã‚‰ã¯â†“ã“ã®è¨˜äº‹ã‚’è¦‹ã¦ãã ã•ã„ã€‚

Supabase ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒ ï¼‹ ã‚µãƒ¼ãƒãƒ¼é‹ç”¨ 2023å¹´9æœˆ (with Next.js 13 App router) - Qiita

https://qiita.com/masakinihirota/items/be94b4c74a7850a4b79c



----------------------------------------

# Nextra ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼

ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚


ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒ†ãƒ¼ãƒ â€“ Nextra

https://nextra.site/docs/docs-theme/start

ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆã‚’åˆ©ç”¨ã—ã¦Vercelã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚


ã‚¢ãƒ—ãƒªã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ï¼’ã¤ã®ãƒªãƒã‚¸ãƒˆãƒªä½“åˆ¶ã«ãªã£ãŸã®ã§
VSCodeã®ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚



ãƒªãƒã‚¸ãƒˆãƒªãŒï¼’ã¤ã«ãªã£ãŸæ™‚
ãã‚Œãã‚Œç‹¬ç«‹ã—ã¦ã„ã‚‹ã®ã§åˆ¥ã€…ã«ç®¡ç†ã™ã‚‹ã‹ã€
ãã‚Œã¨ã‚‚ä¸€ã¤ã«ã¾ã¨ã‚ã¦ç®¡ç†ã™ã‚‹ã®ã‹ã€‚
ã‚’æ±ºã‚ã‚‹ã€‚

ï¼‘ã¤ã«ã™ã‚‹å ´åˆ
VSCodeã®ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã‚’åˆ©ç”¨ã™ã‚‹ã€‚

npmã€yarnã€pnpmã®ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹æ©Ÿèƒ½ã‚’åˆ©ç”¨ã—ã¦ãƒ¢ãƒãƒ¬ãƒæ§‹æˆã«ã™ã‚‹ã€‚

Turborepoã¨ã„ã†ãƒ¢ãƒãƒ¬ãƒå°‚ç”¨ãƒ„ãƒ¼ãƒ«ã‚’ã¤ã‹ã†ã€‚

ï¼‘ã¤ç›®ã¯ï¼’ã¤ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’ã¾ã¨ã‚ã¦VSCodeä¸Šã§ç®¡ç†ã™ã‚‹ã€‚
ï¼’ã¤ç›®ã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†ãƒ„ãƒ¼ãƒ«ã‚’åˆ©ç”¨ã™ã‚‹ã€‚
ï¼“ã¤ç›®ã¯å°‚ç”¨ãƒ„ãƒ¼ãƒ«ã‚’åˆ©ç”¨ã™ã‚‹ã€‚ ä»–ã«ã¯Nx learnç­‰ãŒã‚ã‚‹ã€‚

æœ€åˆã®æ–¹ã»ã©æ˜“ã—ã„ã€‚

ä»Šå›ã¯ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«Nextraã¨ã„ã†ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã†ã ã‘ã§ã™ã€‚
ãƒªãƒã‚¸ãƒˆãƒªã‚’ä¸€ã¤ã«ç®¡ç†ã™ã‚Œã°æ¥½ã ã‘ã©ã€ãã‚‚ãã‚‚Webã‚¢ãƒ—ãƒªã«ãã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãªã®ã§ãƒ¢ãƒãƒ¬ãƒæ§‹æˆã«ã—ã¦ã‚‚ä½•ã®æ„å‘³ã‚‚ãªã„ã€‚
ï¼’ã¤ã‚’ä¸€ç·’ã®å ´æ‰€ã«ç½®ãã ã‘ã§ã„ã„ã€‚
ã“ã‚Œã§ã¯ãƒ¢ãƒãƒ¬ãƒã«ã—ã¦ã‚‚gitç®¡ç†ãŒå¤šå°‘ã¯æ¥½ã«ãªã‚‹ã ã‘ã€‚
ãªã®ã§ï¼‘ç•ªç›®ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚


----------------------------------------

ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒ†ãƒ¼ãƒ â€“ Nextra

https://nextra.site/docs/docs-theme/start


ã“ã‚Œã¯â†‘ã®Deployãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã ã‘ã§å…¬é–‹ã•ã‚Œã¾ã™ã€‚
ã‚ã¨ã¯GitHubçµŒç”±ã§ãƒ­ãƒ¼ã‚«ãƒ«ä¸Šã§VSCodeã‚’ä½¿ã£ã¦ç·¨é›†ã—ã¦ã„ãã ã‘ã§ã™ã€‚

ç‰¹ã«é›£ã—ã„ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚



ã“ã‚Œã§Webã‚¢ãƒ—ãƒªã¨ã€ãã®èª¬æ˜ã‚’ã™ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ï¼’ã¤ã®ãƒªãƒã‚¸ãƒˆãƒªã«ãªã‚Šã¾ã—ãŸã€‚

ã“ã‚Œã‚’ä¸€ç®‡æ‰€ã§ç®¡ç†ã™ã‚‹ãŸã‚ã«VSCodeã®ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹æ©Ÿèƒ½ã‚’ä½¿ã„ã¾ã™ã€‚

é–‹ããŸã„ãƒ•ã‚©ãƒ«ãƒ€ã‚’è¿½åŠ ç™»éŒ²ã™ã‚‹ã ã‘ã§å®Œæˆã§ã™ã€‚

VSCodeã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰
ãƒ•ã‚©ãƒ«ãƒ€ã‚’ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã«è¿½åŠ  ã‹ã‚‰æŒ‡å®šã—ãŸãƒ•ã‚©ãƒ«ãƒ€ã‚’è¿½åŠ ã—ã¦ãã¾ã™ã€‚

ä¿å­˜ã™ã‚‹ã¨
***.code-workspace
ãŒä½œæˆã•ã‚Œã¾ã™ã®ã§ã€
æ¬¡å›ã‹ã‚‰ã¯ã“ã‚Œã‚’é–‹ã„ã¦VSCodeã‚’ç«‹ã¡ä¸Šã’ã‚Œã°è‰¯ã„ã ã‘ã§ã™ã€‚


ä½œæˆã—ãŸ
***.code-workspace
ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§ç«‹ã¡ä¸ŠãŒã‚Šã¾ã™ã€‚

â€»ç·¨é›†ã™ã‚‹æ™‚ã¯ ç¾åœ¨ã®pathã«æ³¨æ„ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ç·¨é›†ã—ã¦ã‹ã‚‰CLIã‚’å®Ÿè¡Œã—ã‚ˆã†ã¨ã—ã¦ã‚‚ã€ç¾åœ¨ã©ã“ã®Rootã«ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’ã™ã¹ã¦é–‰ã˜ã¦ã‹ã‚‰æ–°ã—ãé–‹ãã¨ç¾åœ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚ã‚‹å ´æ‰€ã«ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ãŒé–‹ãã¾ã™ã€‚

ç¾åœ¨é–‹ã„ã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®rootã«ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ãŒé–‹ãã¾ã™ã€‚



----------------------------------------

vitest

ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã«
vitest
React Testing Library
ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚



----------------------------------------

vitestã‚’åˆã‚ã¦å°å…¥ã™ã‚‹ã®ã§
Next.js å…¬å¼ã‚µãƒ³ãƒ—ãƒ« with-vitest ã‚’å‚è€ƒã«
vitestã‚’è¿½åŠ ã—ã¾ã™ã€‚

next.js/examples/with-vitest at canary Â· vercel/next.js

https://github.com/vercel/next.js/tree/canary/examples/with-vitest

vitestã§ã¯ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’ `__tests__` ã«ç½®ãã“ã¨ã‚‚ã§ãã¾ã™ã—ã€
App Router å†…ã§ä»–ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¨ä¸€ç·’ã«é…ç½®ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

ä¾‹ãˆã° â†“ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ã™ãéš£ã«ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ãã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚

ä¾‹
src/component.tsx			ï¼œï¼œã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
src/component.test.tsx		ï¼œï¼œã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«


â€»ã“ã®å‹•ä½œã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ãå°‚ç”¨ãƒ•ã‚©ãƒ«ãƒ€(__test__)ã§ã¯ãªãã€ `src/app`å†…ã«ä¸€ç·’ã«ç½®ã„ã¦ã„ã¾ã™ã€‚

ã•ã‚‰ã«ã™ã™ã‚ã¦ â†‘component.tsx ãƒ•ã‚¡ã‚¤ãƒ«å†…ã« ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

å‚è€ƒ
In-source testing | Guide | Vitest

https://vitest.dev/guide/in-source.html#setup



ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm i @vitejs/plugin-react
â€»ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ -D ãƒ•ãƒ©ã‚°ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨èªè­˜ã—ãªã„ã€‚

npm i server-only

npm i -D @testing-library/jest-dom @testing-library/react @testing-library/user-event @vitest/ui jsdom vitest



ãƒ„ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

typesync

typesyncã¯ã€TypeScriptã®å‹å®šç¾©ã‚’èª¿ã¹ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã‚Œã¾ã™ã€‚
package.jsonã‚’è¦‹ã¦è¶³ã‚Šãªã„å‹å®šç¾©ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒã‚ã‚Œã°è‡ªå‹•ã§è¿½åŠ ã—ã¦ãã‚Œã¾ã™ã€‚

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm i -D typesync

ä½¿ã„æ–¹
npx typesync



## VSCodeæ‹¡å¼µæ©Ÿèƒ½

Vitest - Visual Studio Marketplace

https://marketplace.visualstudio.com/items?itemName=ZixuanChen.vitest-explorer

ã“ã®æ‹¡å¼µæ©Ÿèƒ½ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã«ã¯ã€npm run test ã‚’å®Ÿè¡Œã•ã›ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
(vitest ã® ã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰)

VSCodeã®ã‚¨ãƒ‡ã‚£ã‚¿ç”»é¢ã®è¡Œã®å·¦ã«GREENã‚„REDã®ã‚¢ã‚¤ã‚³ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚
å·¦ã‚¯ãƒªãƒƒã‚¯ã§ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
å³ã‚¯ãƒªãƒƒã‚¯ã§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒé–‹ãã¾ã™ã€‚



## ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®è¿½åŠ 

```package.json
    "test": "vitest",
    "test:ui": "vitest --ui"
    "coverage": "vitest run --coverage",

```

testã¯ã‚¦ã‚©ãƒƒãƒå½¢å¼ã§ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ä¿å­˜ã™ã‚‹ãŸã³ã«ãƒ†ã‚¹ãƒˆãŒå›ã‚Šã¾ã™ã€‚
test:uiã¯ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ†ã‚¹ãƒˆçµæœã‚’è¡¨ç¤ºã—ã¦ãã‚Œã¾ã™ã€‚



vitestã®ã‚³ãƒ³ãƒ•ã‚£ã‚°è¨­å®š

touch vitest.config.ts

```vitest.config.ts
/// <reference types="vitest" />
import react from "@vitejs/plugin-react";
import { defineConfig } from "vitest/config";

// https://vitejs.dev/config/
export default defineConfig({
  plugins: [react()],
  test: {
    globals: true,
    environment: "jsdom",
    include: ["app/**/*.test.{js,ts,jsx,tsx}"],
  },
});

```


App routerã§æ›¸ã‹ã‚Œã‚‹ **åŸºæœ¬çš„ãª4ç¨®é¡ã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰** ã‚’èª¿ã¹ã¾ã™ã€‚

1. åŸºæœ¬ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
1. Hooksã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
1. å‹•çš„ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
1. RSC(React Server Components)ã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰

# ã‚µãƒ³ãƒ—ãƒ«01 åŸºç¤ ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ãã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰

mkdir src\__tests__\client\
touch src\__tests__\client\page.tsx
touch src\__tests__\client\page.test.tsx


```src\__tests__\client\page.tsx
"use client"
import React from "react"

export default function ClientComponent() {
  return <h1>Client Component</h1>
}

```



```src\__tests__\client\page.test.tsx
import { render, screen } from "@testing-library/react"
import React from "react"
import { expect, test } from "vitest"

import ClientComponent from "./page"

test("App Router: Works with Client Components", () => {
  render(<ClientComponent />)
  expect(
    screen.getByRole("heading", { level: 1, name: "Client Component" })
  ).toBeDefined()
})

```

ãƒ†ã‚¹ãƒˆã®å‹•ä½œç¢ºèª

npm test



ãƒ–ãƒ©ã‚¦ã‚¶ã§è¡¨ç¤º

```app/page.tsx
import ClientComponent from "@/__tests__/client/page"

ãƒ»ãƒ»ãƒ»

      <h1 className="text-3xl font-bold underline">VNS.BLUE</h1>
      {/* ãƒ†ã‚¹ãƒˆã¨ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ« 4ç¨®é¡ */}
      <ClientComponent />

```

å‹•ä½œç¢ºèª

npm run dev


# ã‚µãƒ³ãƒ—ãƒ«02 Hooksã‚’ä½¿ç”¨ã—ãŸã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ãã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰

ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

mkdir src\__tests__\components
touch src\__tests__\components\component.tsx
touch src\__tests__\components\component.test.tsx

```src\__tests__\components\component.tsx
"use client"

import React from "react"
import { useState } from "react"

const Counter = () => {
  const [count, setCount] = useState(0)
  return (
    <div>
      ãƒ†ã‚¹ãƒˆç”¨ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼
      <h2>{count}</h2>
      <button type="button" onClick={() => setCount(count + 1)}>
        +
      </button>
    </div>
  )
}

export default Counter

```

useStateã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã§ 'use client'ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’ä»˜ã‘ã¾ã™ã€‚



ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«

```src\__tests__\components\component.test.tsx
import { render, screen, fireEvent } from "@testing-library/react"
import React from "react"
import { expect, test } from "vitest"

import Component from "./component"

test("App Router: Works with Client Components (React State)", () => {
  render(<Component />)
  expect(screen.getByRole("heading", { level: 2, name: "0" })).toBeDefined()
  fireEvent.click(screen.getByRole("button"))
  expect(screen.getByRole("heading", { level: 2, name: "1" })).toBeDefined()
})

```

ãƒ†ã‚¹ãƒˆã®å‹•ä½œç¢ºèª

npm test



ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã«ã‚‚è¡¨ç¤ºã•ã›ã¾ã™ã€‚



```app\page.tsx
import Counter from "@/__tests__/components/component"

ãƒ»ãƒ»ãƒ»

      {/* ãƒ†ã‚¹ãƒˆã¨ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ« 4ç¨®é¡ */}
      <ClientComponent />
      <Counter />

```

å‹•ä½œç¢ºèª

npm run dev



# ã‚µãƒ³ãƒ—ãƒ«03 å‹•çš„ãªãƒ«ãƒ¼ãƒˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ãŸå ´åˆã®ãƒ†ã‚¹ãƒˆ

å‹•çš„ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆãªã®ã§appãƒ•ã‚©ãƒ«ãƒ€ã®ä¸‹ã«ç½®ãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

mkdir src\app\blog\[slug]
touch src\app\blog\[slug]\page.tsx
touch src\app\blog\[slug]\page.test.tsx

```src\app\blog\[slug]\page.tsx
type Params = {
  params: {
    slug: string
  }
}

export async function generateMetadata({ params }: Params) {
  return { title: `Post: ${params.slug}` }
}

export default function Page({ params }: Params) {
  return <h1>Slug: {params.slug}</h1>
}

```



```src\app\blog\[slug]\page.test.tsx
import { render, screen } from "@testing-library/react"
import { expect, test } from "vitest"

import Page from "./page"

test("App Router: Works with dynamic route segments", () => {
  render(<Page params={{ slug: "Test" }} />)
  expect(
    screen.getByRole("heading", { level: 1, name: "Slug: Test" })
  ).toBeDefined()
})

```

ãƒ†ã‚¹ãƒˆã®å‹•ä½œç¢ºèª

npm test



ã“ã®ãƒ†ã‚¹ãƒˆã¯ã€Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ`Page`ãŒã€å‹•çš„ãªãƒ«ãƒ¼ãƒˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦æ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã®ãƒ†ã‚¹ãƒˆã§ã™ã€‚

ãƒ†ã‚¹ãƒˆã§ã¯ã€`render()`é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦`Page`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã—ã€`params`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«`{ slug: "Test" }`ã‚’æ¸¡ã—ã¦ã„ã¾ã™ã€‚ãã®å¾Œã€`screen.getByRole()`é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚ŒãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰`<h1>`è¦ç´ ã‚’å–å¾—ã—ã€ãã®ãƒ†ã‚­ã‚¹ãƒˆãŒ`Slug: Test`ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚

ã¤ã¾ã‚Šã€ã“ã®ãƒ†ã‚¹ãƒˆã¯ã€`Page`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒã€å‹•çš„ãªãƒ«ãƒ¼ãƒˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦ã€æ­£ã—ã`slug`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚Šã€è¡¨ç¤ºã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚



## ãƒ–ãƒ©ã‚¦ã‚¶ã«è¡¨ç¤ºã—ã¾ã™ã€‚

http://localhost:3000/blog/123

123ãŒslugã«ã‚ãŸã‚Šã€å‹•çš„ãªãƒšãƒ¼ã‚¸ç”Ÿæˆã‚’ã—ã¦ãã‚Œã¾ã™ã€‚

ã“ã®æ©Ÿèƒ½ã‚’ä½¿ã†ã“ã¨ã§æ—¥ä»˜ï¼‹ã‚¿ã‚¤ãƒˆãƒ«ã¨ã„ã£ãŸURLã‚’äº‹å‰ã«ç”¨æ„ã—ãªãã¦ã‚‚å‹•çš„ã«ãƒšãƒ¼ã‚¸ãŒä½œæˆã§ãã¾ã™ã€‚



Topãƒšãƒ¼ã‚¸ã‚’ç·¨é›†ã—ã¾ã™ã€‚

```app\page.tsx

      {/* ãƒ†ã‚¹ãƒˆã¨ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ« 4ç¨®é¡ */}
      <ClientComponent />
      <Counter />
      <Link href={`/blog/${blogId}`}>Blogãƒšãƒ¼ã‚¸</Link>

```

å‹•ä½œç¢ºèª

npm run dev



# ã‚µãƒ³ãƒ—ãƒ«04 RSCã®ãƒ†ã‚¹ãƒˆ

React server componentsã®ãƒ†ã‚¹ãƒˆ

ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆã€‚

Hooksã‚‚ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªæ“ä½œã‚‚ãªã„ã®ã§ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«å‡ºæ¥ã¾ã™ã€‚

mkdir src\__tests__\rsc
touch src\__tests__\rsc\page.test.tsx
touch src\__tests__\rsc\page.tsx


```app/rsc/page.tsx
// import 'server-only' does not currently
// work with Vitest

import React from "react"

export default function Page() {
  return <h1>App Router</h1>
}

```

server-onlyã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§å®Œå…¨ã«ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§ã®ã¿å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚
ã—ã‹ã—ç¾åœ¨vitestã§å‹•ãã¾ã›ã‚“ã€‚



```app/rsc/page.test.tsx
import { render, screen } from "@testing-library/react"
import React from "react"
import { expect, test } from "vitest"

import Page from "./page"

test("App Router: Works with Server Components", () => {
  render(<Page />)
  expect(
    screen.getByRole("heading", { level: 1, name: "App Router" })
  ).toBeDefined()
})

```

ãƒ†ã‚¹ãƒˆã®å‹•ä½œç¢ºèª

npm test



topãƒšãƒ¼ã‚¸ã«è¡¨ç¤ºã•ã›ã¾ã™ã€‚

```app\page.tsx
import Page from "@/__tests__/rsc/page"

      {/* ãƒ†ã‚¹ãƒˆã¨ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ« 4ç¨®é¡ */}
      <ClientComponent />
      <Counter />
      <Link href={`/blog/${blogId}`}>Blogãƒšãƒ¼ã‚¸</Link>
      <Page />

```



å‹•ä½œç¢ºèª

npm run dev



ä»¥ä¸Š4ã¤ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã§ã—ãŸã€‚



----------------------------------------

# Storybook

Storybookã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚„ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€å…¬å¼ã‚µã‚¤ãƒˆã§å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ãã¡ã‚‰ã‚’å‚ç…§ã™ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚

Component Encyclopedia | Storybook

https://storybook.js.org/showcase

ã“ã“ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€å¤šæ•°ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚„ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ãŒå…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚

ãŸã ã—ã€å¤ã„å ´åˆã¯ã€SF3 (ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ« version 3) ã‚’ä½¿ç”¨ã—ã¦ã„ãªã„å ´åˆãŒã‚ã‚‹ãŸã‚ã€Sortã‚’Newertã«ã—ã¦å‚è€ƒã«ã™ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚

å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®GitHubãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€`stories.tsx`ã§æ¤œç´¢ã™ã‚‹ã“ã¨ã§ã€ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚



## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

npx storybook@latest init



## å®Ÿè¡Œæ–¹æ³•

npm run storybook

http://localhost:6006/



## Storybookã®è¨­å®š

Storybook ã§ã‚‚ TailwindCSS ãŒä½¿ãˆã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

`import "../src/styles/globals.css"`
ã‚’ â†“ ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ ã—ã¾ã™ã€‚

```.storybook\preview.ts
import type { Preview } from "@storybook/react"
import "../src/styles/globals.css"

const preview: Preview = {
  parameters: {
    actions: { argTypesRegex: "^on[A-Z].*" },
    controls: {
      matchers: {
        color: /(background|color)$/i,
        date: /Date$/,
      },
    },
  },
}

export default preview

```

----------------------------------------

# å®šå‹æ–‡ã‚’è‡ªå‹•ç”Ÿæˆ

ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ãƒ„ãƒ¼ãƒ«plopã‚’ã¤ã‹ã£ã¦

ãƒ™ãƒ¼ã‚¹ã¨ãªã‚‹3ç¨®é¡ã®

* é–¢æ•°ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
* ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
* ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«

ã‚’ã‚³ãƒãƒ³ãƒ‰ä¸€ã¤ã§ä½œã‚Šã¾ã™ã€‚



ã‚³ãƒ¼ãƒ‰ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼å…¥é–€ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è‡ªå‹•ç”Ÿæˆãƒ„ãƒ¼ãƒ«plopã‚’ä½¿ç”¨ã—ãŸãƒãƒ³ã‚ºã‚ªãƒ³ (Next.js app router Storybook TailwindCSS Jestã®è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åŒæ™‚ã«ä½œã‚‹) - Qiita

https://qiita.com/masakinihirota/items/bf0b9caedc858d0f23dd


## ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®æ›¸ãæ–¹ã®ãƒ«ãƒ¼ãƒ«

* æ‹¡å¼µå­

ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¯ .hbs ã¨ã„ã†æ‹¡å¼µå­ã‚’ä½¿ã„ã¾ã™ã€‚

* ãƒ‘ã‚¹

{{path}}

* åå‰

{{name}}

* åå‰ã®å¤‰æ›´

ãƒ‘ã‚¹ã‚«ãƒ«ã‚±ãƒ¼ã‚¹
{{pascalCase name}}

CurrentUserItem ã®ã‚ˆã†ã«æ›¸ãã¾ã™ã€‚
è¦ç´ èª( current user item )ã®æœ€åˆã‚’å¤§æ–‡å­—ã§æ›¸ãå§‹ã‚ã¾ã™ã€‚

ä¾‹ãˆã°ã€nameãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒ"foo-bar"ã®å ´åˆã€{{ pascalCase name }}ã¯"FooBar"ã«ãªã‚Šã¾ã™ã€‚

ã‚±ãƒãƒ–ã‚±ãƒ¼ã‚¹
{{ kebabCase name}}

current-user-item ã®ã‚ˆã†ã«æ›¸ãã¾ã™ã€‚
ãƒã‚¤ãƒ•ãƒ³ ã§è¦ç´ èª( current user item )ã‚’é€£çµã—ã¾ã™ã€‚

ä¾‹ãˆã°ã€nameãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒ"FooBar"ã®å ´åˆã€{{ kebabCase name }}ã¯"foo-bar"ã«ãªã‚Šã¾ã™ã€‚



## VSCode ã®æ‹¡å¼µæ©Ÿèƒ½

File Templates - Visual Studio Marketplace
https://marketplace.visualstudio.com/items?itemName=SamKirkland.plop-templates

â€»åŒã˜åå‰ã®VSCodeæ‹¡å¼µæ©Ÿèƒ½ãŒã„ãã¤ã‹ã‚ã‚‹ã®ã§é–“é•ãˆãªã„ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚



ã“ã® VSCode ã®æ‹¡å¼µæ©Ÿèƒ½ã¯ã€å³ã‚¯ãƒªãƒƒã‚¯ã‹ã‚‰ plop ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ã£ã¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’è‡ªå‹•ç”Ÿæˆã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ä»Šã®ã¨ã“ã‚ãƒã‚¦ã‚¹ã‹ã‚‰ã§ã‚‚è‡ªå‹•ç”Ÿæˆã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã ã‘ã§ã™ã€‚
è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§pathã‚’å›ºå®šã—ãªã‘ã‚Œã°ãƒã‚¦ã‚¹ã§æŒ‡å®šã—ãŸå ´æ‰€ã«è‡ªå‹•ç”ŸæˆãŒå‡ºæ¥ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚


ã“ã®æ‹¡å¼µæ©Ÿèƒ½ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸ plop ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚



## plop ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ãƒ„ãƒ¼ãƒ«Plop ã‚’ä½¿ã†ã«ã¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãŒå¿…è¦ã§ã™ã€‚

plop ã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

npm install -g plop

â€»å¾Œã§ç´¹ä»‹ã™ã‚‹plopå°‚ç”¨ã®VSCodeæ‹¡å¼µæ©Ÿèƒ½ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãŠãã¨ç°¡å˜ã«ä½¿ç”¨ã§ãã¾ã™ã€‚ãã†ã§ãªã„å ´åˆã€ã„ãã¤ã‹ã®è¨­å®šãŒå¿…è¦ã«ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ã€



## plopã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯rootç›´ä¸‹ã«ç½®ãã¾ã™ã€‚

touch plopfile.mjs


```plopfile.mjs
/* eslint-disable import/no-anonymous-default-export */
// ESLintã®ãƒ«ãƒ¼ãƒ«ã‚’ç„¡åŠ¹ã«ã™ã‚‹ãŸã‚ã®ã‚³ãƒ¡ãƒ³ãƒˆã§ã™ã€‚import/no-anonymous-default-exportã¨ã„ã†ãƒ«ãƒ¼ãƒ«ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãŒç„¡åé–¢æ•°ã§ã‚ã‚‹å ´åˆã«è­¦å‘Šã‚’å‡ºã™ãƒ«ãƒ¼ãƒ«ã§ã™ã€‚ã“ã®ãƒ«ãƒ¼ãƒ«ã‚’ç„¡åŠ¹ã«ã™ã‚‹ã“ã¨ã§ã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãŒç„¡åé–¢æ•°ã§ã‚ã£ã¦ã‚‚ã€è­¦å‘ŠãŒå‡ºãªããªã‚Šã¾ã™ã€‚
export default function (
  // JSDocã‚³ãƒ¡ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦ã€import('plop').NodePlopAPIã¨ã„ã†å‹ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯ã€plopã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒæä¾›ã™ã‚‹NodePlopAPIã¨ã„ã†å‹ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ã“ã®å‹ã¯ã€plopfile.mjsã§ä½¿ç”¨ã•ã‚Œã‚‹plopã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å‹ã‚’å®šç¾©ã—ã¦ã„ã¾ã™ã€‚
  /** @type {import('plop').NodePlopAPI} */
  plop
) {
  plop.setGenerator("component", {
    description: "Create a new component",
    prompts: [
      {
        type: "input",
        name: "path",
        message: "ã©ã“ã«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ç½®ãã¾ã™ã‹ï¼Ÿ"
      },
      {
        type: "input",
        name: "name",
        message: "ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
      },
      {
        type: "list",
        name: "componentType",
        message: "Component type",
        // ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
        choices: ["server", "client"]
      }
    ],
    actions: [
      {
        type: "add",
        path: "src/components/{{componentType}}/{{path}}/{{pascalCase name}}/{{name}}.tsx",
        templateFile: "templates/component/component.tsx.hbs"
      },
      {
        type: "add",
        path: "src/components/{{componentType}}/{{path}}/{{pascalCase name}}/{{name}}.test.tsx",
        templateFile: "templates/component/component.test.tsx.hbs"
      },
      {
        type: "add",
        path: "src/components/{{componentType}}/{{path}}/{{pascalCase name}}/{{name}}.stories.tsx",
        templateFile: "templates/component/component.stories.tsx.hbs"
      }
    ]
  })
}

```


```.prettierignore
# ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
**/*.hbs


```

.hbsã®æ‹¡å¼µå­ã¯ã€Prettierã§å¯¾å¿œã—ã¦ã„ãªã„ãŸã‚ã€ã‚³ãƒ¼ãƒ‰æ•´å½¢ã®å¯¾è±¡ã‹ã‚‰å¤–ã—ã¾ã—ãŸã€‚






## plop ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜å ´æ‰€

mkdir templates\component

ã“ã®ãƒ•ã‚©ãƒ«ãƒ€ã®ä¸­ã«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ãã¾ã™ã€‚

ä¾‹
templates\component\[ãƒ•ã‚¡ã‚¤ãƒ«å].tsx.hbs

----------------------------------------

## ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ

touch templates\component\component.tsx.hbs

```templates\component\component.tsx.hbs
// "use client";

import React from "react";
import { FC } from 'react'; export

default function {{pascalCase name}}() {
	return <h1>{{pascalCase name}}</h1>;
}

```



## ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ

touch templates\component\component.test.tsx.hbs

```templates\component\component.test.tsx.hbs
import { render, screen } from "@testing-library/react";
import React from "react";
import { expect, test } from "vitest";

import {{pascalCase name}} from "./{{name}}";

test("template component", () => {
  render(<{{pascalCase name}} />);
  expect(
    screen.getByRole("heading", { level: 1, name: "{{pascalCase name}}" })
  ).toBeDefined();
});

// // Vitestã®åŸºæœ¬æ§‹æ–‡
// describe("Vitest", () => {
//   beforeAll(() => {
//     // console.log("ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«é–‹å§‹å‰");
//   });
//   afterAll(() => {
//     // console.log("ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«çµ‚äº†å¾Œ");
//   });

//   beforeEach(() => {
//     // console.log("ãƒ†ã‚¹ãƒˆé–‹å§‹å‰");
//   });
//   afterEach(() => {
//     // console.log("ãƒ†ã‚¹ãƒˆçµ‚äº†å¾Œ");
//   });

//   test("ãƒãƒƒãƒãƒ£ãƒ¼", () => {
//     expect(1 + 1).toBe(2);

//     expect({foo: "bar"}).toEqual({foo: "bar"});
//     expect([1, 2, 3]).toStrictEqual([1, 2, 3]);

//     expect(undefined).toBeUndefined();
//     expect("foo").toBeDefined();

//     expect(true).toBeTruthy();
//     expect(false).toBeFalsy();

//     expect(null).toBeNull();
//     expect("foo").not.toBeNull();

//     expect("foo").toHaveLength(3);
//     expect([1, 2, 3]).toHaveLength(3);

//     expect({foo: "bar", baz: "hoge"}).toHaveProperty("foo");
//     expect(["foo", "bar"]).toContain("foo");
//     expect([{foo: "bar"}, {foo: "hoge"}]).toContainEqual({foo: "bar"});
//     expect("foo12345").toMatch(/foo\d{5}/);

//     class CustomError extends Error {
//     }

//     const throwError = (message: string) => {
//       throw new CustomError(message);
//     };
//     expect(() => throwError("")).toThrow(); // ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã“ã¨ã‚’æ¤œè¨¼
//     expect(() => throwError("")).toThrow(CustomError); // é€å‡ºã—ãŸã‚¨ãƒ©ãƒ¼ã®å‹åˆ¤å®š
//   });

//   test.each`
//     unitPrice | quantity | expected
//     ${100}    | ${1}     | ${100}
//     ${150}    | ${2}     | ${300}
//     ${200}    | ${0}     | ${0}
//   `(
//     "ãƒ‘ãƒ©ãƒ¡ã‚¿ãƒ©ã‚¤ã‚ºãƒ‰ãƒ†ã‚¹ãƒˆ:$unitPrice * $quantity = $expected",
//     ({unitPrice, quantity, expected}) => {
//       expect(unitPrice * quantity).toBe(expected);
//     }
//   );

//   test("ãƒ¢ãƒƒã‚¯", () => {
//     const mockFn = vi.fn((a: number) => a * 10);
//     mockFn(1);
//     mockFn(2);

//     expect(mockFn.mock.calls).toHaveLength(2);

//     expect(mockFn.mock.calls[0][0]).toBe(1); // 1å›ç›®ã®å‘¼å‡ºã®å¼•æ•°
//     expect(mockFn.mock.calls[1][0]).toBe(2); // 2å›ç›®ã®å‘¼å‡ºã®å¼•æ•°

//     expect(mockFn.mock.results[0].value).toBe(10); // 1å›ç›®ã®å‘¼å‡ºã®æˆ»ã‚Šå€¤
//     expect(mockFn.mock.results[1].value).toBe(20); // 1å›ç›®ã®å‘¼å‡ºã®æˆ»ã‚Šå€¤
//   });

//   test("Expectãƒãƒƒãƒãƒ£ãƒ¼ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£", () => {
//     const obj = {
//       foo: "bar",
//       count: 10,
//       id: "123-456",
//       nested: {hoge: true, fuga: false},
//       array: [1, 2, 3],
//     };
//     expect(obj).toEqual({
//       foo: expect.any(String), // String
//       count: expect.anything(), // å€¤ã¯ä½•ã§ã‚‚OK
//       id: expect.stringMatching(/\d{3}-\d{3}/), // æ­£è¦è¡¨ç¾
//       nested: expect.objectContaining({hoge: true}), // æŒ‡å®šã—ãŸkey-valueãŒå«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨
//       array: expect.arrayContaining([1, 2]), // é…åˆ—ã«è¦ç´ ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨
//     });
//   });

//   test("ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ†ã‚¹ãƒˆ", () => {
//     const html = `<div class="container">
//   <article>
//     <p class="title">UIç”Ÿæˆçµæœ</p>
//   </article>
// </div>`;
//     expect(html).toMatchSnapshot();
//   });
// });

```



## Storybook ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ

touch templates\component\component.stories.tsx.hbs

```templates\component\component.stories.tsx.hbs
import type { Meta, StoryObj } from "@storybook/react";

// ä½œã£ãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚
import {{pascalCase name}}, { {{pascalCase name}}Props } from './{{name}}';

type T = typeof {{pascalCase name}}

const meta = {
  // Storybookã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚¿ã‚¤ãƒˆãƒ«ã‚’å®šç¾©ã—ã¾ã™ã€‚
  title: "{{componentType}}/{{pascalCase name}}",
  component: {{pascalCase name}},
  parameters: {},
  argTypes: {
  },
} satisfies Meta<T>;

export default meta;
type Story = StoryObj<T>;

// Storybookã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è‰²ã€…ãªãƒ‘ãƒ¼ã‚¿ãƒ¼ãƒ³ã‚’å®šç¾©ã—ã¾ã™ã€‚
export const {{pascalCase name}}First: Story = {};
export const {{pascalCase name}}Second: Story = {};
export const {{pascalCase name}}Third: Story = {
    args : {
  },
};

```


å‹•ä½œç¢ºèª

plop

plopã‚³ãƒãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«ã‚³ãƒ¼ãƒ‰ã®è‡ªå‹•ç”ŸæˆãŒè¡Œã‚ã‚Œã¾ã™ã€‚
å¼•æ•°ã« ãƒ•ã‚©ãƒ«ãƒ€åã€ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ã¤ã‘ã‚‹ã“ã¨ã‚‚å‡ºæ¥ã¾ã™ã€‚

â†“å®Ÿéš›ã®å‹•ä½œä¾‹

```
> plop
? ã©ã“ã«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ç½®ãã¾ã™ã‹ï¼Ÿ mount
? ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ basement
? Component type server
âœ”  ++ \src\components\server\mount\Basement\basement.tsx
âœ”  ++ \src\components\server\mount\Basement\basement.test.tsx
âœ”  ++ \src\components\server\mount\Basement\basement.stories.tsx

```


ãƒ†ã‚¹ãƒˆã®ã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ã¨Storybookã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’ç«‹ã¡ä¸Šã’ã¾ã™ã€‚

npm run test

npm run storybook

ãã‚Œãã‚Œå‹•ä½œã®ç¢ºèªãŒã§ããŸã‚‰ã“ã®é …ç›®ã¯çµ‚äº†ã§ã™ã€‚



â€»plopã®é …ç›®ã®æœ€å¾Œã«
ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã‚’ã™ã‚‹ã®ãªã‚‰ã°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œã‚‹ã¨ã
ã‚ã‹ã‚Šã‚„ã™ã„ã‚¨ãƒ©ãƒ¼ã‚’å…¥ã‚Œã¦ãŠãã¨ã„ã„ã¨æ€ã„ã¾ã™ã€‚
ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºãªã‚‰ã°ä»–ã®ãƒ†ã‚¹ãƒˆã‚’GREENã«ã—ã¦ã‹ã‚‰
æ–°ã—ã„æ¬¡ã®é–‹ç™ºã«ã¤ãªã’ã¦ã€ãã®æœ€åˆã®ãƒ†ã‚¹ãƒˆã¯REDã«
ã—ãŸã»ã†ãŒã„ã„ã¨ãŠã‚‚ã„ã¾ã™ã€‚



Consistency Made Simple : PLOP

https://plopjs.com/



----------------------------------------

# ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º

â†“è¨˜äº‹ã«ã—ã¾ã—ãŸã€‚

åŸºæœ¬çš„ãª Next.js 13 App router ã§ã® vitest ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®æ›¸ãæ–¹ (ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰å§‹ã‚ã‚‹ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º Next.js 13 App routerã€ vitest ã€ Storybookã€ Plop) - Qiita

https://qiita.com/masakinihirota/items/3c7ef09cbaebfa702bba



# ç†æƒ³çš„ãªãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ã‚µã‚¤ã‚¯ãƒ«

1. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è¨­è¨ˆã‚’ã—ã¾ã™ã€‚

1. plopã‚’ä½¿ã„ `*.tsx` (ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«)ã‚’ä½œæˆã—ã¾ã™ã€‚åŒæ™‚ã« `*.stories.js` (Storybookãƒ•ã‚¡ã‚¤ãƒ«)ã¨ `*.test.tsx` (ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«)ã‚‚ä½œæˆã—ã¾ã™ã€‚

1. ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º vitest ã‚’ä½¿ã£ã¦ã‚µã‚¤ã‚¯ãƒ«ã‚’å›ã—ã¾ã™ã€‚
    * ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¾ã™ã€‚ RED
    * ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã¾ã™ã€‚ GREEN
    * Storybookã§å‹•ä½œç¢ºèªã‚’ã—ã¾ã™ã€‚
    * ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚’è¡Œã„ã¾ã™ã€‚ Refactoring
å®Œæˆã«è¿‘ã¥ãã¾ã§ç¹°ã‚Šè¿”ã—ã¾ã™ã€‚

1. è¨­è¨ˆå›³é€šã‚Šã«å®Œæˆã•ã›ã¾ã™ã€‚

1. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æœ¬ä½“ã«å–ã‚Šè¾¼ã¿ã¾ã™ã€‚

ä»¥ä¸Šã‚’ç¹°ã‚Šè¿”ã—ã¾ã™ã€‚



# å‰æçŸ¥è­˜

## ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³

ç°¡å˜ã«æ›¸ãã¨ã€åŒã˜å ´æ‰€ã«ã‚³ãƒ¼ãƒ‰ã¨ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ã„ã¦ãŠã„ãŸã»ã†ãŒä¿å®ˆã—ã‚„ã™ããªã‚‹ã®ã§ã¯ãªã„ã‹ã¨ã„ã†è€ƒãˆæ–¹ã€‚

## Next.js App router ã«ãŠã‘ã‚‹ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

Next.js ã§é–‹ç™ºã™ã‚‹ä¸Šã§çŸ¥ã£ã¦ãŠãçŸ¥è­˜

Next.jsã§ã¯åŸºæœ¬çš„ã«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«è¨­å®šã•ã‚Œã¾ã—ãŸã€‚

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã—ã¦ä½¿ã†ã«ã¯ æœ€åˆã®è¡Œã« 'use client' ã¨ã„ã†ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’ã¤ã‘ã‚‹ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚

ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®é•ã„ã‚’çŸ¥ã£ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚



## è¡¨

Rendering: Composition Patterns | Next.js

https://nextjs.org/docs/app/building-your-application/rendering/composition-patterns

| ä½•ãŒã—ãŸã„ã‹ï¼Ÿ | Server Component | Client Component |
| --- | --- | --- |
| ãƒ‡ãƒ¼ã‚¿ã®å–å¾—|âœ…| âŒ|
| ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ãƒªã‚½ãƒ¼ã‚¹ã«ï¼ˆç›´æ¥ï¼‰ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã€‚|âœ…| âŒ|
| ã‚µãƒ¼ãƒãƒ¼ä¸Šã«æ©Ÿå¯†æƒ…å ±ã‚’ä¿æŒã™ã‚‹ï¼ˆã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã€APIã‚­ãƒ¼ãªã©ï¼‰ã€‚|âœ…| âŒ|
| å¤§ããªä¾å­˜é–¢ä¿‚ã‚’ã‚µãƒ¼ãƒã«æ®‹ã™ / ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã®JavaScriptã‚’æ¸›ã‚‰ã™ã€‚|âœ…| âŒ|
| ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–æ€§ã¨ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ ã™ã‚‹ (`onClick()`ã€`onChange()`ãªã©) | âŒ | âœ… |
| ã‚¹ãƒ†ãƒ¼ãƒˆã¨ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’ä½¿ã† (`useState()`ã€`useReducer()`ã€`useEffect()` ãªã©) | âŒ | âœ… |
| ãƒ–ãƒ©ã‚¦ã‚¶å°‚ç”¨ã®APIã‚’ä½¿ã† | âŒ | âœ… |.
| çŠ¶æ…‹ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã€ã¾ãŸã¯ãƒ–ãƒ©ã‚¦ã‚¶å°‚ç”¨APIã«ä¾å­˜ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã™ã‚‹ã€‚ | âŒ | âœ… |.
| [React Classã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ](https://react.dev/reference/react/Component)ã‚’ä½¿ã†ã€‚ | âŒ | âœ… |.


### ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå´

ãƒ‡ãƒ¼ã‚¿ã®ãƒ•ã‚§ãƒƒãƒ
ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ãƒªã‚½ãƒ¼ã‚¹ã«ï¼ˆç›´æ¥ï¼‰ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã€‚
æ©Ÿå¯†æƒ…å ±ï¼ˆã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã€APIã‚­ãƒ¼ãªã©ï¼‰ã‚’ã‚µãƒ¼ãƒãƒ¼ã«ä¿ç®¡ã™ã‚‹ã€‚
å¤§ããªä¾å­˜é–¢ä¿‚ã‚’ã‚µãƒ¼ãƒã«æ®‹ã™ / ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰JavaScriptã‚’æ¸›ã‚‰ã™



### ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå´

ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–æ€§ã¨ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¿½åŠ  (onClick()ã€onChange()ãªã©)
ã‚¹ãƒ†ãƒ¼ãƒˆã¨ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä½¿ç”¨ (useState(), useReducer(), useEffect() ãªã©)
ãƒ–ãƒ©ã‚¦ã‚¶ã®ã¿ã®APIã‚’ä½¿ç”¨ã™ã‚‹ã€‚
ã‚¹ãƒ†ãƒ¼ãƒˆã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã€ã¾ãŸã¯ãƒ–ãƒ©ã‚¦ã‚¶å°‚ç”¨APIã«ä¾å­˜ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã™ã‚‹ã€‚
React ã‚¯ãƒ©ã‚¹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã€‚



ã“ã‚Œã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨ã—ã¦ã¯ä¸€æ—¦å®Œæˆã®ã¯ãšã€‚
ã—ã‹ã—ã€å¾Œã‹ã‚‰ä¾¿åˆ©ãƒ„ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ååˆ†ã‚ã‚Šãˆã‚‹ã€‚

â€»ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è€ƒãˆæ–¹ã«ã‚ˆã‚Šã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚³ãƒ¼ãƒ‰ã®ãã°ã«ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¨ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ããŸã„ã¨æ€ã„ã¾ã™ã€‚
å®Ÿéš›ä½¿ç”¨ã™ã‚‹æ™‚ã¯ srcãƒ•ã‚©ãƒ«ãƒ€ ã‚’ä½œã£ã¦ãã®ä¸‹ã‚’è¦‹ã¦ã‚‚ã‚‰ãˆã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚



----------------------------------------

ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå®Œæˆå¾Œã®todo

GitHubèªè¨¼ã®å®Ÿè£…

VNSã®å…¨ä½“ã‚’è¨­è¨ˆã™ã‚‹

é–‹ç™ºè¨­è¨ˆ

DBè¨­è¨ˆ

ç”»é¢è¨­è¨ˆ

åŸºæœ¬æ—¥æœ¬èªã§é–‹ç™ºã™ã‚‹

åŸºæœ¬çš„ãª Next.js 13 App router ã§ã® vitest ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®æ›¸ãæ–¹ (ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰å§‹ã‚ã‚‹ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º Next.js 13 App routerã€ vitest ã€ Storybookã€ Plop) - Qiita

https://qiita.com/masakinihirota/items/3c7ef09cbaebfa702bba



# ç†æƒ³çš„ãªãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ã‚µã‚¤ã‚¯ãƒ«

1. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è¨­è¨ˆã‚’ã—ã¾ã™ã€‚

1. plopã‚’ä½¿ã„ `*.tsx` (ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«)ã‚’ä½œæˆã—ã¾ã™ã€‚åŒæ™‚ã« `*.stories.js` (Storybookãƒ•ã‚¡ã‚¤ãƒ«)ã¨ `*.test.tsx` (ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«)ã‚‚ä½œæˆã—ã¾ã™ã€‚

1. ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º vitest ã‚’ä½¿ã£ã¦ã‚µã‚¤ã‚¯ãƒ«ã‚’å›ã—ã¾ã™ã€‚
    * ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¾ã™ã€‚ RED
    * ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã¾ã™ã€‚ GREEN
    * Storybookã§å‹•ä½œç¢ºèªã‚’ã—ã¾ã™ã€‚
    * ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚’è¡Œã„ã¾ã™ã€‚ Refactoring
å®Œæˆã«è¿‘ã¥ãã¾ã§ç¹°ã‚Šè¿”ã—ã¾ã™ã€‚

1. è¨­è¨ˆå›³é€šã‚Šã«å®Œæˆã•ã›ã¾ã™ã€‚

1. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æœ¬ä½“ã«å–ã‚Šè¾¼ã¿ã¾ã™ã€‚

ä»¥ä¸Šã‚’ç¹°ã‚Šè¿”ã—ã¾ã™ã€‚

æ¼«ç”»ãƒªã‚¹ãƒˆã‚’åŸºæœ¬ã«ä½œã‚‹

DBè¨­è¨ˆã¯æ¼«ç”»ã‹ã‚‰

ãƒˆãƒƒãƒ—ç”»é¢ è¨€èªã‚’é¸æŠã—ãŸã‚‰ãã®è¨€èªãŒãƒˆãƒƒãƒ—ã«ç§»å‹•ã™ã‚‹


çµ‚äº†

	shadcnã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

----------------------------------------
----------------------------------------
----------------------------------------

shadcn

npx shadcn-ui@latest init
npx @shadcn/ui add

5å€‹ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½
10å€‹ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸å¯èƒ½

	( )   accordion
	( )   alert
	( )   alert-dialog
	( )   aspect-ratio
	( )   avatar
	( )   badge
	( )   button
X( )   calendar
	( )   card
	( )   checkbox
	( )   collapsible
	( )   command
	( )   context-menu
	( )   dialog
	( )   dropdown-menu
	( )   hover-card
	( )   input
	( )   label
	( )   menubar
	( )   navigation-menu
	( )   popover
	( )   progress
	( )   radio-group
	( )   scroll-area
	( )   select
	( )   separator
	( )   sheet
	( )   skeleton
	( )   slider
	( )   switch
	( )   table
	( )   tabs
	( )   textarea
	( )   toast
	( )   toggle
	( )   tooltip



calendarã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å•é¡Œ

Errors while adding the Calendar component Â· Issue #201 Â· shadcn-ui/ui
https://github.com/shadcn-ui/ui/issues/201

npx shadcn-ui@latest add calendar
â†‘æœ€æ–°ç‰ˆã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨å•é¡Œè§£æ±º




# ãƒ†ã‚¹ãƒˆå°å…¥æ™‚æœŸã«ã¤ã„ã¦ã®ç§è¦‹

ï¼ã‹ã‚‰ä½œã‚‹å ´åˆã¯
æœ€åˆã¯é™çš„ã‚µã‚¤ãƒˆã‚’ä½œã‚‹æ„Ÿã˜ã§
ãƒ¢ãƒƒã‚¯ã‚’ã¤ãã‚‹ã‚ˆã†ã«ã€æ–‡å­—ã ã‘ã€ãƒªãƒ³ã‚¯ã ã‘ã€ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã ã‘ã§
å‹•çš„ãªè¦ç´ ã¯ä¸€åˆ‡è€ƒãˆãªã„ã§ã¤ãã‚Šã¾ã™ã€‚

ã“ã®æ™‚ã«ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé›†ã‚’çµ„ã¿åˆã‚ã›ã¾ã™ã€‚

ã“ã®æ™‚æœŸã¯è‰²ã€…ç”»é¢æ§‹æˆã‚’ã„ã˜ã£ã¦ä½¿ã„ã‚„ã™ã„ã‚ˆã†ã«
å†æ§‹æˆã‚’ç¹°ã‚Šè¿”ã—ã¾ã™ã€‚

ä¸€æ—¦å®Œæˆã—ãŸã‚‰

DBã‚’ç¹‹ã’ã¦å‹•çš„ã‚µã‚¤ãƒˆã«ã™ã‚‹æ™‚æœŸã«æ¥ã¾ã™ãŒ
ã“ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§DBã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚Œã¦ã„ã‚‹ã‹
ãƒ†ã‚¹ãƒˆã§ç¢ºèªã™ã‚‹ã®ãŒã„ã„ã¨æ€ã„ã¾ã™ã€‚



# ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯

Route Groups ã«æ•°å­—ã‚’ä½¿ã†ã€‚

ãƒ•ã‚©ãƒ«ãƒ€åã‚’ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®é †ç•ªé€šã‚Šã«ä¸¦ã¹ã‚‹ãŸã‚
(01_ãƒ¡ãƒ‹ãƒ¥ãƒ¼A)
(02_ãƒ¡ãƒ‹ãƒ¥ãƒ¼B)
(03_ãƒ¡ãƒ‹ãƒ¥ãƒ¼C)
(04_ãƒ¡ãƒ‹ãƒ¥ãƒ¼D)
(05_ãƒ¡ãƒ‹ãƒ¥ãƒ¼E)

ã¨ãƒ•ã‚©ãƒ«ãƒ€åã®å‰ã«æ•°å­—ã‚’ç½®ãã¨Webã‚¢ãƒ—ãƒªå´ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¨æƒãˆã‚‹ã“ã¨ãŒå‡ºæ¥ã‚‹ã€‚
Next.jsã¯ãƒ•ã‚©ãƒ«ãƒ€åã‚’()ã§å›²ã‚€ã¨ãã‚Œãã‚Œç‹¬ç«‹ã—ã¦æ‰±ãˆã‚‹ã®ã§ç›´æ„Ÿã§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’æ¢ã›ã‚‹ã€‚

Routing: Route Groups | Next.js

https://nextjs.org/docs/app/building-your-application/routing/route-groups

ä»Šã®ã¨ã“ã‚ä¸å…·åˆã¯ãªã„ã€‚








# å‰æçŸ¥è­˜

## ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³

ç°¡å˜ã«æ›¸ãã¨ã€åŒã˜å ´æ‰€ã«ã‚³ãƒ¼ãƒ‰ã¨ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ã„ã¦ãŠã„ãŸã»ã†ãŒä¿å®ˆã—ã‚„ã™ããªã‚‹ã®ã§ã¯ãªã„ã‹ã¨ã„ã†è€ƒãˆæ–¹ã€‚

## Next.js App router ã«ãŠã‘ã‚‹ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

Next.js ã§é–‹ç™ºã™ã‚‹ä¸Šã§çŸ¥ã£ã¦ãŠãçŸ¥è­˜

Next.jsã§ã¯åŸºæœ¬çš„ã«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«è¨­å®šã•ã‚Œã¾ã—ãŸã€‚

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã—ã¦ä½¿ã†ã«ã¯ æœ€åˆã®è¡Œã« 'use client' ã¨ã„ã†ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’ã¤ã‘ã‚‹ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚

ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®é•ã„ã‚’çŸ¥ã£ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚



## è¡¨

Rendering: Composition Patterns | Next.js

https://nextjs.org/docs/app/building-your-application/rendering/composition-patterns

| ä½•ãŒã—ãŸã„ã‹ï¼Ÿ | Server Component | Client Component |
| --- | --- | --- |
| ãƒ‡ãƒ¼ã‚¿ã®å–å¾—|âœ…| âŒ|
| ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ãƒªã‚½ãƒ¼ã‚¹ã«ï¼ˆç›´æ¥ï¼‰ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã€‚|âœ…| âŒ|
| ã‚µãƒ¼ãƒãƒ¼ä¸Šã«æ©Ÿå¯†æƒ…å ±ã‚’ä¿æŒã™ã‚‹ï¼ˆã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã€APIã‚­ãƒ¼ãªã©ï¼‰ã€‚|âœ…| âŒ|
| å¤§ããªä¾å­˜é–¢ä¿‚ã‚’ã‚µãƒ¼ãƒã«æ®‹ã™ / ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã®JavaScriptã‚’æ¸›ã‚‰ã™ã€‚|âœ…| âŒ|
| ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–æ€§ã¨ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ ã™ã‚‹ (`onClick()`ã€`onChange()`ãªã©) | âŒ | âœ… |
| ã‚¹ãƒ†ãƒ¼ãƒˆã¨ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’ä½¿ã† (`useState()`ã€`useReducer()`ã€`useEffect()` ãªã©) | âŒ | âœ… |
| ãƒ–ãƒ©ã‚¦ã‚¶å°‚ç”¨ã®APIã‚’ä½¿ã† | âŒ | âœ… |.
| çŠ¶æ…‹ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã€ã¾ãŸã¯ãƒ–ãƒ©ã‚¦ã‚¶å°‚ç”¨APIã«ä¾å­˜ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã™ã‚‹ã€‚ | âŒ | âœ… |.
| [React Classã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ](https://react.dev/reference/react/Component)ã‚’ä½¿ã†ã€‚ | âŒ | âœ… |.


### ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå´

ãƒ‡ãƒ¼ã‚¿ã®ãƒ•ã‚§ãƒƒãƒ
ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ãƒªã‚½ãƒ¼ã‚¹ã«ï¼ˆç›´æ¥ï¼‰ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã€‚
æ©Ÿå¯†æƒ…å ±ï¼ˆã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã€APIã‚­ãƒ¼ãªã©ï¼‰ã‚’ã‚µãƒ¼ãƒãƒ¼ã«ä¿ç®¡ã™ã‚‹ã€‚
å¤§ããªä¾å­˜é–¢ä¿‚ã‚’ã‚µãƒ¼ãƒã«æ®‹ã™ / ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰JavaScriptã‚’æ¸›ã‚‰ã™



### ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå´

ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–æ€§ã¨ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¿½åŠ  (onClick()ã€onChange()ãªã©)
ã‚¹ãƒ†ãƒ¼ãƒˆã¨ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä½¿ç”¨ (useState(), useReducer(), useEffect() ãªã©)
ãƒ–ãƒ©ã‚¦ã‚¶ã®ã¿ã®APIã‚’ä½¿ç”¨ã™ã‚‹ã€‚
ã‚¹ãƒ†ãƒ¼ãƒˆã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã€ã¾ãŸã¯ãƒ–ãƒ©ã‚¦ã‚¶å°‚ç”¨APIã«ä¾å­˜ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã™ã‚‹ã€‚
React ã‚¯ãƒ©ã‚¹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã€‚



ã“ã‚Œã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨ã—ã¦ã¯ä¸€æ—¦å®Œæˆã®ã¯ãšã€‚
ã—ã‹ã—ã€å¾Œã‹ã‚‰ä¾¿åˆ©ãƒ„ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ååˆ†ã‚ã‚Šãˆã‚‹ã€‚

â€»ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è€ƒãˆæ–¹ã«ã‚ˆã‚Šã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚³ãƒ¼ãƒ‰ã®ãã°ã«ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¨ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ããŸã„ã¨æ€ã„ã¾ã™ã€‚
å®Ÿéš›ä½¿ç”¨ã™ã‚‹æ™‚ã¯ srcãƒ•ã‚©ãƒ«ãƒ€ ã‚’ä½œã£ã¦ãã®ä¸‹ã‚’è¦‹ã¦ã‚‚ã‚‰ãˆã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚



----------------------------------------

# GitHubèªè¨¼ ç„¡æ–™

Login with GitHub | Supabase Docs

https://supabase.com/docs/guides/auth/social-login/auth-github



GitHub ãƒ­ã‚°ã‚¤ãƒ³ã®è¨­å®šã¯ã€æ¬¡ã® 3 ã¤ã®éƒ¨åˆ†ã§æ§‹æˆã•ã‚Œã¾ã™ã€‚

1. GitHubä¸Šã§ GitHub OAuth ã‚¢ãƒ—ãƒªã‚’ä½œæˆãŠã‚ˆã³æ§‹æˆã™ã‚‹ã€‚
2. GitHub OAuth ã‚­ãƒ¼ã‚’Supabase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«è¿½åŠ ã—ã¾ã™ã€‚
3. ãƒ­ã‚°ã‚¤ãƒ³ ã‚³ãƒ¼ãƒ‰ã‚’Supabase JS ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ ã‚¢ãƒ—ãƒªã«è¿½åŠ ã—ã¾ã™ã€‚


ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ ãƒˆãƒ¼ã‚¯ãƒ³ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã¯æ„å›³çš„ã«ä¿å­˜ã•ã‚Œã¾ã›ã‚“ã€‚
ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ ãƒˆãƒ¼ã‚¯ãƒ³ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã¯æ„å›³çš„ã«ä¿å­˜ã•ã‚Œã¾ã›ã‚“ã€‚
ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ ãƒˆãƒ¼ã‚¯ãƒ³ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã¯æ„å›³çš„ã«ä¿å­˜ã•ã‚Œã¾ã›ã‚“ã€‚

OAuthãƒ•ãƒ­ãƒ¼ã‚’å®Œäº†ã—ãŸãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã®å¤–ã§ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä½¿ç”¨ã—ãŸã„å ´åˆã¯ã€
ç®¡ç†ä¸‹ã®å®‰å…¨ãªã‚µãƒ¼ãƒãƒ¼ã«ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ‰‹å‹•ã§é€ä¿¡ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚



## 1. GitHub Oauth ã‚¢ãƒ—ãƒªã‚’ä½œæˆã™ã‚‹

GitHubã¸ç§»å‹•
GitHubã®å·¦ä¸Šã®å†™çœŸã‹ã‚‰ setting
ä¸€ç•ªä¸‹ã®Developer settings
OAuth Apps

å³ä¸Šå†™çœŸä¸‹ã®New OAuth APpãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚

ä½œæˆã—ã¾ã™ã€‚



ãã®å‰ã«Supabase ã‹ã‚‰ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®æƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚

Supabase ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã¸ç§»å‹•
https://supabase.com/dashboard/project/gzctqdrrnnkaxwwtzbsw/auth/providers
https://supabase.com/dashboard/project/gzctqdrrnnkaxwwtzbsw/auth/providers


å·¦å´ã®ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®Authentication
Providersã‚’é¸æŠã€‚

GitHubã‚’é¸æŠ

è¨­å®šã—ã¾ã™ã€‚

Client ID
ã¾ã ç™»éŒ²ã—ã¾ã›ã‚“ã€‚

Client Secret
ã¾ã ç™»éŒ²ã—ã¾ã›ã‚“ã€‚

Callback URL (for OAuth) ï¼œï¼œå›ºå®š
https://gzctqdrrnnkaxwwtzbsw.supabase.co/auth/v1/callback
https://gzctqdrrnnkaxwwtzbsw.supabase.co/auth/v1/callback

â†‘ã“ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å–å¾—ã—GitHubå´ã§ç™»éŒ²ã—ã¾ã™ã€‚



GitHubã¸æˆ»ã£ã¦ä½œæˆã®ç¶šãã§ã™ã€‚

Application name
vns.blue
vns.blue

Homepage URL
https://www.vns.blue/

Application description
vns

Authorization callback URL
https://gzctqdrrnnkaxwwtzbsw.supabase.co/auth/v1/callback
https://gzctqdrrnnkaxwwtzbsw.supabase.co/auth/v1/callback


ç™»éŒ²ã™ã‚‹ã¨
vns.blueã®Client IDç­‰ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

Supabase ã«æˆ»ã£ã¦GitHubã§å–å¾—ã—ãŸå€¤ã‚’ç™»éŒ²ã—ã¾ã™ã€‚

GitHub
vns
vns

Client ID
****************

Client Secret æºå¸¯èªè¨¼ãŒå¿…è¦
****************

Callback URL (for OAuth)
https://gzctqdrrnnkaxwwtzbsw.supabase.co/auth/v1/callback
https://gzctqdrrnnkaxwwtzbsw.supabase.co/auth/v1/callback

Saveãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚

ä»¥ä¸Šã§GitHubã¨Supabaseé–“ã®èªè¨¼ã®è¨­å®šãŒçµ‚ã‚ã‚Šã¾ã—ãŸã€‚


# å®Ÿéš›ã«GitHubã§èªè¨¼ã‚’ã—ã¦ã¿ã‚‹



ä»•çµ„ã¿#
ãƒ¦ãƒ¼ã‚¶ãŒã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ã™ã‚‹ã€‚
Supabaseã¯auth.usersãƒ†ãƒ¼ãƒ–ãƒ«ã«æ–°ã—ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã™ã‚‹ã€‚

Supabaseã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®UUIDã‚’å«ã‚€æ–°ã—ã„JWTã‚’è¿”ã™ã€‚

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®å…¨ã¦ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯JWTã‚’é€ä¿¡ã—ã¾ã™ã€‚

Postgresã¯JWTã‚’æ¤œæŸ»ã—ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã£ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç‰¹å®šã—ã¾ã™ã€‚

ãƒ¦ãƒ¼ã‚¶ã®UIDã¯ã€è¡Œã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’åˆ¶é™ã™ã‚‹ãƒãƒªã‚·ãƒ¼ã§ä½¿ç”¨ã§ãã¾ã™ã€‚

Supabaseã¯Postgresã®ç‰¹åˆ¥ãªé–¢æ•°ã€auth.uid()ã‚’æä¾›ã—ã€

JWTã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ã®UIDã‚’æŠ½å‡ºã—ã¾ã™ã€‚
ã“ã‚Œã¯ãƒãƒªã‚·ãƒ¼ã‚’ä½œæˆã™ã‚‹éš›ã«ç‰¹ã«ä¾¿åˆ©ã§ã™ã€‚




ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†
Supabaseã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’èªè¨¼ãƒ»ç®¡ç†ã™ã‚‹ãŸã‚ã®è¤‡æ•°ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’æä¾›ã—ã¾ã™ï¼š

ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—
ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ã‚µã‚¤ãƒ³ã‚¤ãƒ³
ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ¬ã‚¹/ãƒ¯ãƒ³ã‚¿ã‚¤ãƒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰(OTP)ã«ã‚ˆã‚‹ã‚µã‚¤ãƒ³ã‚¤ãƒ³
OAuthã«ã‚ˆã‚‹ã‚µã‚¤ãƒ³ã‚¤ãƒ³
ã‚µã‚¤ãƒ³ã‚¢ã‚¦ãƒˆ

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ã™ã‚‹ã¨ã€
Supabaseã¯ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªIDã‚’å‰²ã‚Šå½“ã¦ã¾ã™ã€‚

ã“ã®IDã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã©ã“ã‹ã‚‰ã§ã‚‚å‚ç…§ã§ãã¾ã™ã€‚
ä¾‹ãˆã°ã€user_idãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ä½¿ã£ã¦auth.usersãƒ†ãƒ¼ãƒ–ãƒ«ã®idã‚’
å‚ç…§ã™ã‚‹profilesãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚





Redirect URLs | Supabase Docs

https://supabase.com/docs/guides/auth/concepts/redirect-urls#vercel-preview-urls

ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURL
Supabase Authã§ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURLã‚’è¨­å®šã™ã‚‹ã€‚



æ¦‚è¦#

ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ¬ã‚¹ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã‚„ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ—ãƒ­ãƒã‚¤ãƒ€ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€
Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒ¡ã‚½ãƒƒãƒ‰ã«ã¯ã€

èªè¨¼å¾Œã«ãƒ¦ãƒ¼ã‚¶ã‚’ã©ã“ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã›ã‚‹ã‹ã‚’æŒ‡å®šã™ã‚‹
redirectToãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ã¯SITE_URLã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã¾ã™ãŒã€
SITE_URLã‚’å¤‰æ›´ã—ãŸã‚Šã€
ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆã®URLã‚’è¨±å¯ãƒªã‚¹ãƒˆã«è¿½åŠ ã—ãŸã‚Šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

å¿…è¦ãªURLã‚’è¨±å¯ãƒªã‚¹ãƒˆã«è¿½åŠ ã—ãŸã‚‰ã€
redirectToãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã›ãŸã„URLã‚’
æŒ‡å®šã—ã¾ã™ã€‚



ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURLã«ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã‚’ä½¿ã†#ã€‚
Supabaseã§ã¯ã€
ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURLã‚’è¨±å¯ãƒªã‚¹ãƒˆã«è¿½åŠ ã™ã‚‹éš›ã«ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

Netlifyã‚„Vercelã®ã‚ˆã†ãªãƒ—ãƒ­ãƒã‚¤ãƒ€ã‹ã‚‰ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼URLã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã«ã€
ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã®ãƒãƒƒãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ã†ã“ã¨ãŒã§ãã¾ã™ã€‚


----------------------------------------

Slackèªè¨¼ ç„¡æ–™

GitHubã¨ä¼¼ãŸã‚ˆã†ãªæ„Ÿã˜ã§ç™»éŒ²ã§ãã¾ã™ã€‚

Supabase ã‹ã‚‰ Callback URLã‚’å–å¾—ã—ã¦ Slackã«ç™»éŒ²
IDã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ Slackã‹ã‚‰å–å¾—ã—ã¦Supabase ã«ç™»éŒ²

å‚è€ƒ
Supabase Authã§Slackèªè¨¼ã‚’è©¦ã—ã¦ã¿ãŸ | DevelopersIO

https://dev.classmethod.jp/articles/supbase-auth-slack/



----------------------------------------

Googleèªè¨¼ ç„¡æ–™

Login with Google | Supabase Docs

https://supabase.com/docs/guides/auth/social-login/auth-google

Supabase ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ Google ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’æ§‹æˆã™ã‚‹ã€‚

Enable Sign in with Google ã‚’ã‚ªãƒ³ã«ã™ã‚‹ã€‚

Client ID (for OAuth)

Client Secret (for OAuth)

Authorized Client IDs (for Android, One Tap, and Chrome extensions)

Callback URL (for OAuth)
https://gzctqdrrnnkaxwwtzbsw.supabase.co/auth/v1/callback






3 ã¤ã®ä¸€èˆ¬çš„ãªæ–¹æ³•

Web ã® OAuth ãƒ•ãƒ­ãƒ¼ã®ä½¿ç”¨
ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã®ä½¿ç”¨
Chrome æ‹¡å¼µæ©Ÿèƒ½ã®ãƒã‚¤ãƒ†ã‚£ãƒ– ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã®ä½¿ç”¨



å¯èƒ½ãªé™ã‚Šã€ãƒã‚¤ãƒ†ã‚£ãƒ–ã®ã€ŒGoogle ã§ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã€æ©Ÿèƒ½ã‚’
ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒãƒ™ã‚¹ãƒˆ ãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã§ã™ã€‚

ã€ŒGoogleã§ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã€ã‚’ä½¿ç”¨ã™ã‚‹å‰ã«ã€
GoogleCloudPlatformã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’
å–å¾—ã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’æº–å‚™ã™ã‚‹ã‹ã€
æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚



è©±é¡Œã®Supabaseã§ã‚µã‚¯ãƒƒã¨Googleèªè¨¼æ©Ÿèƒ½ã‚’ã¤ãã£ã¦ã¿ãŸï¼ - Qiita

https://qiita.com/kaho_eng/items/a37ff001ea9eae226183



GCP(Google Cloud Platform) ã§ã€Googleãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

https://cloud.google.com/

ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã‚’ã—ã¾ã™ã€‚
å³ä¸Šã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’æŠ¼ã—ã¾ã™ã€‚
ç”»é¢é·ç§»å…ˆå·¦ä¸Šã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é¸æŠã‚’æŠ¼ã—ã¾ã™ã€‚
å³ä¸Šã®æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’æŠ¼ã—ã¾ã™ã€‚


ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã¨å ´æ‰€ã‚’è¨­å®šã—ã¾ã™ã€‚

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå
vns-blue

å ´æ‰€
çµ„ç¹”ãªã—

ä½œæˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚

ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ãƒ–ãƒ©ã‚¦ã‚¶ã®æœ€ä¸Šæ®µã«ä½œæˆã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåãŒã§ã¦ã„ã‚Œã°OKã§ã™ã€‚

APIã¨ã‚µãƒ¼ãƒ“ã‚¹
OAuthåŒæ„ç”»é¢
ã‚’é¸æŠã—ã¾ã™ã€‚

User Typeã‚’é¸æŠã—ã¾ã™ã€‚
å¤–éƒ¨ã‚’é¸æŠã—ä½œæˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚



ã‚¢ãƒ—ãƒªç™»éŒ²ã®ç·¨é›† ç”»é¢ã«ãªã‚Šã¾ã™ã€‚



ã‚¢ãƒ—ãƒªå
vns.blue
vns.blue

ãƒ¦ãƒ¼ã‚¶ãƒ¼ ã‚µãƒãƒ¼ãƒˆãƒ¡ãƒ¼ãƒ«

ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼ã®é€£çµ¡å…ˆæƒ…å ±

æ¬¡ã®2ã¤ã¯ãã®ã¾ã¾ã§å¤§ä¸ˆå¤«ã§ã™ã€‚
èªè¨¼ã®ç¯„å›²
ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼


ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼
èªè¨¼æƒ…å ±
ï¼‹èªè¨¼æƒ…å ±ã‚’ä½œæˆ
OAuthã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆID
ã‚’é¸æŠã—ã¾ã™ã€‚



ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç¨®é¡
ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é¸æŠã—ã¾ã™ã€‚

åå‰ã‚’å…¥åŠ›ã—ã¾ã™ã€‚
vns.blue
vns.blue

ä½œæˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚

ã“ã“ã§
ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIDã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ
ãŒå…¥æ‰‹ã§ãã¾ã™ã€‚


ã‚‚ã†ä¸€åº¦æˆ»ã£ã¦
èªè¨¼æƒ…å ±
OAuth 2.0 ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ ID
å…ˆç¨‹ç™»éŒ²ã—ãŸã®ã‚’é¸æŠã—ã¾ã™ã€‚
ç·¨é›†ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚ï¼ˆé‰›ç­†ã®ã‚¢ã‚¤ã‚³ãƒ³ï¼‰

æ‰¿èªæ¸ˆã¿ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ URI
Supabase ã§å–å¾—ã—ãŸã€æ‰¿èªæ¸ˆã¿ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ URIã‚’å…¥åŠ›ã—ã¾ã™ã€‚
ï¼‹URLã‚’è¿½åŠ ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚

https://gzctqdrrnnkaxwwtzbsw.supabase.co/auth/v1/callback

ç™»éŒ²ã—ã¾ã™ã€‚

ä¿å­˜ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚



Supabaseã«æˆ»ã£ã¦
ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIDã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’ç™»éŒ²ã—ã¾ã™ã€‚

Save ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚



----------------------------------------

ã“ã®è¨˜äº‹ã‚’æ›¸ã„ã¦ã„ã‚‹ã“ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§
Supabase ã®ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã§èªè¨¼ã®ã‚µãƒ³ãƒ—ãƒ«ã‚’å…¬é–‹ã—ã¦ã„ã‚‹ã®ã‚’è¦‹ã¤ã‘ã¾ã—ãŸã€‚

supabase-community/supabase-by-example

https://github.com/supabase-community/supabase-by-example/tree/main

ãƒ¡ãƒ¼ãƒ«ã§ã®ãƒã‚¸ãƒƒã‚¯ãƒªãƒ³ã‚¯
OAuthèªè¨¼
ã“ã‚Œã‚‰ã®ã‚µãƒ³ãƒ—ãƒ«ã‚’è¦‹ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚



ã“ã®æ™‚ç‚¹ã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ãƒ¡ãƒ¼ãƒ«èªè¨¼ã¨OAuthã‚’è¤‡æ•°å®Ÿè£…ã§ããŸã“ã¨ã‚„èªè¨¼ã®å‹•ä½œã‚’ç¢ºèªã—ã¾ã—ãŸã€‚
ã“ã®æ™‚ç‚¹ã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ãƒ¡ãƒ¼ãƒ«èªè¨¼ã¨OAuthã‚’è¤‡æ•°å®Ÿè£…ã§ããŸã“ã¨ã‚„èªè¨¼ã®å‹•ä½œã‚’ç¢ºèªã—ã¾ã—ãŸã€‚
ã“ã®æ™‚ç‚¹ã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ãƒ¡ãƒ¼ãƒ«èªè¨¼ã¨OAuthã‚’è¤‡æ•°å®Ÿè£…ã§ããŸã“ã¨ã‚„èªè¨¼ã®å‹•ä½œã‚’ç¢ºèªã—ã¾ã—ãŸã€‚



----------------------------------------
----------------------------------------
----------------------------------------

ã€Next.jsã€‘ç®¡ç†è€…ç”¨ãƒšãƒ¼ã‚¸ã‚’ Route Groups ã§å®Ÿç¾ã™ã‚‹
https://zenn.dev/chot/articles/next-layout-for-admin-page

app
â”” (admin-only)
      â”œâ”€â”€ dashboard
      â”‚   â””â”€â”€ page.tsx
      â”œâ”€â”€ settings
      â”‚   â””â”€â”€ page.tsx
      â””â”€â”€ layout.tsx










----------------------------------------

Supabaseã§TypeScriptã‚’ä½¿ã†å ´åˆã®æº–å‚™

https://zenn.dev/xbonewalker/articles/73f9faa5724bbc

å‹ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ
DBã®ã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰å‹ã‚’ç”Ÿæˆã—ã¾ã™ã€‚
(å‹ãƒ•ã‚¡ã‚¤ãƒ«ãŒã™ã§ã«ã‚ã£ãŸã¨ã—ã¦ã‚‚ä¸Šæ›¸ãã•ã‚Œã¾ã™ã€‚)

npx supabase gen types typescript --project-id gzctqdrrnnkaxwwtzbsw > src/types/database.types.ts
npx supabase gen types typescript --project-id gzctqdrrnnkaxwwtzbsw > src/types/database.types.ts


----------------------------------------
----------------------------------------
----------------------------------------

# ã“ã®æ®µéšã§ã®åˆ¶ä½œæ–¹é‡

ã“ã‚Œã¾ã§ã¯ã€ã‚ªãƒªã‚¸ãƒŠãƒ«ã®æ©Ÿèƒ½ãŒç„¡ã„åœŸå°éƒ¨åˆ†ã€ã¤ã¾ã‚Šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œæˆã—ã¦ãã¾ã—ãŸã€‚

ã“ã“ã‹ã‚‰ã¯ã€è‡ªåˆ†ã®ä½œæˆã—ãŸã„æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹æ®µéšã«å…¥ã‚‹ã“ã¨ã«ãªã‚Šã¾ã—ãŸã€‚

æœ€åˆã«ã‚„ã‚‹ã“ã¨ã¯
é™çš„ã§ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦æ ã ã‘ä½œã‚Šã¾ã™ã€‚
æœ€å°é™ã®æ©Ÿèƒ½ã«å¯¾ã™ã‚‹ç”»é¢æ§‹æˆã‚’ä½œæˆã—ã¾ã™ã€‚æ–‡å­—åˆ—ã¯å›ºå®šã§ã™ã€‚Linkãƒœã‚¿ãƒ³ã¨ç”»é¢é·ç§»ã‚’ä½œæˆã—ã¾ã™ã€‚


æœ€åˆã‹ã‚‰å®Œæˆå½¢ã¯ç›®æŒ‡ã—ã¾ã›ã‚“ã€‚
åŠã‚Šæ©‹ã‚’ä½œæˆã™ã‚‹ã‚ˆã†ã«ã€æœ€åˆã¯ä¸€æœ¬ã®ãƒ­ãƒ¼ãƒ—ã‚’å¯¾å²¸ã«æ¸¡ã™ã‚ˆã†ã«ã€‚
æœ€å°é™ã®æ©Ÿèƒ½ã§ååˆ†ã§ã™ã€‚ãã“ã®åœŸå°ã‚’ä½œã£ã¦ã‹ã‚‰å¾Œã‹ã‚‰æ‹¡å¼µã—ã¦ã„ãã¾ã™ã€‚

ä½¿ã„ã‚„ã™ã„ç”»é¢æ§‹æˆã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãªã‚‹ã¹ãç›´æ„Ÿã«æ²¿ã£ãŸç”»é¢æ§‹æˆã¨ãƒªãƒ³ã‚¯ã‚’ä½œæˆã—ã¾ã™ã€‚

è‡ªåˆ†ã¯å¤§ã¾ã‹ãªç”»é¢æ§‹æˆã¨ãƒªãƒ³ã‚¯ãŒã§ãã‚‹ã¾ã§ã€ãƒ†ã‚¹ãƒˆã‚‚Storybookã‚‚ä½œã‚Šã¾ã›ã‚“ã€‚
è¨­è¨ˆå›³ã‚’å®Ÿéš›ã®ç”»é¢ã«è½ã¨ã—è¾¼ã‚“ã§ã„ã‚‹æ™‚æœŸã ã‹ã‚‰ã§ã™ã€‚

ç´™ã®ä¸Šã®ç”»é¢è¨­è¨ˆå›³ã‚’Next.jsã®App routerã«ãã®ã¾ã¾åæ˜ ã§ãã‚‹ã‚ˆã†ã«ã—ãŸå¾Œã€å®Ÿéš›ã®ä½¿ç”¨æ„Ÿã‚’è¦‹ãªãŒã‚‰èª¿æ•´ã—ã¦ã„ãã¾ã™ã€‚

æ–‡å­—åˆ—ãªã©ã¯ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã—ã¦ãŠãã¾ã™ã€‚ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåŒ–ã—ã¦ã„ã‚‹éƒ¨åˆ†ã¯ã€èªè¨¼ç­‰ã®ã™ã§ã«å‡ºæ¥ä¸ŠãŒã£ã¦ã„ã‚‹ã‚‚ã®ã‚’çµ„ã¿è¾¼ã‚“ã ã‚‚ã®ã‚’ãã®ã¾ã¾æŒã£ã¦ããŸã‹ã‚‰ã§ã™ã€‚è‡ªä½œã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œã‚‹æ™‚ã«ã€ãƒšãƒ¼ã‚¸ã‹ã‚‰ä¸€éƒ¨åˆ†ã‚’åˆ‡ã‚Šå‡ºã™æ™‚ã«ãƒ†ã‚¹ãƒˆã‚„Storybookã‚’è¿½åŠ ã—ã¦ã„ã“ã†ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚


----------------------------------------

TailwindCSS

ç°¡å˜ãªè£…é£¾ã‚’ã—ã¾ã™ã€‚





shadcn ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’çµ„ã¿åˆã‚ã›ã¦ãƒšãƒ¼ã‚¸ã®åŸºç¤ã‚’ä½œã‚‹

Combobox
ãƒªã‚¹ãƒˆã®çµã‚Šè¾¼ã¿

Context Menu
å³ã‚¯ãƒªãƒƒã‚¯ãƒ¡ãƒ‹ãƒ¥ãƒ¼

â—Data Table
Table
	è§£èª¬ã‚’èª­ã‚€
	ä½œå“ãƒªã‚¹ãƒˆ

Dialog
ãƒ‡ãƒ¼ã‚¿ç·¨é›†
	è‡ªåˆ†ã¯ç›´æ„Ÿçš„ã«ç·¨é›†ã—ãŸã„

Dropdown Menu
å·¦ã‚¯ãƒªãƒƒã‚¯ãƒ¡ãƒ‹ãƒ¥ãƒ¼
	ã‚»ãƒƒãƒ†ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸ã¸ã®ç§»å‹•

â—From
	React Hook Formã®ãƒ©ãƒƒãƒ‘ãƒ¼
ä½œå“ç™»éŒ²
ãƒªã‚¹ãƒˆç™»éŒ²



Hover Card
	è£œè¶³èª¬æ˜

Input
	å…¥åŠ›ã®åŸºæœ¬

Menubar
	TopNavç”¨ï¼Ÿ

Navigation Menu
	TopNavç”¨ï¼Ÿ

Popover
	ç´°ã‹ã„èª¿æ•´ç”¨ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ï¼Ÿ

Radio Group
	ãƒ©ã‚¸ã‚ªã‚°ãƒ«ãƒ¼ãƒ—
	é¸æŠ

Select
	é¸æŠ ãƒªã‚¹ãƒˆå½¢å¼

Separator
	ã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿ãƒ¼

Sheet
	åˆ¥ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒé–‹ã„ã¦
	ç·¨é›†ç”»é¢ãŒå‡ºã‚‹

Skeleton
	ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ç”¨

Slider
	è©•ä¾¡ç”¨

Switch
	ã‚¹ã‚¤ãƒƒãƒåˆ‡ã‚Šæ›¿ãˆç”¨

Tabs
	ç”»é¢åˆ‡ã‚Šæ›¿ãˆç”¨

Textarea
	ãƒ†ã‚­ã‚¹ãƒˆè¡¨ç¤º
	ãªã‚‹ã¹ãä½¿ã„ãŸããªã„

Toast
	ç°¡æ˜“ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º

Toggle
	ä½¿ã„é“ãŒã‚ã‹ã‚‰ãªã„

Tooltip
	ãƒ›ãƒãƒ¼ã—ãŸæ™‚ã«è¡¨ç¤º



----------------------------------------

plop
ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå†è€ƒ

ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œã‚‹
	ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç½®ãå ´ã§ã‚‚ã€ä»–ã®å ´æ‰€ã§ã‚‚ç½®ã‘ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚
page.tsxã‚’ä½œã‚‹
test
storybookã‚’ä½œã‚‹




----------------------------------------

DBã®ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
DBã«ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šå‡ºã—ã¾ã™ã€‚




----------------------------------------






----------------------------------------


