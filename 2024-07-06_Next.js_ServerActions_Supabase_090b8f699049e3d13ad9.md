<!--
title:   Next.js 14 ã®Server Actions ã‚’åˆ©ç”¨ã—ãŸã€Supabaseã®åŒ¿åèªè¨¼ã®æœ€ä½é™ãªå®Ÿè£…
tags:    Next.js,ServerActions,Supabase
id:      090b8f699049e3d13ad9
private: false
-->
# åŒ¿åèªè¨¼ã®å‚è€ƒURL

Anonymous Sign-Ins | Supabase Docs
https://supabase.com/docs/guides/auth/auth-anonymous

Supabaseã®åŒ¿åèªè¨¼ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å¯¾ã—ã¦ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚‚ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚‚ã€Googleã‚„GitHubã€Appleç­‰ã®OAuthèªè¨¼ã‚‚å¿…è¦ã¨ã›ãšã€ä½•ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚‚å¿…è¦ã¨ã›ãšã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒ­ã‚°ã‚¤ãƒ³ã•ã›ã¦ã€ãã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã®æ©Ÿèƒ½ã‚’è©¦ã—ã¦ã‚‚ã‚‰ã†ãŸã‚ã®èªè¨¼æ–¹å¼ã§ã™ã€‚

â€»30æ—¥é–“ã§è‡ªå‹•å‰Šé™¤ã•ã‚Œã¾ã™ã€‚(å…¬å¼ï¼šäºˆå®š)
(ç¾åœ¨ã¯ã¾ã æ‰‹å‹•ã§å‰Šé™¤ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚)

é€šå¸¸ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨åŒã˜ã‚ˆã†ã«ãƒ­ã‚°ã‚¤ãƒ³å‡ºæ¥ã¾ã™ã€‚
åŒã˜ã‚ˆã†ãªæ“ä½œã‚‚å¯èƒ½ã«ãªã‚Šã¾ã™ãŒã€RLSã‚„ãƒ•ãƒ©ã‚°(is_anonymous)ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§å·®åˆ¥åŒ–ã§ãã¾ã™ã€‚

åŒ¿åèªè¨¼ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸå¾Œã€ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¦ã—ã¾ã†ã¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ãŒå¼•ãç¶™ãŒã‚Œã¾ã›ã‚“ã€‚



# å‰æ

Next.js 14 ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿
Supabaseã®ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã‚’æ§‹ç¯‰æ¸ˆã¿

Dockerã‚’ä½¿ã†ã¨ãƒ­ãƒ¼ã‚«ãƒ«ã§Supabaseã‚’ä½¿ãˆã¾ã™ã€‚
â€»Supabase CLIã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

## Next.jsã¨Supabaseã®åŸºæœ¬çš„ãªä½¿ã„æ–¹ã®å‚è€ƒ

Use Supabase with Next.js | Supabase Docs
https://supabase.com/docs/guides/getting-started/quickstarts/nextjs

ğŸ‘†ï¸ Next.jsã§ã®Supabaseã®åŸºç¤çš„ãªä½¿ç”¨æ–¹æ³•ã§ã™ã€‚



## ä¾‹

```terminal
npx create-next-app -e with-supabase [ã‚¢ãƒ—ãƒªå]

supabase init
supabase start
supabase status
scoop update supabase ï¼œï¼œSupabase CLIæ›´æ–°ã‚³ãƒãƒ³ãƒ‰

npm run dev

```

æ­¢ã‚ã‚‹æ™‚

```terminal
supabase stop

```

## ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

```.env
NEXT_PUBLIC_SUPABASE_URL=your-project-url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key

```

ğŸ‘† Supabaseã®ç’°å¢ƒå¤‰æ•°ã‚’å…¥åŠ›ã—ã¾ã™ã€‚

.gitignoreãƒ•ã‚¡ã‚¤ãƒ«ã®å¤‰æ›´

```.gitignore (ä¸€éƒ¨)
# local env files
.env

```

## RLSã¨ã¯ (å‚è€ƒ)

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å†…ã®ã©ã®è¡Œã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã™ã‚‹ã‹ã®ãƒãƒªã‚·ãƒ¼(=ãƒ«ãƒ¼ãƒ«)ã§ã™ã€‚

public.usersãƒ†ãƒ¼ãƒ–ãƒ«ãŒã‚ã‚‹ã¨ã—ã¦ã€ä»Šãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ã®ã¯ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼Aã€ã ã¨ã—ã¾ã™ã€‚

ãã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã¯

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼A å€‹äººãƒ‡ãƒ¼ã‚¿ ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ç­‰
ãƒ¦ãƒ¼ã‚¶ãƒ¼B å€‹äººãƒ‡ãƒ¼ã‚¿ ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ç­‰
ãƒ¦ãƒ¼ã‚¶ãƒ¼C å€‹äººãƒ‡ãƒ¼ã‚¿ ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ç­‰

```

ã®3äººãŒç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã¨ã—ã¦
RLSã§ç¾åœ¨ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’è¨±å¯ã¨è¨­å®šã™ã‚‹ã¨

ãƒ¦ãƒ¼ã‚¶ãƒ¼Aã¸ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ãŒã€
ãƒ¦ãƒ¼ã‚¶ãƒ¼Bã€ãƒ¦ãƒ¼ã‚¶ãƒ¼Cã«ã¯ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“ã€‚

ã ã‹ã‚‰ RLS(row è¡Œ level æ°´å¹³ security å®‰å¿ƒã€å®‰å…¨)
è¡Œå˜ä½ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨åä»˜ã‘ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚



----------------------------------------

# åŒ¿åèªè¨¼

## ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã®åŒ¿åèªè¨¼ã®è¨±å¯

é–‹ç™ºç’°å¢ƒãŒãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã®å ´åˆ

```supabase\config.toml
# Allow/disallow anonymous sign-ins to your project.
enable_anonymous_sign_ins = true

```

ã“ã®è¨­å®šã‚’trueã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ãŸå ´åˆã€
Dockerã®ãƒ­ãƒ¼ã‚«ãƒ«Supabaseã‚’å†èµ·å‹•ã•ã›ã¾ã™ã€‚

```terminal
supabase stop
supabase start

```

## ã‚µãƒ¼ãƒãƒ¼ç’°å¢ƒã§ã®åŒ¿åèªè¨¼ã®è¨±å¯

é–‹ç™ºç’°å¢ƒãŒã‚µãƒ¼ãƒãƒ¼ç’°å¢ƒã®å ´åˆ

ã‚µãƒ¼ãƒãƒ¼ã®Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰
å·¦ã‚µã‚¤ãƒ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã® Project Settingsã‚’é¸æŠã—ã¾ã™ã€‚

Settingsãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
ãã®CONFIGURATIONï¼ï¼Authenticationã‚’é¸æŠã—ã¾ã™ã€‚

User Signupsã®

```
Allow anonymous sign-ins
Enable anonymous sign-ins for your project.

```

ã‚’æœ‰åŠ¹åŒ–ã—ã¾ã™ã€‚

[Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ åŒ¿åèªè¨¼ã®å ´æ‰€](https://supabase.com/dashboard/project/_/settings/auth)



----------------------------------------

ã“ã“ã¾ã§ãŒä¸‹æº–å‚™ã€ã“ã“ã‹ã‚‰å®Ÿéš›ã®åŒ¿åèªè¨¼ã®è¶…åŸºç¤çš„ãªã‚³ãƒ¼ãƒ‰ã€‚

# åŒ¿åèªè¨¼ã®ã‚³ãƒ¼ãƒ‰

DBã«åŒ¿åãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç™»éŒ²ã™ã‚‹ã¾ã§ã®æœ€ä½é™ã§ã™ã€‚

```app\page.tsx
import Link from 'next/link';

export default async function Index() {
  return (
    <div className="">
      {/* SignInãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯ */}
      <Link href="/signin">SignInãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯</Link>
    </div>
  );
}

```

```app\signin\page.tsx
import { anonymousSignIn } from './actions';

export default async function SignIn() {
  return (
    <form action={anonymousSignIn}>
      <button type="submit">SignIn</button>
    </form>
  );
}

```

â€»React19 Next.js14ã®ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã§åŒ¿åèªè¨¼ã®é–¢æ•°ã‚’å®Ÿè¡Œã—ã¦ã„ã¾ã™ã€‚
ã‚µãƒ¼ãƒãƒ¼é–¢æ•°ã¯ğŸ‘‡ app\signin\actions.tsã«æ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚

```app\signin\actions.ts
'use server';

import { createClient } from '@/utils/supabase/server';

// ãƒšãƒ¼ã‚¸ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å†æ¤œè¨¼ã™ã‚‹ãŸã‚ã®é–¢æ•°ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒšãƒ¼ã‚¸ã®ãƒ‡ãƒ¼ã‚¿ãŒæœ€æ–°ã®çŠ¶æ…‹ã«ä¿ãŸã‚Œã¾ã™
import { revalidatePath } from 'next/cache';
import { redirect } from 'next/navigation';

export async function anonymousSignIn() {
  const supabase = createClient();
  const { data, error } = await supabase.auth.signInAnonymously();
  console.log('data:', data);

  if (error) {
    // ã‚¨ãƒ©ãƒ¼æ™‚ã®å‡¦ç†
  }

  // ã‚µã‚¤ãƒ³ã‚¤ãƒ³å¾Œã«ãƒšãƒ¼ã‚¸ã®ãƒ‡ãƒ¼ã‚¿ã‚’æœ€æ–°ã®çŠ¶æ…‹ã«æ›´æ–°ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚
  revalidatePath('/', 'layout');
  redirect('/');
}

```



## åŒ¿åèªè¨¼éƒ¨åˆ†ã®ã‚³ãƒ¼ãƒ‰

ğŸ‘‡ï¸ä¸€éƒ¨

```app\signin\actions.ts
  const supabase = createClient();
  const { data, error } = await supabase.auth.signInAnonymously();
  console.log('data:', data);

```

Supabaseã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½œã‚Šã€ åŒ¿åèªè¨¼ç”¨ã®é–¢æ•°ã‚’å®Ÿè¡Œã—ã¦ã€
console.logã§ãƒ‡ãƒ¼ã‚¿ã‚’å‡ºåŠ›ã•ã›ã¦ã„ã¾ã™ã€‚

ğŸ‘‡å‡ºåŠ›çµæœ

```terminal
 GET /favicon.ico 200 in 4737ms
data: {
  user: {
    id: 'c4c21c05-b510-4503-9f8d-430ec67f7f32',
    aud: 'authenticated',
    role: 'authenticated',
    email: '',
    phone: '',
    last_sign_in_at: '2024-07-06T19:41:29.122365579Z',
    app_metadata: {},
    user_metadata: {},
    identities: [],
    created_at: '2024-07-06T19:41:29.11744Z',
    updated_at: '2024-07-06T19:41:29.12594Z',
    is_anonymous: true
  },
  session: {
    access_token: 'ey*****10',
    token_type: 'bearer',
    expires_in: 3600,
    expires_at: 1720298489,
    refresh_token: 'fr*****Gg',
    user: {
      id: 'c4c21c05-b510-4503-9f8d-430ec67f7f32',
      aud: 'authenticated',
      role: 'authenticated',
      email: '',
      phone: '',
      last_sign_in_at: '2024-07-06T19:41:29.122365579Z',
      app_metadata: {},
      user_metadata: {},
      identities: [],
      created_at: '2024-07-06T19:41:29.11744Z',
      updated_at: '2024-07-06T19:41:29.12594Z',
      is_anonymous: true
    }
  }
}
 POST /signin 303 in 146ms

```

ãƒ­ãƒ¼ã‚«ãƒ«ã®Supabase ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰
å·¦ã‚µã‚¤ãƒ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®Authentication
ã‚‚ã—ãã¯
å·¦ã‚µã‚¤ãƒ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®Table Editor ã§authã‚¹ã‚­ãƒ¼ãƒã®usersãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ç¢ºèªã™ã‚‹ã¨
åŒ¿åã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä¸€äººè¿½åŠ ã•ã‚Œã¦ã„ã¾ã™ã€‚

![åŒ¿åãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä¸€äººè¿½åŠ .PNG](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/44761/7ac3b9f9-6ffc-b269-43bc-654d8eb8f6c3.png)



is_anonymous: ãŒ ã€ŒTRUEã€ã§åŒ¿åèªè¨¼ã§ã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚

revalidatePath('/', 'layout');
ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€æœ€æ–°ã®çŠ¶æ…‹ã«æ›´æ–°ã•ã‚Œã¾ã™ã€‚

## revalidatePathé–¢æ•°

`revalidatePath()`
ğŸ‘†ï¸ã“ã®é–¢æ•°ã¯çŠ¶æ…‹ç®¡ç†ã®è² æ‹…ã‚’æ¸›ã‚‰ã—ã¦ãã‚Œã¾ã™ã€‚

ä¾‹ãˆã°ã€ã„ã„ã­ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã€åˆ¥ã®é ã„ã„å ´æ‰€ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã„ã„ã­ãƒœã‚¿ãƒ³ç·ã‚«ã‚¦ãƒ³ãƒˆæ•°ã‚’ä¿å­˜ã—ã¦ã„ã‚‹å ´æ‰€ãŒã‚ã‚‹å ´åˆã€ã“ã‚Œã¾ã§ã¯çŠ¶æ…‹ç®¡ç†ã‚’ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸãŒã€
revalidatePathã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€çŠ¶æ…‹ç®¡ç†ã‚’ã›ãšã¨ã‚‚æœ€æ–°ã®çŠ¶æ…‹ã«ãªã‚Šã¾ã™ã€‚

â€»ä¾‹ãˆã°ã€å­«ï¼ï¼å­ï¼ï¼è¦ªï¼ï¼å­ï¼ï¼å­«ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ã§propsã‚’æ¸¡ã—ã¦ãƒã‚±ãƒ„ãƒªãƒ¬ãƒ¼ã‚’ã—ãŸã‚Šã€Reduxãªã©ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã„ã‚¹ãƒˆã‚¢ã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã®ã‚ˆã†ã«ä½¿ã£ã¦é›¢ã‚ŒãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ã§çŠ¶æ…‹ã®åŒæœŸã‚’å–ã‚Œã‚‹ã‚ˆã†ã«ã—ãŸã‚Šã—ã¾ã™ã€‚

ãªã®ã§ã€ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã‚’ã—ãŸå¾Œã«ã€ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ(ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ã‚’è¡¨ç¤ºã—ã¦ã„ã‚‹ã¯ãšã®ã€åˆ¥ã®é ã„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ)ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã¯ã¾ã ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã„çŠ¶æ…‹ã®ã¯ãšã§ã™ãŒã€revalidatePathã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€æŒ‡å®šã—ãŸå ´æ‰€ã§æœ€æ–°ã®æƒ…å ±ã‚’èª­ã¿å–ã‚Šãƒ­ã‚°ã‚¤ãƒ³ã—ãŸçŠ¶æ…‹ã«ãªã£ã¦ã„ã¾ã™ã€‚

çŠ¶æ…‹ç®¡ç†ã¯ã€ã†ã¾ãä½¿ãˆã°ã„ã„ã§ã™ãŒã€ãƒã‚°ã®æ¸©åºŠã«ã‚‚ãªã‚‹æ‰€ãªã®ã§ã€revalidatePathã‚’ä½¿ã†ã“ã¨ã§è² æ‹…ãŒæ¸›ã‚Šã¾ã™ã€‚


ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯æœ€çµ‚çš„ã«

```terminal
POST /signin 303 in 146ms

```

ãŒå‡ºåŠ›ã•ã‚Œã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰303ã«å¯¾å¿œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ï¼ˆå¯¾å¿œæ–¹æ³•ã¯æœªå‹‰å¼·ï¼‰

# ãã®ä»–

RLSã¯æœ‰åŠ¹ã«ã—ã¦ã„ã¾ã›ã‚“ã€‚

åŒ¿åèªè¨¼ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€
hCaptcha
ã‚„
Turnstile by Cloudflare
ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã‚’å…¬å¼ã§ã¯å¼·ãæ¨å¥¨ã—ã¦ã„ã¾ã™ã€‚

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³(ãƒ­ã‚°ã‚¤ãƒ³ä¸­)ç¢ºèªã¯ã€
getUserãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã„ã¾ã™ã€‚

```TypeScript
const { data: { user } } = await supabase.auth.getUser()

```

ã‚µãƒ¼ãƒä¸Šã§ãƒ¦ãƒ¼ã‚¶ã®èªå¯ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹å ´åˆã¯ã€å¸¸ã«ã“ã®getUserãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§ã¯ã€getSession().session.user ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šé«˜é€Ÿãªçµæœã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

https://supabase.com/docs/reference/javascript/auth-getuser

æ©Ÿæ¢°çš„ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã™ã‚‹ã‚ˆã†ãªBOTãªã©ã‚’å¼¾ãã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ©Ÿèƒ½ã§ã™ã€‚

å¿œç”¨ã¨ã—ã¦ã€ãƒ¡ãƒ¼ãƒ«èªè¨¼ã‚„OAuthèªè¨¼ã§ã‚‚èªè¨¼ã—ãŸå ´åˆã€åŒ¿åèªè¨¼ã®æ™‚ã®å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’å¼•ãç¶™ãŒã›ã‚‹ã‚ˆã†ãªè¨­å®šã‚‚å¯èƒ½ã§ã™ã€‚
â€»è‡ªèº«ã§ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚



# å‚è€ƒ

Supabase åŒ¿åèªè¨¼ãƒ¡ãƒ¢ #èªè¨¼ - Qiita

https://qiita.com/masakinihirota/items/1eb3c2029d5f0c9049e5

Supabaseå…¬å¼ã®åŒ¿åèªè¨¼

https://github.com/supabase/supabase/blob/master/apps/docs/content/guides/auth/auth-anonymous.mdx

ã€Supabaseã€‘Flutter + Supabase Authentication ã®Anonymous Sign-insã‚’ä½¿ã£ã¦åŒ¿åã‚µã‚¤ãƒ³ã‚¤ãƒ³ã®ã‚µãƒ³ãƒ—ãƒ«ã‚’ä½œã£ã¦ã¿ãŸ - ç‹å¥½ãã·ã‚ãã‚‰ã¾ãƒ¼

https://pregum-fox.hatenablog.jp/entry/2024/05/07/043423

ğŸ‘†ï¸è¨­å®šã®èª¬æ˜ãŒç”»åƒä»˜ãè§£èª¬






â€» ä»¥ä¸‹ã€æœªèª¿æŸ»

# åŒ¿åèªè¨¼ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒOAuthèªè¨¼(Googleã‚„GitHubã€Facebookã€Slackç­‰)ã«åˆ‡ã‚Šæ›¿ãˆã‚‹æ–¹æ³•

Anonymous Sign-Ins | Supabase Docs
https://supabase.com/docs/guides/auth/auth-anonymous#sign-in-anonymously

## è‡ªå‹•

è¤‡æ•°ã®OAuthèªè¨¼ã‚’ã—ãŸå ´åˆã€ãƒ¡ãƒ¼ãƒ«ãŒåŒã˜ã ã¨è‡ªå‹•ã§Linkã•ã‚Œã‚‹ã€‚
åŒ¿åèªè¨¼ã®å ´åˆã¯ä¸æ˜ã€‚

## æ‰‹å‹•

æ‰‹å‹•ã®è¨­å®šã‚’ONã«ã—ã¾ã™ã€‚

```typescript
const { data, error } = await supabase.auth.linkIdentity({ provider: 'google' })
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨åŒ¿åèªè¨¼ã—ã¦ã„ã¦ã‚‚ã€Googleèªè¨¼ç”»é¢ãŒç«‹ã¡ä¸ŠãŒã‚Šã€èªè¨¼ã®æ‰‹ç¶šããŒé–‹å§‹ã•ã‚Œã‚‹ã‚ˆã†ã ã€‚